/*#SDTREF(SDL,C:\Telelogic\SDL_TTCN_Suite6.2\sdt\include\ADT\ctypes.sun,4)*/
PACKAGE ctypes;
/*#SDTREF(SDL,C:\Telelogic\SDL_TTCN_Suite6.2\sdt\include\ADT\ctypes.sun(1),119(25,40))*/

/* Copyright (C) 1994 - 2000 by Telelogic AB.
Copyright (C) 1991, 1992, 1993, 1994 by Telelogic Malmoe AB.
Copyright (C) 1990, 1991 by Telesoft Europe AB.
This Program is owned by Telelogic and is protected by national
copyright laws and international copyright treaties. Telelogic
grants you the right to use this Program on one computer or in
one local computer network at any one time.
Under this License you may only modify the source code for the purpose
of adapting it to your environment. You must reproduce and include
any copyright and trademark notices on all copies of the source code.
You may not use, copy, merge, modify or transfer the Program except as
provided in this License.
Telelogic does not warrant that the Program will meet your
requirements or that the operation of the Program will be
uninterrupted and error free. You are solely responsible that the
selection of the Program and the modification of the source code
will achieve your intended results and that the results are actually
obtained. */

/*--------------------------- ShortInt --------------------------*/
/* Corresponds to C types : short int, short                     */
/*---------------------------------------------------------------*/

SYNTYPE ShortInt = Integer

/*#ADT(T A(S) E(S))
#TYPE
typedef short int #(ShortInt);
*/
ENDSYNTYPE ShortInt;



/*--------------------------- LongInt ---------------------------*/
/* Corresponds to C types : long int, long                       */
/*---------------------------------------------------------------*/

SYNTYPE LongInt = Integer

/*#ADT(T A(S) E(S))
#TYPE
typedef long int #(LongInt);
*/
ENDSYNTYPE LongInt;



/*---------------------- UnsignedShortInt -----------------------*/
/* Corresponds to C types : unsigned short int, unsigned short   */
/*---------------------------------------------------------------*/

SYNTYPE UnsignedShortInt = Integer

/*#ADT(T A(S) E(S))
#TYPE
typedef unsigned short #(UnsignedShortInt);
*/
ENDSYNTYPE UnsignedShortInt;



/*------------------------- UnsignedInt -------------------------*/
/* Corresponds to C types : unsigned int, unsigned               */
/*---------------------------------------------------------------*/

SYNTYPE UnsignedInt = Integer
/*#ADT(T A(S) E(S))
#TYPE
typedef unsigned #(UnsignedInt);
*/
ENDSYNTYPE UnsignedInt;



/*----------------------- UnsignedLongInt -----------------------*/
/* Corresponds to C types : unsigned long int, unsigned long     */
/*---------------------------------------------------------------*/

SYNTYPE UnsignedLongInt = Integer

/*#ADT(T A(S) E(S))
#TYPE
typedef unsigned long #(UnsignedLongInt);
*/
ENDSYNTYPE UnsignedLongInt;



/*--------------------------- Float -----------------------------*/
/* Corresponds to C type : float                                 */
/*---------------------------------------------------------------*/

SYNTYPE Float = Real
/*#ADT(T A(S) E(S))
#TYPE
#ifndef XNOUSEOFREAL
typedef float #(Float);
#define Float #(Float)
#endif
*/
ENDSYNTYPE Float;

/*-------------------------- Charstar ---------------------------*/
/* Corresponds to C type : char *                                */
/*---------------------------------------------------------------*/

NEWTYPE Charstar
  LITERALS
    Null                            /*#OP(S)*/;
  OPERATORS
    cstar2cstring : Charstar   -> Charstring;  /* NOT in Cmicro */
    cstring2cstar : Charstring -> Charstar;    /* NOT in Cmicro */
    cstar2vstar   : Charstar   -> Voidstar;
    vstar2cstar   : Voidstar   -> Charstar;
    cstar2vstarstar : Charstar -> Voidstarstar;/*#OP(HP)*/ /*To be used with free*/
  DEFAULT Null;
/*#ADT(T A(S) E(S) H)
#TYPE
typedef char * #(Charstar);
#HEADING
#define #(Null)()       0
#ifndef XSCT_CMICRO
extern SDL_Charstring #(cstar2cstring) XPP((#(Charstar)));
extern #(Charstar) #(cstring2cstar) XPP((SDL_Charstring));
#endif
#define #(cstar2vstar)(P) ((#(Voidstar))P)
#define #(vstar2cstar)(P) ((#(Charstar))P)
#define #(cstar2vstarstar)(P) ((#(Voidstarstar))&P)

#BODY
#ifndef XSCT_CMICRO
extern SDL_Charstring #(cstar2cstring)(
  #(Charstar) C)
{
  SDL_Charstring Result;
  int i = 0;
  if (C != 0) i = strlen(C);
  Result = (SDL_Charstring)XALLOC(i+2, (tSDLTypeInfo *)&ySDL_SDL_Charstring);
  if (i>0) memcpy(Result+1, C, i);
  Result[0] = 'T';
  Result[i+1] = '\0';
  return Result;
}

extern #(Charstar) #(cstring2cstar)(
  SDL_Charstring C)
{
  #(Charstar) Result;
  int i;
  if (C == (SDL_Charstring)0)
    i = 0;
  else
    i = strlen(C)-1;
#ifdef XVALIDATOR_LIB
  Result = (#(Charstar))XALLOC_REF_VAL(i+1, ySrtN_#(Charstar));
#else
  Result = (#(Charstar))XALLOC(i+1, (tSDLTypeInfo *)&ySDL_#(Charstar));
#endif
  if (i>0) memcpy(Result, C+1, i);
  Result[i] = '\0';
  if (C != 0 && C[0] == 'T')
    xFree_SDL_Charstring((void **)&C);
  return Result;
}
#endif
*/
ENDNEWTYPE Charstar;


/*-------------------------- Voidstar ---------------------------*/
/* Corresponds to C type : void *                                */
/*---------------------------------------------------------------*/

NEWTYPE Voidstar
  LITERALS
    Null                            /*#OP(S)*/;
  DEFAULT Null;
/*#ADT(T A(S) E(S) D(H) W(S) R(S))
#TYPE
typedef void * #(Voidstar);
#HEADING
#define #(Null)()       0
*/
ENDNEWTYPE Voidstar;


/*------------------------ Voidstarstar -------------------------*/
/* Corresponds to C type : void **                               */
/*---------------------------------------------------------------*/

NEWTYPE Voidstarstar
  LITERALS
     Null                            /*#OP(S)*/,
     Alloc                           /*#OP(H)*/;
  OPERATORS
    "*>"  : Voidstarstar, Voidstar -> Voidstarstar; /*#OP(SI)*/
    "*>"  : Voidstarstar -> Voidstar;               /*#OP(SI)*/
    "&"  : Voidstar -> Voidstarstar;                /*#OP(SI)*/
    "+"  : Voidstarstar, Integer -> Voidstarstar;   /*#OP(SI)*/
    "-"  : Voidstarstar, Integer -> Voidstarstar;   /*#OP(SI)*/
    vstarstar2vstar : Voidstarstar -> Voidstar;     /*#OP(HP)*/
    vstar2vstarstar : Voidstar -> Voidstarstar;     /*#OP(HP)*/
  DEFAULT Null;
/*#ADT(T A(S) E(S))
#TYPE
typedef void ** #(Voidstarstar);
#HEADING
#define yExtr_#(Voidstarstar)(yVar)  (*(yVar))
#define yAddr_#(Voidstarstar)(yVar)  (*(yVar))
#define #(Null)()       0
#define #(Alloc)() (#0)XALLOC(sizeof(Voidstar), (tSDLTypeInfo *)&ySDL_#(Voidstarstar))
#define #(vstarstar2vstar)(P) ((#(Voidstar))P)
#define #(vstar2vstarstar)(P) ((#(Voidstarstar))P)
*/
ENDNEWTYPE Voidstarstar;


/*--------------------------- CArray ----------------------------*/
/* Corresponds to C arrays                                       */
/*---------------------------------------------------------------*/

GENERATOR Carray (CONSTANT Length, TYPE Itemsort)
  OPERATORS
    modify!  : Carray, Integer, Itemsort -> Carray;
    extract! : Carray, Integer           -> Itemsort;
ENDGENERATOR Carray;



/*---------------------------- Ref ------------------------------*/
/* Corresponds to C pointers                                     */
/*---------------------------------------------------------------*/

GENERATOR Ref (TYPE Itemsort)
  LITERALS
     Null,
     Alloc;
  OPERATORS
    "*>"  : Ref, Itemsort -> Ref;
    "*>"  : Ref -> Itemsort;
    "&"   : Itemsort -> Ref;
    make! : Itemsort -> Ref;
    free  : in/out Ref;
    "+"   : Ref, Integer -> Ref;
    "-"   : Ref, Integer -> Ref;
    ref2vstar : Ref -> Voidstar;
    vstar2ref : Voidstar -> Ref;
    ref2vstarstar : Ref /*#REF*/ -> Voidstarstar;
  DEFAULT Null;
ENDGENERATOR Ref;

procedure free /*#NAME 'XXFREE'*/; fpar p Voidstarstar; external;
/*#CODE
#HEADING
#ifdef XVALIDATOR_LIB
#define XXFREE(p) XFREE_REF_VAL(p,0)
#else
#define XXFREE(p) XFREE(p,0)
#endif
*/


/*#SDTREF(SDL,C:\Telelogic\SDL_TTCN_Suite6.2\sdt\include\ADT\ctypes.sun,4)*/
endpackage ctypes;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\BasicTypes.sun,4)*/
package BasicTypes;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\BasicTypes.sun(1),245(40,25))*/
/*#include 'C:\Work\Development\BattleShips\Config\ConfigFile.pr' */
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\BasicTypes.sun(1),278(20,40))*/
syntype tSCRange = Integer
  constants 0:MaxSCRange
endsyntype;
syntype tSCMaxSpeed = Integer
  constants 0:MaxSCMaxSpeed
endsyntype;
syntype tSCMaxAcceleration = Integer
  constants 0:MaxSCMaxAcceleration
endsyntype;
syntype tSCMaxResource = Integer
  constants 0:MaxSCMaxResource
endsyntype;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\BasicTypes.sun(1),188(80,40))*/
syntype tWCPower = Integer
  constants 0:MaxWCPower
endsyntype;
syntype tWCRange = Integer
  constants 0:MaxWCRange
endsyntype;
syntype tWCSpeed = Integer
  constants 0:MaxWCSpeed
endsyntype;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\BasicTypes.sun(1),281(80,75))*/
syntype tAAWeaponry = Integer
  constants 0:MaxAAWeaponry
endsyntype;
syntype tLUWeaponry = Integer
  constants 0:MaxLUWeaponry
endsyntype;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\BasicTypes.sun(1),290(20,85))*/
syntype tXCoordinate = Integer
  constants 0:MaxXCoordinate
endsyntype;
syntype tYCoordinate = Integer
  constants 0:MaxYCoordinate
endsyntype;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\BasicTypes.sun(1),374(80,100))*/
syntype tFactorAcceleration = Real
  constants -1.0:1.0
endsyntype;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\BasicTypes.sun(1),407(20,110))*/
syntype tShipId = Integer
  constants 1:(MaxTypeBattleship + 
               MaxTypeCruiser + 
               MaxTypeDestroyer + 
               MaxTypeMissileCutter + 
               MaxTypeRepairBoat) *
               AmountStrategy
endsyntype;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\BasicTypes.sun(1),413(80,115))*/
syntype tStrategyId = Integer
  constants 1:AmountStrategy
endsyntype;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\BasicTypes.sun(1),455(80,130))*/
synonym sqrt2  Real = 1.41421356;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\BasicTypes.sun(2),254(20,40))*/
newtype tHeading
  literals
    NORTH,
    NORTH_EAST,
    EAST,
    SOUTH_EAST,
    SOUTH,
    SOUTH_WEST,
    WEST,
    NORTH_WEST;
  operators
    h2i : tHeading -> Integer;
    i2h : Integer -> tHeading;
  operator h2i;
    fpar lit tHeading;
    returns Integer; referenced;
  operator i2h;
    fpar int Integer;
    returns tHeading; referenced;
endnewtype;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\BasicTypes.sun(2),182(70,40))*/
newtype tDeep
  literals
    LAND,
    FLEET,
    NORMAL,
    DEEPLY,
    VERY_DEEPLY;
  operators
    d2i : tDeep -> Integer;
    i2d : Integer -> tDeep;
  operator d2i;
    fpar lit tDeep;
    returns Integer; referenced;
  operator i2d;
    fpar int Integer;
    returns tDeep; referenced;
endnewtype;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\BasicTypes.sun(2),179(20,115))*/
newtype tNameWeaponry
  literals
    MISSILE,
    TORPEDO,
    SHELL,
    REPAIR;
  operators
    nw2i : tNameWeaponry -> Integer;
    i2nw : Integer -> tNameWeaponry;
  operator nw2i;
    fpar lit tNameWeaponry;
    returns Integer; referenced;
  operator i2nw;
    fpar int Integer;
    returns tNameWeaponry; referenced;
endnewtype;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\BasicTypes.sun(2),248(80,115))*/
newtype tNameShip
  literals
    BATTLESHIP,
    CRUISER,
    DESTROYER,
    MISSILE_CUTTER,
    REPAIR_BOAT;
  operators
    ns2i : tNameShip -> Integer;
    i2ns : Integer -> tNameShip;
  operator ns2i;
    fpar lit tNameShip;
    returns Integer; referenced;
  operator i2ns;
    fpar int Integer;
    returns tNameShip; referenced;
endnewtype;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\BasicTypes.sun(2),359(20,175))*/
newtype tHeadingChange
  literals
    LEFT,
    RIGHT;
endnewtype;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\BasicTypes.sun(3),287(20,40))*/
newtype tCoordinates
  struct
    x tXCoordinate;
    y tYCoordinate;
endnewtype;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\BasicTypes.sun(3),146(20,60))*/
newtype tWeaponryCharacter
  struct
    Power tWCPower;
    Range tWCRange;
    Speed tWCSpeed;      
endnewtype;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\BasicTypes.sun(3),251(20,85))*/
newtype tShipCharacter
  struct
    Range tSCRange;
    MaxSpeed tSCMaxSpeed;
    MaxAcceleration tSCMaxAcceleration;
    MaxResource tSCMaxResource;
    MaxAmmunition tArrayAmountAmmunition;
    MaxLaunchUnit tArrayAmountLaunchUnit;
    MaxDeep tDeep;
endnewtype;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\BasicTypes.sun(3),401(20,125))*/
newtype tShipCurrentState
  struct
    ShipId tShipId;
    StrategyId tStrategyId;
    TypeShip tNameShip;
    Speed tSCMaxSpeed;
    Heading tHeading;
    Resource tSCMaxResource;
    Coordinates tCoordinates;
    Ammunition tArrayAmountAmmunition;
endnewtype;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\BasicTypes.sun(3),446(20,165))*/
newtype tEnemyShip
  struct
    ShipId tShipId;
    StrategyId tStrategyId;
    TypeShip tNameShip;
    Speed tSCMaxSpeed;
    Heading tHeading;
    Coordinates tCoordinates;
endnewtype;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\BasicTypes.sun(4),215(20,40))*/
newtype tArrayWeaponryCharacter
  Array(tNameWeaponry,tWeaponryCharacter);
endnewtype;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\BasicTypes.sun(4),284(20,55))*/
newtype tArrayShipsCharacter
  Array(tNameShip,tShipCharacter);
endnewtype;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\BasicTypes.sun(4),344(20,70))*/
newtype tArrayAmountAmmunition
  Array(tNameWeaponry,tAAWeaponry);
endnewtype;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\BasicTypes.sun(4),341(20,85))*/
newtype tArrayAmountLaunchUnit
  Array(tNameWeaponry,tLUWeaponry);
endnewtype;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\BasicTypes.sun(4),404(20,100))*/
newtype tStringShipCurrentState
  String(tShipCurrentState,empty);
endnewtype;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\BasicTypes.sun(4),449(20,115))*/
newtype tStringEnemyShip
  String(tEnemyShip,empty);
endnewtype;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\BasicTypes.sun(4),362(20,130))*/
newtype tStringShotsList
  String(tCoordinates,empty);
endnewtype;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\BasicTypes.sun(5),329(20,40))*/
remote gWeaponryCharacter tArrayWeaponryCharacter;
remote gShipsCharacter tArrayShipsCharacter;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\BasicTypes.sun(5),410(20,55))*/
procedure getDeepXY;
  fpar
    x tXCoordinate,
    y tYCoordinate;
  returns Integer;
external;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\BasicTypes.sun(5),452(20,80))*/
procedure getDistance;
  fpar
    xps Integer,
    yps Integer,
    xpf Integer,
    ypf Integer;
  returns Integer;
external;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\BasicTypes.sun(5),458(20,115))*/
procedure setMapPath;
  fpar
     mapRelPath Charstring;
  returns Integer;
external;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\BasicTypes.sun(6),233(20,40))*/
signal
  InitDataComplete,
  StartSimulation(Integer),
  FinishSimulation(Integer,tStrategyId),
  OrderSpeedRequest(tShipId,tStrategyId,tFactorAcceleration),
  OrderTurnRequest(tShipId,tStrategyId,tHeadingChange),
  OrderFireRequest(tShipId,tStrategyId,tNameWeaponry,tStringShotsList),
  DestroyShip(tShipId,tStrategyId,tNameShip),
  StrategyVictory(tStrategyId),
  StrategyLose(tStrategyId),
  OrderSpeedResponse(tShipId,tStrategyId),
  OrderSpeedReject(tShipId,tStrategyId),
  OrderTurnResponse(tShipId,tStrategyId),
  OrderTurnReject(tShipId,tStrategyId),
  OrderFireResponse(tShipId,tStrategyId),
  OrderFireReject(tShipId,tStrategyId),
  ShipsCurrentState(tStrategyId,tStringShipCurrentState),
  VisibleShip(tStrategyId,tStringEnemyShip),
  messageLog(Charstring),
  messageError(Charstring);
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\BasicTypes.sun(6),365(20,115))*/
signallist fromSimulator = (toStrategy);
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\BasicTypes.sun(6),371(80,115))*/
signallist toSimulator = (fromStrategy);
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\BasicTypes.sun(6),236(20,130))*/
signallist toStrategy = 
InitDataComplete,
StartSimulation,
DestroyShip,
OrderSpeedResponse,
OrderSpeedReject,
OrderTurnResponse,
OrderTurnReject,
OrderFireResponse,
OrderFireReject,
ShipsCurrentState,
VisibleShip,
StrategyVictory,
StrategyLose;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\BasicTypes.sun(6),353(60,130))*/
signallist fromStrategy =
FinishSimulation,
OrderSpeedRequest,
OrderTurnRequest,
OrderFireRequest;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\BasicTypes.sun,4)*/
endpackage BasicTypes;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\h2i.sop,4)*/
operator h2i
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\h2i.sop,1)*/
; fpar
  lit tHeading;
returns Integer;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\h2i.sop(1),116(80,25))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\h2i.sop(1),119(80,40))*/
decision /*#E*/ 
lit;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\h2i.sop(1),143(32,50))*/
(NORTH):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\h2i.sop(1),128(25,55))*/
return /*#E*/ 
0;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\h2i.sop(1),179(152,50))*/
(NORTH_WEST):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\h2i.sop(1),167(145,55))*/
return /*#E*/ 
7;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\h2i.sop(1),146(47,65))*/
(NORTH_EAST):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\h2i.sop(1),134(40,70))*/
return /*#E*/ 
1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\h2i.sop(1),176(137,65))*/
(WEST):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\h2i.sop(1),158(130,70))*/
return /*#E*/ 
6;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\h2i.sop(1),149(62,80))*/
(EAST):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\h2i.sop(1),137(55,85))*/
return /*#E*/ 
2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\h2i.sop(1),173(122,80))*/
(SOUTH_WEST):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\h2i.sop(1),164(115,85))*/
return /*#E*/ 
5;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\h2i.sop(1),152(77,95))*/
(SOUTH_EAST):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\h2i.sop(1),140(70,100))*/
return /*#E*/ 
3;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\h2i.sop(1),170(107,95))*/
(SOUTH):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\h2i.sop(1),155(100,100))*/
return /*#E*/ 
4;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\h2i.sop(1),119(80,40))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\h2i.sop,4)*/
endoperator h2i;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2h.sop,4)*/
operator i2h
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2h.sop,1)*/
; fpar
  int Integer;
returns tHeading;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2h.sop(1),143(80,25))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2h.sop(1),140(80,40))*/
decision /*#E*/ 
int mod 8 ;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2h.sop(1),149(32,50))*/
(=0):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2h.sop(1),137(25,55))*/
return /*#E*/ 
NORTH;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2h.sop(1),152(152,50))*/
(=7):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2h.sop(1),134(145,55))*/
return /*#E*/ 
NORTH_WEST;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2h.sop(1),155(47,65))*/
(=1):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2h.sop(1),131(40,70))*/
return /*#E*/ 
NORTH_EAST;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2h.sop(1),158(137,65))*/
(=6):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2h.sop(1),128(130,70))*/
return /*#E*/ 
WEST;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2h.sop(1),161(62,80))*/
(=2):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2h.sop(1),125(55,85))*/
return /*#E*/ 
EAST;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2h.sop(1),164(122,80))*/
(=5):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2h.sop(1),122(115,85))*/
return /*#E*/ 
SOUTH_WEST;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2h.sop(1),167(77,95))*/
(=3):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2h.sop(1),119(70,100))*/
return /*#E*/ 
SOUTH_EAST;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2h.sop(1),170(107,95))*/
(=4):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2h.sop(1),116(100,100))*/
return /*#E*/ 
SOUTH;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2h.sop(1),140(80,40))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2h.sop,4)*/
endoperator i2h;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\d2i.sop,4)*/
operator d2i
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\d2i.sop,1)*/
; fpar
  lit tDeep;
returns Integer;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\d2i.sop(1),143(80,25))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\d2i.sop(1),140(80,40))*/
decision /*#E*/ 
lit;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\d2i.sop(1),149(57,52))*/
(LAND):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\d2i.sop(1),137(50,55))*/
return /*#E*/ 
0;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\d2i.sop(1),152(127,50))*/
(VERY_DEEPLY):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\d2i.sop(1),134(120,55))*/
return /*#E*/ 
4;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\d2i.sop(1),155(72,65))*/
(FLEET):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\d2i.sop(1),131(65,70))*/
return /*#E*/ 
1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\d2i.sop(1),158(112,65))*/
(DEEPLY):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\d2i.sop(1),128(105,70))*/
return /*#E*/ 
3;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\d2i.sop(1),170(92,80))*/
(NORMAL):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\d2i.sop(1),116(85,85))*/
return /*#E*/ 
2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\d2i.sop(1),140(80,40))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\d2i.sop,4)*/
endoperator d2i;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2d.sop,4)*/
operator i2d
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2d.sop,1)*/
; fpar
  int Integer;
returns tDeep;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2d.sop(1),143(80,25))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2d.sop(1),140(80,40))*/
decision /*#E*/ 
int mod 5;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2d.sop(1),149(60,50))*/
(=0):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2d.sop(1),137(50,55))*/
return /*#E*/ 
LAND;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2d.sop(1),152(127,50))*/
(=4):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2d.sop(1),134(120,55))*/
return /*#E*/ 
VERY_DEEPLY;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2d.sop(1),155(72,65))*/
(=1):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2d.sop(1),131(65,70))*/
return /*#E*/ 
FLEET;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2d.sop(1),158(112,65))*/
(=3):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2d.sop(1),128(105,70))*/
return /*#E*/ 
DEEPLY;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2d.sop(1),161(92,80))*/
(=2):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2d.sop(1),125(85,85))*/
return /*#E*/ 
NORMAL;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2d.sop(1),140(80,40))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2d.sop,4)*/
endoperator i2d;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\nw2i.sop,4)*/
operator nw2i
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\nw2i.sop,1)*/
; fpar
  lit tNameWeaponry;
returns Integer;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\nw2i.sop(1),137(80,25))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\nw2i.sop(1),134(80,40))*/
decision /*#E*/ 
lit;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\nw2i.sop(1),143(62,50))*/
(MISSILE):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\nw2i.sop(1),131(55,55))*/
return /*#E*/ 
0;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\nw2i.sop(1),146(122,50))*/
(REPAIR):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\nw2i.sop(1),128(115,55))*/
return /*#E*/ 
3;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\nw2i.sop(1),149(77,65))*/
(TORPEDO):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\nw2i.sop(1),125(70,70))*/
return /*#E*/ 
1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\nw2i.sop(1),152(107,65))*/
(SHELL):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\nw2i.sop(1),122(100,70))*/
return /*#E*/ 
2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\nw2i.sop(1),134(80,40))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\nw2i.sop,4)*/
endoperator nw2i;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2nw.sop,4)*/
operator i2nw
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2nw.sop,1)*/
; fpar
  int Integer;
returns tNameWeaponry;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2nw.sop(1),134(80,25))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2nw.sop(1),131(80,40))*/
decision /*#E*/ 
int mod 4;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2nw.sop(1),140(62,50))*/
(=0):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2nw.sop(1),128(55,55))*/
return /*#E*/ 
MISSILE;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2nw.sop(1),143(122,50))*/
(=3):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2nw.sop(1),125(115,55))*/
return /*#E*/ 
REPAIR;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2nw.sop(1),146(77,65))*/
(=1):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2nw.sop(1),122(70,70))*/
return /*#E*/ 
TORPEDO;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2nw.sop(1),149(107,65))*/
(=2):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2nw.sop(1),119(100,70))*/
return /*#E*/ 
SHELL;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2nw.sop(1),131(80,40))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2nw.sop,4)*/
endoperator i2nw;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\ns2i.sop,4)*/
operator ns2i
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\ns2i.sop,1)*/
; fpar
  lit tNameShip;
returns Integer;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\ns2i.sop(1),134(80,25))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\ns2i.sop(1),131(80,40))*/
decision /*#E*/ 
lit;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\ns2i.sop(1),140(57,50))*/
(BATTLESHIP):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\ns2i.sop(1),128(50,55))*/
return /*#E*/ 
0;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\ns2i.sop(1),143(127,50))*/
(REPAIR_BOAT):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\ns2i.sop(1),125(120,55))*/
return /*#E*/ 
4;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\ns2i.sop(1),146(72,65))*/
(CRUISER):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\ns2i.sop(1),122(65,70))*/
return /*#E*/ 
1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\ns2i.sop(1),149(112,65))*/
(MISSILE_CUTTER):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\ns2i.sop(1),119(105,70))*/
return /*#E*/ 
3;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\ns2i.sop(1),152(92,80))*/
(DESTROYER):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\ns2i.sop(1),116(85,85))*/
return /*#E*/ 
2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\ns2i.sop(1),131(80,40))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\ns2i.sop,4)*/
endoperator ns2i;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2ns.sop,4)*/
operator i2ns
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2ns.sop,1)*/
; fpar
  int Integer;
returns tNameShip;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2ns.sop(1),134(80,25))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2ns.sop(1),131(80,40))*/
decision /*#E*/ 
int mod 5;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2ns.sop(1),140(57,50))*/
(=0):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2ns.sop(1),128(50,55))*/
return /*#E*/ 
BATTLESHIP;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2ns.sop(1),143(127,50))*/
(=4):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2ns.sop(1),125(120,55))*/
return /*#E*/ 
REPAIR_BOAT;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2ns.sop(1),146(72,65))*/
(=1):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2ns.sop(1),122(65,70))*/
return /*#E*/ 
CRUISER;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2ns.sop(1),149(112,65))*/
(=3):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2ns.sop(1),119(105,70))*/
return /*#E*/ 
MISSILE_CUTTER;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2ns.sop(1),152(92,80))*/
(=2):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2ns.sop(1),116(85,85))*/
return /*#E*/ 
DESTROYER;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2ns.sop(1),131(80,40))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Packages\i2ns.sop,4)*/
endoperator i2ns;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\BattleShips.ssy,7)*/
use ctypes;
use BasicTypes;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\BattleShips.ssy,4)*/
system BattleShips;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\BattleShips.ssy,1)*/
/*#include 'file.pr'*/
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\BattleShips.ssy(1),173(130,42))*/
channel /*#E*/ 
St2MsgInt from 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\BattleShips.ssy(1),125(80,40))*/
Strategy2 to 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\BattleShips.ssy(1),104(15,15))*/
env with 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\BattleShips.ssy(1),174(150,55))*/
messageLog,
messageError;
endchannel St2MsgInt;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\BattleShips.ssy(1),137(75,77))*/
channel /*#E*/ 
SimSt2Int from 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\BattleShips.ssy(1),119(80,100))*/
Simulator to 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\BattleShips.ssy(1),125(80,40))*/
Strategy2 with 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\BattleShips.ssy(1),138(97,65))*/
(toStrategy);
from 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\BattleShips.ssy(1),125(80,40))*/
Strategy2 to 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\BattleShips.ssy(1),119(80,100))*/
Simulator with 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\BattleShips.ssy(1),139(97,90))*/
(fromStrategy);
endchannel SimSt2Int;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\BattleShips.ssy(1),164(132,102))*/
channel /*#E*/ 
SimMsgInt from 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\BattleShips.ssy(1),119(80,100))*/
Simulator to 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\BattleShips.ssy(1),104(15,15))*/
env with 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\BattleShips.ssy(1),165(150,115))*/
messageLog,
messageError;
endchannel SimMsgInt;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\BattleShips.ssy(1),128(75,144))*/
channel /*#E*/ 
SimSt1Int from 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\BattleShips.ssy(1),119(80,100))*/
Simulator to 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\BattleShips.ssy(1),122(80,160))*/
Strategy1 with 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\BattleShips.ssy(1),129(97,149))*/
(toStrategy);
from 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\BattleShips.ssy(1),122(80,160))*/
Strategy1 to 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\BattleShips.ssy(1),119(80,100))*/
Simulator with 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\BattleShips.ssy(1),130(97,125))*/
(fromStrategy);
endchannel SimSt1Int;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\BattleShips.ssy(1),182(132,162))*/
channel /*#E*/ 
St1MsgInt from 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\BattleShips.ssy(1),122(80,160))*/
Strategy1 to 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\BattleShips.ssy(1),104(15,15))*/
env with 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\BattleShips.ssy(1),183(150,175))*/
messageLog,
messageError;
endchannel St1MsgInt;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\BattleShips.ssy(1),125(80,40))*/
block /*#E*/ 
Strategy2 referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\BattleShips.ssy(1),119(80,100))*/
block /*#E*/ 
Simulator referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\BattleShips.ssy(1),122(80,160))*/
block /*#E*/ 
Strategy1 referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\BattleShips.ssy,4)*/
endsystem BattleShips;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Simulator.sbk,4)*/
block Simulator;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Simulator.sbk(1),197(20,40))*/
newtype tShipParameters
  struct
    ShipId tShipId;
    StrategyId tStrategyId;
    TypeShip tNameShip;
    Speed tSCMaxSpeed;
    Heading tHeading;
    Resource tSCMaxResource;
    Coordinates tCoordinates;
    Ammunition tArrayAmountAmmunition;
    VisibleToStrategy tArrayVisible;
endnewtype;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Simulator.sbk(1),200(90,40))*/
remote gShips tStringShipParameters;
remote gShots tStringShotParameters;
remote gASI tArraySI;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Simulator.sbk(1),311(90,55))*/
signal
  SendData,
  InitSocket,
  SendDataComplete(tErrorCode),
  InitSocketComplete(tErrorCode),
  CloseClientSocket;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Simulator.sbk(1),212(20,85))*/
newtype tShotParameters
  struct
    TypeWeaponry tNameWeaponry;
    CurrentCoordinates tCoordinates;
    FinishCoordinates tCoordinates;
    ShotId Integer;
endnewtype;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Simulator.sbk(1),209(20,115))*/
newtype tArrayVisible
  Array(tStrategyId,Boolean);
endnewtype;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Simulator.sbk(1),203(20,130))*/
newtype tStringShipParameters
  String(tShipParameters,empty);
endnewtype;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Simulator.sbk(1),221(20,145))*/
newtype tStringShotParameters
  String(tShotParameters,empty);
endnewtype;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Simulator.sbk(1),308(20,160))*/
newtype tErrorCode
  literals
    EC_OK,
    EC_FAULT;
endnewtype;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Simulator.sbk(1),563(20,180))*/
newtype tArraySI
  Array(tStrategyId, Boolean);
endnewtype;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Simulator.sbk(2),329(20,40))*/
procedure checkMap;
  returns Integer;
external;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Simulator.sbk(2),332(20,55))*/
procedure generatePoints;
  fpar
    Radius Integer,
    Deep Integer,
    NumOfStrat Integer;
  returns Integer;
external;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Simulator.sbk(2),335(20,85))*/
procedure getFleetPointX;
  fpar
    StratNum Integer;
  returns Integer;
external;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Simulator.sbk(2),338(20,105))*/
procedure getFleetPointY;
  fpar
    StratNum Integer;
  returns Integer;
external;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Simulator.sbk(2),341(20,125))*/
procedure FreeAll;
external;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Simulator.sbk(2),440(20,140))*/
procedure getHeading;
  returns Integer;
external;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Simulator.sbk(3),266(40,50))*/
signalroute /*#E*/ 
chRtrSt2 from 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Simulator.sbk(3),245(80,45))*/
Router to 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Simulator.sbk(3),104(15,15))*/
env with 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Simulator.sbk(3),267(17,57))*/
(toStrategy);
from 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Simulator.sbk(3),104(15,15))*/
env to 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Simulator.sbk(3),245(80,45))*/
Router with 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Simulator.sbk(3),268(57,60))*/
(fromStrategy);
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Simulator.sbk(3),257(135,50))*/
signalroute /*#E*/ 
chRtrSt1 from 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Simulator.sbk(3),245(80,45))*/
Router to 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Simulator.sbk(3),104(15,15))*/
env with 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Simulator.sbk(3),258(155,57))*/
(toStrategy);
from 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Simulator.sbk(3),104(15,15))*/
env to 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Simulator.sbk(3),245(80,45))*/
Router with 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Simulator.sbk(3),259(112,57))*/
(fromStrategy);
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Simulator.sbk(3),128(97,79))*/
signalroute /*#E*/ 
chMnRtr from 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Simulator.sbk(3),245(80,45))*/
Router to 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Simulator.sbk(3),116(80,100))*/
Main with 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Simulator.sbk(3),129(97,95))*/
(fromStrategy);
from 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Simulator.sbk(3),116(80,100))*/
Main to 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Simulator.sbk(3),245(80,45))*/
Router with 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Simulator.sbk(3),130(97,67))*/
(toStrategy);
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Simulator.sbk(3),155(132,102))*/
signalroute /*#E*/ 
chSimMsg from 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Simulator.sbk(3),116(80,100))*/
Main to 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Simulator.sbk(3),104(15,15))*/
env with 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Simulator.sbk(3),156(152,112))*/
messageLog,
messageError;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Simulator.sbk(3),347(97,135))*/
signalroute /*#E*/ 
chMnDS from 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Simulator.sbk(3),116(80,100))*/
Main to 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Simulator.sbk(3),344(80,155))*/
DataSender with 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Simulator.sbk(3),348(97,142))*/
SendData,
InitSocket,
CloseClientSocket;
from 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Simulator.sbk(3),344(80,155))*/
DataSender to 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Simulator.sbk(3),116(80,100))*/
Main with 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Simulator.sbk(3),349(97,122))*/
SendDataComplete,
InitSocketComplete;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Simulator.sbk(3),245(80,45))*/
process /*#E*/ 
Router(1,1) referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Simulator.sbk(3),116(80,100))*/
process /*#E*/ 
Main(1,1) referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Simulator.sbk(3),344(80,155))*/
process /*#E*/ 
DataSender(1,1) referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Simulator.sbk(3),272(7,47))*/
connect /*#E*/ 
SimSt2Int and 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Simulator.sbk(3),266(40,50))*/
chRtrSt2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Simulator.sbk(3),263(167,47))*/
connect /*#E*/ 
SimSt1Int and 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Simulator.sbk(3),257(135,50))*/
chRtrSt1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Simulator.sbk(3),359(167,102))*/
connect /*#E*/ 
SimMsgInt and 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Simulator.sbk(3),155(132,102))*/
chSimMsg;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Simulator.sbk,4)*/
endblock Simulator;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr,4)*/
process Main;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(1),149(90,15))*/
dcl
  exported
    gWeaponryCharacter tArrayWeaponryCharacter,
    gShipsCharacter tArrayShipsCharacter,
    gShips tStringShipParameters,
    gShots tStringShotParameters,
    gASI tArraySI;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(1),1097(90,60))*/
synonym NAMESHIP_NUM Integer = 5;
synonym CHECK_ITER Integer = 10;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(1),1787(90,75))*/
newtype tErrorName
  literals
    EN_OK,
    EN_COULD_NOT_OPEN_FILE,
    EN_SHIP_NOT_FOUND,
    EN_ERROR_PROPERTY,
    EN_NOT_ENOUGH_AMMO,
    EN_INIT_SOCKET_FAULT,
    EN_SEND_DATA_FAULT,
    EN_WRONG_MAP,
    EN_GEN_POINTS_FAULT,
    EN_GET_COORD_FAULT;
endnewtype;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(1),1784(90,125))*/
dcl errcode tErrorCode;
dcl errname tErrorName;
dcl simtime Integer;
dcl victory Boolean;
dcl next_shot_id Integer;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(1),1805(90,155))*/
procedure sdl_sqrt;
  fpar
    x Integer;
  returns Integer;
external;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(1),254(5,25))*/
procedure /*#E*/ 
InitDataShipsWeaponry referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(1),395(5,40))*/
procedure /*#E*/ 
InitStrategyFleet referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(1),842(5,55))*/
procedure /*#E*/ 
SetVisibility referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(1),731(5,70))*/
procedure /*#E*/ 
SendCurrentState referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(1),734(5,85))*/
procedure /*#E*/ 
SendVisibleShips referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(1),1103(5,115))*/
procedure /*#E*/ 
Err2Str referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(1),1184(5,140))*/
procedure /*#E*/ 
SimIteration referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(1),1487(5,160))*/
procedure /*#E*/ 
SetSI referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(1),1766(5,180))*/
procedure /*#E*/ 
KillStrategy referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(1),2168(5,200))*/
procedure /*#E*/ 
IsWeaponry referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(2),230(55,10))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(2),1793(55,25))*/
task {/*#E*/ 
 
errcode := call SetSI;
export ( gASI );
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(2),1148(55,40))*/
output /*#E*/ 
messageLog 
('Start config file reading')
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(2),260(55,55))*/
task /*#E*/ 
 
errcode := call InitDataShipsWeaponry
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(2),266(55,70))*/
decision /*#E*/ 
errcode;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(2),374(92,77))*/
(= EC_OK):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(2),221(80,85))*/
/*#E*/ 
 
export(
  gWeaponryCharacter,
  gShipsCharacter)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(2),419(80,100))*/
output /*#E*/ 
messageLog 
('Start fleet initialization')
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(2),380(80,115))*/
task /*#E*/ 
 
errcode := call InitStrategyFleet
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(2),470(80,130))*/
decision /*#E*/ 
errcode;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(2),590(117,132))*/
(= EC_OK):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(2),629(105,140))*/
/*#E*/ 
 
export( gShips, gShots )
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(2),2297(100,160))*/
task /*#E*/ 
next_shot_id := 1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(2),1808(105,180))*/
output /*#E*/ 
InitDataComplete;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(2),482(110,195))*/
join /*#E*/ 
PM1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(2),560(42,137))*/
else:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(2),545(30,150))*/
output /*#E*/ 
messageError 
(call Err2Str)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(2),575(35,170))*/
join /*#E*/ 
QUIT;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(2),470(80,130))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(2),377(22,77))*/
else:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(2),1163(5,85))*/
output /*#E*/ 
messageError 
(call Err2Str)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(2),569(10,105))*/
join /*#E*/ 
QUIT;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(2),266(55,70))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(3),1529(75,40))*/
state /*#E*/ 
WaitSocketInit;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(3),1523(75,55))*/
input /*#E*/ 
 
InitSocketComplete(errcode)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(3),1547(75,70))*/
decision /*#E*/ 
errcode;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(3),1553(87,80))*/
(= EC_OK):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(3),656(75,85))*/
output /*#E*/ 
messageLog 
('Start SendCurrentState, SetVisibility
  and SendVisibleShips procedures')
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(3),674(75,100))*/
task {/*#E*/ 
 
call SendCurrentState;
call SetVisibility;
call SendVisibleShips;
export( gShips, gShots );
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(3),1586(75,115))*/
output /*#E*/ 
SendData;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(3),1592(75,130))*/
nextstate /*#E*/ 
WaitSendData1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(3),1583(12,77))*/
else:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(3),1571(5,85))*/
task /*#E*/ 
 
errname :=
  EN_INIT_SOCKET_FAULT
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(3),1562(5,100))*/
output /*#E*/ 
messageError 
(call Err2Str)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(3),1556(10,120))*/
join /*#E*/ 
QUIT;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(3),1547(75,70))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(3),1529(75,40))*/
endstate;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(3),1592(75,130))*/
state /*#E*/ 
WaitSendData1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(3),1595(75,145))*/
input /*#E*/ 
 
SendDataComplete(errcode)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(3),1610(75,160))*/
decision /*#E*/ 
errcode;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(3),1688(102,160))*/
(= EC_OK):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(3),1664(105,170))*/
task {/*#E*/ 
 
simtime := 0;
victory := false;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(3),1658(105,185))*/
output /*#E*/ 
messageLog 
('StartSimulation signal')
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(3),854(110,200))*/
join /*#E*/ 
PM2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(3),1622(60,160))*/
else:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(3),1619(10,170))*/
task /*#E*/ 
 
errname :=
  EN_SEND_DATA_FAULT
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(3),1625(10,185))*/
output /*#E*/ 
messageError 
(call Err2Str)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(3),1631(15,200))*/
join /*#E*/ 
QUIT;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(3),1610(75,160))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(3),1592(75,130))*/
endstate;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(3),581(80,10))*/
connection /*#E*/ 
PM1:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(3),1514(75,25))*/
output /*#E*/ 
InitSocket;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(3),1529(75,40))*/
nextstate /*#E*/ 
WaitSocketInit;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(3),581(80,10))*/
endconnection PM1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(4),2267(5,180))*/
state /*#E*/ 
FIN;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(4),2282(5,195))*/
input /*#E*/ 
*;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(4),2291(5,210))*/
nextstate /*#E*/ 
-;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(4),2267(5,180))*/
endstate;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(4),1703(80,115))*/
state /*#E*/ 
WaitSendData2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(4),1709(80,130))*/
input /*#E*/ 
 
SendDataComplete( errcode )
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(4),1883(80,145))*/
decision /*#E*/ 
 
victory  AND
  (NOT TestMode)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(4),2318(70,147))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(4),1886(107,155))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(4),2183(105,160))*/
decision /*#E*/ 
errcode;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(4),2186(117,172))*/
(= EC_OK):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(4),1901(105,180))*/
output /*#E*/ 
messageLog 
( 'Start SendCurrentState, SetVisibility
  and SendVisibleShips procedures' )
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(4),1895(105,195))*/
task {/*#E*/ 
 
call SendCurrentState;
call SetVisibility;
call SendVisibleShips;
export( gShips, gShots );
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(4),2021(110,215))*/
join /*#E*/ 
PM3;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(4),2189(72,160))*/
else:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(4),2234(35,180))*/
task /*#E*/ 
 
errname :=
  EN_SEND_DATA_FAULT
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(4),2228(35,195))*/
output /*#E*/ 
messageError 
(call Err2Str)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(4),2222(40,210))*/
join /*#E*/ 
QUIT;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(4),2183(105,160))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(4),1883(80,145))*/
enddecision;
grst7371_1:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(4),2312(5,150))*/
output /*#E*/ 
CloseClientSocket;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(4),1820(5,165))*/
task {/*#E*/ 
call FreeAll;};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(4),2267(5,180))*/
nextstate /*#E*/ 
FIN;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(4),1703(80,115))*/
endstate;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(4),872(85,20))*/
connection /*#E*/ 
PM2:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(4),1841(80,35))*/
output /*#E*/ 
StartSimulation 
(simtime)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(4),1187(80,50))*/
task {/*#E*/ 
 
errcode := call SimIteration;
export( gASI );
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(4),1199(80,65))*/
decision /*#E*/ 
errcode;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(4),2180(92,77))*/
(= EC_OK):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(4),1694(80,85))*/
task {/*#E*/ 
 
export( gShips, gShots );
simtime := simtime + 1;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(4),1277(80,100))*/
output /*#E*/ 
SendData;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(4),1703(80,115))*/
nextstate /*#E*/ 
WaitSendData2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(4),1208(12,72))*/
else:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(4),1223(5,85))*/
output /*#E*/ 
messageError 
(call Err2Str)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(4),1199(80,65))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(4),1475(35,100))*/
QUIT:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(4),1769(5,130))*/
task {/*#E*/ 
 
errcode :=
  call KillStrategy;
export( gASI );
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(4),2312(5,150))*/
join /*#E*/ 
grst7371_1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(4),872(85,20))*/
endconnection PM2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(5),2099(75,95))*/
state /*#E*/ 
WaitSendData3;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(5),2096(75,110))*/
input /*#E*/ 
 
SendDataComplete( errcode )
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(5),2174(80,125))*/
join /*#E*/ 
QUIT;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(5),2099(75,95))*/
endstate;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(5),2048(80,30))*/
connection /*#E*/ 
PM3:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(5),2036(75,45))*/
decision /*#E*/ 
 
( NOT( simtime mod CHECK_ITER  = 0 ) )
  OR ( call IsWeaponry )
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(5),2066(65,45))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(5),2063(55,65))*/
join /*#E*/ 
PM2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(5),2090(87,57))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(5),2147(75,65))*/
output /*#E*/ 
messageLog 
( 'Draw game' )
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(5),2102(75,80))*/
output /*#E*/ 
SendData;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(5),2099(75,95))*/
nextstate /*#E*/ 
WaitSendData3;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(5),2036(75,45))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr(5),2048(80,30))*/
endconnection PM3;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Main.spr,4)*/
endprocess Main;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitDataShipsWeaponry.spd,4)*/
procedure InitDataShipsWeaponry
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitDataShipsWeaponry.spd,1)*/
;
returns tErrorCode;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitDataShipsWeaponry.spd(1),146(70,10))*/
dcl srcFile TextFile;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitDataShipsWeaponry.spd(1),182(5,30))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitDataShipsWeaponry.spd(1),185(5,45))*/
task {/*#E*/ 
 
srcFile := OpenR
(WeaponrySettingsPath);
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitDataShipsWeaponry.spd(1),197(5,60))*/
decision /*#E*/ 
srcFile;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitDataShipsWeaponry.spd(1),212(55,60))*/
(= NULL):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitDataShipsWeaponry.spd(1),290(80,60))*/
task {/*#E*/ 
 
srcFile := Close(srcFile);
errname := EN_COULD_NOT_OPEN_FILE;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitDataShipsWeaponry.spd(1),287(85,75))*/
return /*#E*/ 
EC_FAULT;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitDataShipsWeaponry.spd(1),254(17,72))*/
else:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitDataShipsWeaponry.spd(1),245(5,90))*/
task {/*#E*/ 
 
gWeaponryCharacter(MISSILE)!Power := fix(GetReal(srcFile) * float(MaxWCPower));
gWeaponryCharacter(MISSILE)!Range := fix(GetReal(srcFile) * float(MaxWCRange));
gWeaponryCharacter(MISSILE)!Speed := fix(GetReal(srcFile) * float(MaxWCSpeed));
gWeaponryCharacter(TORPEDO)!Power := fix(GetReal(srcFile) * float(MaxWCPower));
gWeaponryCharacter(TORPEDO)!Range := fix(GetReal(srcFile) * float(MaxWCRange));
gWeaponryCharacter(TORPEDO)!Speed := fix(GetReal(srcFile) * float(MaxWCSpeed));
gWeaponryCharacter(SHELL)!Power := fix(GetReal(srcFile) * float(MaxWCPower));
gWeaponryCharacter(SHELL)!Range := fix(GetReal(srcFile) * float(MaxWCRange));
gWeaponryCharacter(SHELL)!Speed := fix(GetReal(srcFile) * float(MaxWCSpeed));
gWeaponryCharacter(REPAIR)!Power := fix(GetReal(srcFile) * float(MaxWCPower));
gWeaponryCharacter(REPAIR)!Range := fix(GetReal(srcFile) * float(MaxWCRange));
gWeaponryCharacter(REPAIR)!Speed := fix(GetReal(srcFile) * float(MaxWCSpeed));
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitDataShipsWeaponry.spd(1),386(5,135))*/
task {/*#E*/ 
 
gShipsCharacter(BATTLESHIP)!Range := fix(GetReal(srcFile) * float(MaxSCRange));
gShipsCharacter(BATTLESHIP)!MaxSpeed := fix(GetReal(srcFile) * float(MaxSCMaxSpeed));
gShipsCharacter(BATTLESHIP)!MaxAcceleration := fix(GetReal(srcFile) * float(MaxSCMaxAcceleration));
gShipsCharacter(BATTLESHIP)!MaxResource := fix(GetReal(srcFile) * float(MaxSCMaxResource));
gShipsCharacter(BATTLESHIP)!MaxAmmunition(MISSILE) := fix(GetReal(srcFile) * float(MaxAAWeaponry));
gShipsCharacter(BATTLESHIP)!MaxAmmunition(TORPEDO) := fix(GetReal(srcFile) * float(MaxAAWeaponry));
gShipsCharacter(BATTLESHIP)!MaxAmmunition(SHELL) := fix(GetReal(srcFile) * float(MaxAAWeaponry));
gShipsCharacter(BATTLESHIP)!MaxAmmunition(REPAIR) := fix(GetReal(srcFile) * float(MaxAAWeaponry));
gShipsCharacter(BATTLESHIP)!MaxLaunchUnit(MISSILE) := fix(GetReal(srcFile) * float(MaxLUWeaponry));
gShipsCharacter(BATTLESHIP)!MaxLaunchUnit(TORPEDO) := fix(GetReal(srcFile) * float(MaxLUWeaponry));
gShipsCharacter(BATTLESHIP)!MaxLaunchUnit(SHELL) := fix(GetReal(srcFile) * float(MaxLUWeaponry));
gShipsCharacter(BATTLESHIP)!MaxLaunchUnit(REPAIR) := fix(GetReal(srcFile) * float(MaxLUWeaponry));
gShipsCharacter(BATTLESHIP)!MaxDeep := i2d(GetInteger(srcFile));
gShipsCharacter(CRUISER)!Range := fix(GetReal(srcFile) * float(MaxSCRange));
gShipsCharacter(CRUISER)!MaxSpeed := fix(GetReal(srcFile) * float(MaxSCMaxSpeed));
gShipsCharacter(CRUISER)!MaxAcceleration := fix(GetReal(srcFile) * float(MaxSCMaxAcceleration));
gShipsCharacter(CRUISER)!MaxResource := fix(GetReal(srcFile) * float(MaxSCMaxResource));
gShipsCharacter(CRUISER)!MaxAmmunition(MISSILE) := fix(GetReal(srcFile) * float(MaxAAWeaponry));
gShipsCharacter(CRUISER)!MaxAmmunition(TORPEDO) := fix(GetReal(srcFile) * float(MaxAAWeaponry));
gShipsCharacter(CRUISER)!MaxAmmunition(SHELL) := fix(GetReal(srcFile) * float(MaxAAWeaponry));
gShipsCharacter(CRUISER)!MaxAmmunition(REPAIR) := fix(GetReal(srcFile) * float(MaxAAWeaponry));
gShipsCharacter(CRUISER)!MaxLaunchUnit(MISSILE) := fix(GetReal(srcFile) * float(MaxLUWeaponry));
gShipsCharacter(CRUISER)!MaxLaunchUnit(TORPEDO) := fix(GetReal(srcFile) * float(MaxLUWeaponry));
gShipsCharacter(CRUISER)!MaxLaunchUnit(SHELL) := fix(GetReal(srcFile) * float(MaxLUWeaponry));
gShipsCharacter(CRUISER)!MaxLaunchUnit(REPAIR) := fix(GetReal(srcFile) * float(MaxLUWeaponry));
gShipsCharacter(CRUISER)!MaxDeep := i2d(GetInteger(srcFile));
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitDataShipsWeaponry.spd(1),326(10,150))*/
join /*#E*/ 
L1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitDataShipsWeaponry.spd(1),197(5,60))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitDataShipsWeaponry.spd(2),344(10,30))*/
connection /*#E*/ 
L1:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitDataShipsWeaponry.spd(2),356(5,45))*/
task {/*#E*/ 
 
gShipsCharacter(DESTROYER)!Range := fix(GetReal(srcFile) * float(MaxSCRange));
gShipsCharacter(DESTROYER)!MaxSpeed := fix(GetReal(srcFile) * float(MaxSCMaxSpeed));
gShipsCharacter(DESTROYER)!MaxAcceleration := fix(GetReal(srcFile) * float(MaxSCMaxAcceleration));
gShipsCharacter(DESTROYER)!MaxResource := fix(GetReal(srcFile) * float(MaxSCMaxResource));
gShipsCharacter(DESTROYER)!MaxAmmunition(MISSILE) := fix(GetReal(srcFile) * float(MaxAAWeaponry));
gShipsCharacter(DESTROYER)!MaxAmmunition(TORPEDO) := fix(GetReal(srcFile) * float(MaxAAWeaponry));
gShipsCharacter(DESTROYER)!MaxAmmunition(SHELL) := fix(GetReal(srcFile) * float(MaxAAWeaponry));
gShipsCharacter(DESTROYER)!MaxAmmunition(REPAIR) := fix(GetReal(srcFile) * float(MaxAAWeaponry));
gShipsCharacter(DESTROYER)!MaxLaunchUnit(MISSILE) := fix(GetReal(srcFile) * float(MaxLUWeaponry));
gShipsCharacter(DESTROYER)!MaxLaunchUnit(TORPEDO) := fix(GetReal(srcFile) * float(MaxLUWeaponry));
gShipsCharacter(DESTROYER)!MaxLaunchUnit(SHELL) := fix(GetReal(srcFile) * float(MaxLUWeaponry));
gShipsCharacter(DESTROYER)!MaxLaunchUnit(REPAIR) := fix(GetReal(srcFile) * float(MaxLUWeaponry));
gShipsCharacter(DESTROYER)!MaxDeep := i2d(GetInteger(srcFile));
gShipsCharacter(MISSILE_CUTTER)!Range := fix(GetReal(srcFile) * float(MaxSCRange));
gShipsCharacter(MISSILE_CUTTER)!MaxSpeed := fix(GetReal(srcFile) * float(MaxSCMaxSpeed));
gShipsCharacter(MISSILE_CUTTER)!MaxAcceleration := fix(GetReal(srcFile) * float(MaxSCMaxAcceleration));
gShipsCharacter(MISSILE_CUTTER)!MaxResource := fix(GetReal(srcFile) * float(MaxSCMaxResource));
gShipsCharacter(MISSILE_CUTTER)!MaxAmmunition(MISSILE) := fix(GetReal(srcFile) * float(MaxAAWeaponry));
gShipsCharacter(MISSILE_CUTTER)!MaxAmmunition(TORPEDO) := fix(GetReal(srcFile) * float(MaxAAWeaponry));
gShipsCharacter(MISSILE_CUTTER)!MaxAmmunition(SHELL) := fix(GetReal(srcFile) * float(MaxAAWeaponry));
gShipsCharacter(MISSILE_CUTTER)!MaxAmmunition(REPAIR) := fix(GetReal(srcFile) * float(MaxAAWeaponry));
gShipsCharacter(MISSILE_CUTTER)!MaxLaunchUnit(MISSILE) := fix(GetReal(srcFile) * float(MaxLUWeaponry));
gShipsCharacter(MISSILE_CUTTER)!MaxLaunchUnit(TORPEDO) := fix(GetReal(srcFile) * float(MaxLUWeaponry));
gShipsCharacter(MISSILE_CUTTER)!MaxLaunchUnit(SHELL) := fix(GetReal(srcFile) * float(MaxLUWeaponry));
gShipsCharacter(MISSILE_CUTTER)!MaxLaunchUnit(REPAIR) := fix(GetReal(srcFile) * float(MaxLUWeaponry));
gShipsCharacter(MISSILE_CUTTER)!MaxDeep := i2d(GetInteger(srcFile));
gShipsCharacter(REPAIR_BOAT)!Range := fix(GetReal(srcFile) * float(MaxSCRange));
gShipsCharacter(REPAIR_BOAT)!MaxSpeed := fix(GetReal(srcFile) * float(MaxSCMaxSpeed));
gShipsCharacter(REPAIR_BOAT)!MaxAcceleration := fix(GetReal(srcFile) * float(MaxSCMaxAcceleration));
gShipsCharacter(REPAIR_BOAT)!MaxResource := fix(GetReal(srcFile) * float(MaxSCMaxResource));
gShipsCharacter(REPAIR_BOAT)!MaxAmmunition(MISSILE) := fix(GetReal(srcFile) * float(MaxAAWeaponry));
gShipsCharacter(REPAIR_BOAT)!MaxAmmunition(TORPEDO) := fix(GetReal(srcFile) * float(MaxAAWeaponry));
gShipsCharacter(REPAIR_BOAT)!MaxAmmunition(SHELL) := fix(GetReal(srcFile) * float(MaxAAWeaponry));
gShipsCharacter(REPAIR_BOAT)!MaxAmmunition(REPAIR) := fix(GetReal(srcFile) * float(MaxAAWeaponry));
gShipsCharacter(REPAIR_BOAT)!MaxLaunchUnit(MISSILE) := fix(GetReal(srcFile) * float(MaxLUWeaponry));
gShipsCharacter(REPAIR_BOAT)!MaxLaunchUnit(TORPEDO) := fix(GetReal(srcFile) * float(MaxLUWeaponry));
gShipsCharacter(REPAIR_BOAT)!MaxLaunchUnit(SHELL) := fix(GetReal(srcFile) * float(MaxLUWeaponry));
gShipsCharacter(REPAIR_BOAT)!MaxLaunchUnit(REPAIR) := fix(GetReal(srcFile) * float(MaxLUWeaponry));
gShipsCharacter(REPAIR_BOAT)!MaxDeep := i2d(GetInteger(srcFile));
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitDataShipsWeaponry.spd(2),371(5,185))*/
task {/*#E*/ 
 
srcFile := Close(srcFile);
errname := EN_OK;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitDataShipsWeaponry.spd(2),368(10,200))*/
return /*#E*/ 
EC_OK;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitDataShipsWeaponry.spd(2),344(10,30))*/
endconnection L1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitDataShipsWeaponry.spd,4)*/
endprocedure InitDataShipsWeaponry;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd,4)*/
procedure InitStrategyFleet
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd,1)*/
;
returns tErrorCode;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(1),146(30,10))*/
dcl shipParam tShipParameters;
dcl shipType tNameShip;

dcl shipId Integer;
dcl nAS, nST Integer;
dcl i, maxShips Integer;

synonym OK Integer = 1;
dcl Radius, Deep, pX, pY Integer;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(1),839(140,10))*/
procedure /*#E*/ 
InitRD referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(2),671(60,15))*/
procedure /*#E*/ 
GetMaxShips referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(2),503(100,15))*/
procedure /*#E*/ 
GetCoordinate referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(1),116(95,15))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(1),890(95,30))*/
decision /*#E*/ 
 
call setMapPath(MapPath)

;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(1),923(107,42))*/
(= OK):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(1),734(95,55))*/
decision /*#E*/ 
 
call checkMap
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(1),737(107,65))*/
(= OK):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(1),761(95,70))*/
task {/*#E*/ 
 
errcode := call InitRD;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(1),770(95,85))*/
decision /*#E*/ 
 
call generatePoints(
  Radius, Deep, AmountStrategy)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(1),782(107,95))*/
(= OK):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(1),236(95,100))*/
task {/*#E*/ 
 
shipParam!Speed := 0;
shipId := 1;
nAS := 1;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(1),806(32,92))*/
else:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(1),803(25,100))*/
task /*#E*/ 
 
errname :=
  EN_GEN_POINTS_FAULT
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(1),809(30,115))*/
return /*#E*/ 
EC_FAULT;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(1),770(95,85))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(1),788(95,60))*/
else:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(1),785(35,60))*/
task /*#E*/ 
 
errname :=
  EN_WRONG_MAP
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(1),797(40,75))*/
return /*#E*/ 
EC_FAULT;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(1),734(95,55))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(1),926(12,37))*/
else:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(1),914(5,45))*/
task /*#E*/ 
 
errname :=
  EN_WRONG_MAP
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(1),908(10,60))*/
return /*#E*/ 
EC_FAULT;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(1),890(95,30))*/
enddecision;
grst3029_1:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(1),248(95,130))*/
decision /*#E*/ 
 
nAS <= AmountStrategy
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(1),692(45,137))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(1),710(25,150))*/
task {/*#E*/ 
 
errname := EN_OK;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(1),134(30,165))*/
return /*#E*/ 
EC_OK;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(1),263(107,142))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(1),260(95,150))*/
output /*#E*/ 
messageLog 
('Init next strategy')
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(1),272(95,165))*/
task {/*#E*/ 
 
shipParam!StrategyId := nAS;
nST := 1;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(1),821(95,180))*/
task {/*#E*/ 
 
pX := call getFleetPointX(nAS);
pY := call getFleetPointY(nAS);
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(1),248(95,130))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(1),599(65,180))*/
ISF1:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(1),344(95,195))*/
decision /*#E*/ 
 
nST <= NAMESHIP_NUM
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(1),428(47,202))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(1),425(30,210))*/
task {/*#E*/ 
 
nAS := nAS + 1;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(1),515(107,207))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(1),512(100,215))*/
join /*#E*/ 
ISF2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(1),344(95,195))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(1),248(95,130))*/
join /*#E*/ 
grst3029_1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(2),584(40,30))*/
connection /*#E*/ 
ISF2:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(2),575(35,45))*/
task {/*#E*/ 
 
shipType := i2ns(nST);
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(2),458(35,60))*/
task {/*#E*/ 
 
shipParam!TypeShip := shipType;
shipParam!Resource := gShipsCharacter(shipType)!MaxResource;
shipParam!Ammunition(MISSILE) :=
  gShipsCharacter(shipType)!MaxAmmunition(MISSILE);
shipParam!Ammunition(TORPEDO) :=
  gShipsCharacter(shipType)!MaxAmmunition(TORPEDO);
shipParam!Ammunition(SHELL) :=
  gShipsCharacter(shipType)!MaxAmmunition(SHELL);
shipParam!Ammunition(REPAIR) :=
  gShipsCharacter(shipType)!MaxAmmunition(REPAIR);

Deep := d2i(gShipsCharacter(shipType)!MaxDeep);
maxShips := call GetMaxShips(shipType);
i := 1;
};
grst3029_2:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(2),476(35,115))*/
decision /*#E*/ 
 
i <= maxShips
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(2),650(17,122))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(2),647(5,135))*/
task /*#E*/ 
nST:=nST+1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(2),653(10,150))*/
join /*#E*/ 
ISF1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(2),494(47,127))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(2),491(35,135))*/
task {/*#E*/ 
 
shipParam!ShipId      := shipId;
shipParam!Heading     := i2h(call getHeading);
errcode := call GetCoordinate(shipParam!Coordinates);
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(2),842(35,155))*/
decision /*#E*/ 
errcode;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(2),851(107,162))*/
(= EC_OK):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(2),848(95,170))*/
task {/*#E*/ 
 
gShips := gShips // mkstring(shipParam);

shipId := shipId + 1;
i := i + 1;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(2),866(32,155))*/
else:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(2),875(20,170))*/
return /*#E*/ 
EC_FAULT;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(2),842(35,155))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(2),476(35,115))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(2),476(35,115))*/
join /*#E*/ 
grst3029_2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd(2),584(40,30))*/
endconnection ISF2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitStrategyFleet.spd,4)*/
endprocedure InitStrategyFleet;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitRD.spd,4)*/
procedure InitRD
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitRD.spd,1)*/
;
returns tErrorCode;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitRD.spd(1),206(50,10))*/
dcl r Integer := MaxTypeBattleship + MaxTypeCruiser +
  MaxTypeDestroyer + MaxTypeMissileCutter + MaxTypeRepairBoat;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitRD.spd(1),116(85,30))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitRD.spd(1),122(85,45))*/
task {/*#E*/ 
 
nST := 1;
Deep := 0;
};
grst3054_1:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitRD.spd(1),134(85,60))*/
decision /*#E*/ 
 
nST <= NAMESHIP_NUM
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitRD.spd(1),197(82,60))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitRD.spd(1),194(5,80))*/
task {/*#E*/ 
 
Radius :=
  (call sdl_sqrt(r))/2 + 1;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitRD.spd(1),209(5,100))*/
task {/*#E*/ 
 
errname := EN_OK;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitRD.spd(1),221(10,115))*/
return /*#E*/ 
EC_OK;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitRD.spd(1),152(97,72))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitRD.spd(1),227(85,80))*/
task /*#E*/ 
 
shipType := i2ns(nST)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitRD.spd(1),149(85,100))*/
decision /*#E*/ 
 
Deep < d2i(gShipsCharacter(shipType)!MaxDeep)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitRD.spd(1),158(97,112))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitRD.spd(1),155(85,120))*/
task /*#E*/ 
 
Deep := d2i(gShipsCharacter(shipType)!MaxDeep)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitRD.spd(1),188(77,100))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitRD.spd(1),149(85,100))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitRD.spd(1),176(85,135))*/
task /*#E*/ 
 
nST := nST + 1
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitRD.spd(1),134(85,60))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitRD.spd(1),134(85,60))*/
join /*#E*/ 
grst3054_1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\InitRD.spd,4)*/
endprocedure InitRD;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetMaxShips.spd,4)*/
procedure GetMaxShips
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetMaxShips.spd,1)*/
;fpar
  Name tNameShip;
returns Integer;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetMaxShips.spd(1),116(70,25))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetMaxShips.spd(1),122(70,40))*/
decision /*#E*/ 
Name;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetMaxShips.spd(1),167(97,47))*/
(= MISSILE_CUTTER):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetMaxShips.spd(1),164(125,55))*/
return /*#E*/ 
MaxTypeMissileCutter;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetMaxShips.spd(1),131(35,47))*/
(= BATTLESHIP):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetMaxShips.spd(1),134(15,60))*/
return /*#E*/ 
MaxTypeBattleship;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetMaxShips.spd(1),143(35,77))*/
(= CRUISER):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetMaxShips.spd(1),140(15,85))*/
return /*#E*/ 
MaxTypeCruiser;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetMaxShips.spd(1),176(100,77))*/
(= REPAIR_BOAT):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetMaxShips.spd(1),170(125,85))*/
return /*#E*/ 
  MaxTypeRepairBoat;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetMaxShips.spd(1),161(32,102))*/
(= DESTROYER):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetMaxShips.spd(1),158(15,110))*/
return /*#E*/ 
MaxTypeDestroyer;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetMaxShips.spd(1),122(70,40))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetMaxShips.spd,4)*/
endprocedure GetMaxShips;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd,4)*/
procedure GetCoordinate
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd,1)*/
;fpar
  in/out coord tCoordinates;
returns tErrorCode;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd(1),1148(5,25))*/
dcl cDeep, tDeep Integer;
dcl cCoord tCoordinates;
dcl xMax, xMin Integer;
dcl yMax, yMin Integer;
dcl IsCoord Boolean;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd(2),1295(60,10))*/
procedure /*#E*/ 
IsBusyPoint referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd(1),1151(70,25))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd(1),1154(70,40))*/
task {/*#E*/ 
 
xMax := pX + Radius;
xMin := pX - Radius;
yMax := pY + Radius;
yMin := pY - Radius;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd(1),1169(70,55))*/
decision /*#E*/ 
xMin < 0;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd(1),1181(82,67))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd(1),1178(70,75))*/
task /*#E*/ 
xMin := 0;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd(1),1190(62,55))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd(1),1169(70,55))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd(1),1184(70,90))*/
decision /*#E*/ 
yMin < 0;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd(1),1196(82,102))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd(1),1193(70,110))*/
task /*#E*/ 
yMin := 0;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd(1),1208(62,90))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd(1),1184(70,90))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd(1),1202(70,125))*/
decision /*#E*/ 
 
xMax > MaxXCoordinate
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd(1),1223(82,137))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd(1),1220(70,145))*/
task /*#E*/ 
 
xMax := MaxXCoordinate
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd(1),1259(62,125))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd(1),1202(70,125))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd(1),1232(70,160))*/
decision /*#E*/ 
 
yMax > MaxYCoordinate
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd(1),1250(82,172))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd(1),1247(70,180))*/
task /*#E*/ 
 
yMax := MaxYCoordinate
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd(1),1271(62,160))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd(1),1232(70,160))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd(1),1265(70,195))*/
task {/*#E*/ 
 
IsCoord := false;
cCoord!x := xMin;
cCoord!y := yMin;
cDeep := d2i(VERY_DEEPLY);
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd(1),1286(75,215))*/
join /*#E*/ 
GC1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd(2),1292(95,30))*/
connection /*#E*/ 
GC1:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd(2),1313(90,45))*/
decision /*#E*/ 
 
cCoord!y <= yMax
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd(2),1382(12,52))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd(2),1454(5,65))*/
decision /*#E*/ 
IsCoord;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd(2),1463(47,72))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd(2),1460(35,80))*/
task /*#E*/ 
 
errname :=
  EN_OK
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd(2),1472(40,95))*/
return /*#E*/ 
EC_OK;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd(2),1457(17,77))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd(2),1379(5,110))*/
task {/*#E*/ 
 
errname :=
  EN_GET_COORD_FAULT;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd(2),1391(10,125))*/
return /*#E*/ 
EC_FAULT;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd(2),1454(5,65))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd(2),1316(102,57))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd(2),1313(90,45))*/
enddecision;
grst2731_1:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd(2),1325(90,65))*/
decision /*#E*/ 
 
cCoord!x <= xMax
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd(2),1361(117,77))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd(2),1358(105,85))*/
task {/*#E*/ 
 
cCoord!x := xMin;
cCoord!y := cCoord!y + 1;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd(2),1313(90,45))*/
join /*#E*/ 
GC1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd(2),1328(102,77))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd(2),1301(90,105))*/
decision /*#E*/ 
 
call IsBusyPoint
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd(2),1406(102,117))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd(2),1439(90,125))*/
task /*#E*/ 
 
tDeep := call getDeepXY(cCoord!x, cCoord!y)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd(2),1415(90,140))*/
decision /*#E*/ 
 
(tDeep >= Deep) AND (tDeep <= cDeep)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd(2),1427(102,152))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd(2),1424(90,160))*/
task {/*#E*/ 
 
cDeep := tDeep;
coord := cCoord;
IsCoord := true;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd(2),1430(80,140))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd(2),1415(90,140))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd(2),1346(80,105))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd(2),1301(90,105))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd(2),1343(90,180))*/
task /*#E*/ 
 
cCoord!x := cCoord!x + 1
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd(2),1325(90,65))*/
join /*#E*/ 
grst2731_1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd(2),1325(90,65))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd(2),1292(95,30))*/
endconnection GC1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCoordinate.spd,4)*/
endprocedure GetCoordinate;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\IsBusyPoint.spd,4)*/
procedure IsBusyPoint
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\IsBusyPoint.spd,1)*/
;
returns Boolean;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\IsBusyPoint.spd(1),281(45,10))*/
dcl iBP, length Integer;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\IsBusyPoint.spd(1),278(60,25))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\IsBusyPoint.spd(1),275(60,40))*/
task {/*#E*/ 
 
length := length(gShips);
iBP := 1;
};
grst4805_1:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\IsBusyPoint.spd(1),269(60,55))*/
decision /*#E*/ 
 
iBP > length
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\IsBusyPoint.spd(1),314(12,62))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\IsBusyPoint.spd(1),248(10,70))*/
return /*#E*/ 
false;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\IsBusyPoint.spd(1),296(72,67))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\IsBusyPoint.spd(1),263(60,75))*/
decision /*#E*/ 
 
gShips(iBP)!Coordinates = cCoord
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\IsBusyPoint.spd(1),311(37,82))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\IsBusyPoint.spd(1),251(35,95))*/
return /*#E*/ 
true;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\IsBusyPoint.spd(1),302(72,87))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\IsBusyPoint.spd(1),257(60,95))*/
task /*#E*/ 
 
iBP := iBP + 1
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\IsBusyPoint.spd(1),263(60,75))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\IsBusyPoint.spd(1),269(60,55))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\IsBusyPoint.spd(1),269(60,55))*/
join /*#E*/ 
grst4805_1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\IsBusyPoint.spd,4)*/
endprocedure IsBusyPoint;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SetVisibility.spd,4)*/
procedure SetVisibility;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SetVisibility.spd(1),116(30,10))*/
dcl n Integer;
dcl ins, jns, r Integer;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SetVisibility.spd(1),776(5,25))*/
procedure /*#E*/ 
zeroizeVisibility referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SetVisibility.spd(1),119(85,10))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SetVisibility.spd(1),764(85,25))*/
call /*#E*/ 
 
zeroizeVisibility
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SetVisibility.spd(1),140(85,40))*/
task {/*#E*/ 
 
n := length( gShips );
ins := 1;
};
grst9465_1:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SetVisibility.spd(1),155(85,55))*/
decision /*#E*/ 
ins <= n;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SetVisibility.spd(1),170(22,62))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SetVisibility.spd(1),167(20,75))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SetVisibility.spd(1),176(97,67))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SetVisibility.spd(1),470(85,75))*/
task {/*#E*/ 
jns := ins + 1;};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SetVisibility.spd(1),155(85,55))*/
enddecision;
grst9465_2:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SetVisibility.spd(1),482(85,90))*/
decision /*#E*/ 
jns <= n;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SetVisibility.spd(1),497(122,97))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SetVisibility.spd(1),494(110,105))*/
task /*#E*/ 
ins := ins + 1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SetVisibility.spd(1),155(85,55))*/
join /*#E*/ 
grst9465_1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SetVisibility.spd(1),509(97,102))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SetVisibility.spd(1),239(85,120))*/
task /*#E*/ 
 
r := call getDistance(
  gShips(ins)!Coordinates!x,
  gShips(ins)!Coordinates!y,
  gShips(jns)!Coordinates!x,
  gShips(jns)!Coordinates!y)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SetVisibility.spd(1),710(85,145))*/
decision /*#E*/ 
 
r <= gShipsCharacter(gShips(ins)!TypeShip)!Range
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SetVisibility.spd(1),716(27,152))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SetVisibility.spd(1),704(10,165))*/
task /*#E*/ 
 
gShips(jns)!VisibleToStrategy(
  gShips(ins)!StrategyId) := false
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SetVisibility.spd(1),746(97,157))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SetVisibility.spd(1),677(85,165))*/
task /*#E*/ 
 
gShips(jns)!VisibleToStrategy(
  gShips(ins)!StrategyId) := true
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SetVisibility.spd(1),710(85,145))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SetVisibility.spd(1),698(85,180))*/
decision /*#E*/ 
 
r <= gShipsCharacter(gShips(jns)!TypeShip)!Range
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SetVisibility.spd(1),728(27,187))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SetVisibility.spd(1),692(10,200))*/
task /*#E*/ 
 
gShips(ins)!VisibleToStrategy(
  gShips(jns)!StrategyId) := false
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SetVisibility.spd(1),737(97,192))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SetVisibility.spd(1),683(85,200))*/
task /*#E*/ 
 
gShips(ins)!VisibleToStrategy(
  gShips(jns)!StrategyId) := true
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SetVisibility.spd(1),698(85,180))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SetVisibility.spd(1),686(85,215))*/
task /*#E*/ 
jns := jns + 1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SetVisibility.spd(1),482(85,90))*/
join /*#E*/ 
grst9465_2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SetVisibility.spd(1),482(85,90))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SetVisibility.spd,4)*/
endprocedure SetVisibility;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\zeroizeVisibility.spd,4)*/
procedure zeroizeVisibility;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\zeroizeVisibility.spd(1),116(65,30))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\zeroizeVisibility.spd(1),122(65,45))*/
task {/*#E*/ 
 
n := length( gShips );
ins := 1;
};
grst697_1:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\zeroizeVisibility.spd(1),137(65,60))*/
decision /*#E*/ 
ins <= n;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\zeroizeVisibility.spd(1),191(42,67))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\zeroizeVisibility.spd(1),188(40,80))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\zeroizeVisibility.spd(1),146(77,72))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\zeroizeVisibility.spd(1),155(65,80))*/
task /*#E*/ 
jns := 1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\zeroizeVisibility.spd(1),137(65,60))*/
enddecision;
grst697_2:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\zeroizeVisibility.spd(1),143(65,95))*/
decision /*#E*/ 
 
jns <= AmountStrategy
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\zeroizeVisibility.spd(1),179(62,95))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\zeroizeVisibility.spd(1),176(40,115))*/
task /*#E*/ 
ins := ins + 1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\zeroizeVisibility.spd(1),137(65,60))*/
join /*#E*/ 
grst697_1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\zeroizeVisibility.spd(1),164(77,107))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\zeroizeVisibility.spd(1),161(65,115))*/
task {/*#E*/ 
 
gShips( ins )!VisibleToStrategy( jns ) := false;
jns := jns + 1;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\zeroizeVisibility.spd(1),143(65,95))*/
join /*#E*/ 
grst697_2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\zeroizeVisibility.spd(1),143(65,95))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\zeroizeVisibility.spd,4)*/
endprocedure zeroizeVisibility;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendCurrentState.spd,4)*/
procedure SendCurrentState;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendCurrentState.spd(1),155(55,10))*/
dcl i, n Integer;
dcl strId tStrategyId;
dcl shCS tShipCurrentState;
dcl shSCS tStringShipCurrentState;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendCurrentState.spd(1),152(90,30))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendCurrentState.spd(1),149(90,45))*/
task {/*#E*/ 
 
n := length(gShips);
i := 1;
};
grst14_1:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendCurrentState.spd(1),143(90,60))*/
decision /*#E*/ 
i <= n;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendCurrentState.spd(1),167(22,67))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendCurrentState.spd(1),140(20,80))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendCurrentState.spd(1),170(102,72))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendCurrentState.spd(1),137(90,80))*/
task {/*#E*/ 
 
shSCS := empty;
strId := gShips(i)!StrategyId;
shCS!StrategyId := gShips(i)!StrategyId;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendCurrentState.spd(1),143(90,60))*/
enddecision;
grst14_2:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendCurrentState.spd(1),131(90,110))*/
decision /*#E*/ 
 
i <= n AND strId = gShips(i)!StrategyId
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendCurrentState.spd(1),236(82,110))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendCurrentState.spd(1),125(10,120))*/
output /*#E*/ 
 
ShipsCurrentState(strId, shSCS)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendCurrentState.spd(1),143(90,60))*/
join /*#E*/ 
grst14_1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendCurrentState.spd(1),185(102,122))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendCurrentState.spd(1),119(90,130))*/
task {/*#E*/ 
 
shCS!ShipId := gShips(i)!ShipId;
shCS!TypeShip := gShips(i)!TypeShip;
shCS!Speed := gShips(i)!Speed;
shCS!Heading := gShips(i)!Heading;
shCS!Resource := gShips(i)!Resource;
shCS!Coordinates := gShips(i)!Coordinates;
shCS!Ammunition := gShips(i)!Ammunition;

shSCS := shSCS // mkstring(shCS);

i := i + 1;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendCurrentState.spd(1),131(90,110))*/
join /*#E*/ 
grst14_2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendCurrentState.spd(1),131(90,110))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendCurrentState.spd,4)*/
endprocedure SendCurrentState;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendVisibleShips.spd,4)*/
procedure SendVisibleShips;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendVisibleShips.spd(1),116(55,10))*/
dcl i, j, n Integer;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendVisibleShips.spd(1),218(90,10))*/
dcl shES tEnemyShip;
dcl shSES tStringEnemyShip;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendVisibleShips.spd(1),119(75,25))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendVisibleShips.spd(1),122(75,40))*/
task {/*#E*/ 
 
n := length(gShips);
j := 1;
};
grst1654_1:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendVisibleShips.spd(1),134(75,55))*/
decision /*#E*/ 
 
j <= AmountStrategy
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendVisibleShips.spd(1),149(17,62))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendVisibleShips.spd(1),146(15,75))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendVisibleShips.spd(1),143(87,67))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendVisibleShips.spd(1),140(75,75))*/
task {/*#E*/ 
 
i := 1;
shSES := empty;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendVisibleShips.spd(1),134(75,55))*/
enddecision;
grst1654_2:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendVisibleShips.spd(1),152(75,90))*/
decision /*#E*/ 
i <= n;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendVisibleShips.spd(1),170(87,102))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendVisibleShips.spd(1),167(75,110))*/
decision /*#E*/ 
 
gShips(i)!VisibleToStrategy(j) = true AND
  gShips(i)!StrategyId /= j
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendVisibleShips.spd(1),227(87,122))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendVisibleShips.spd(1),224(75,130))*/
task {/*#E*/ 
 
shES!ShipId := gShips(i)!ShipId;
shES!StrategyId := gShips(i)!StrategyId;
shES!TypeShip := gShips(i)!TypeShip;
shES!Speed := gShips(i)!Speed;
shES!Heading := gShips(i)!Heading;
shES!Coordinates := gShips(i)!Coordinates;

shSES := shSES // mkstring(shES);
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendVisibleShips.spd(1),197(67,110))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendVisibleShips.spd(1),167(75,110))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendVisibleShips.spd(1),191(75,160))*/
task /*#E*/ 
i := i + 1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendVisibleShips.spd(1),152(75,90))*/
join /*#E*/ 
grst1654_2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendVisibleShips.spd(1),254(17,97))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendVisibleShips.spd(1),281(10,125))*/
decision /*#E*/ 
 
length(shSES) > 0
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendVisibleShips.spd(1),284(22,137))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendVisibleShips.spd(1),251(10,145))*/
output /*#E*/ 
VisibleShip 
(j, shSES)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendVisibleShips.spd(1),293(12,125))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendVisibleShips.spd(1),281(10,125))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendVisibleShips.spd(1),203(10,160))*/
task /*#E*/ 
j := j + 1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendVisibleShips.spd(1),134(75,55))*/
join /*#E*/ 
grst1654_1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendVisibleShips.spd(1),152(75,90))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendVisibleShips.spd,4)*/
endprocedure SendVisibleShips;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Err2Str.spd,4)*/
procedure Err2Str
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Err2Str.spd,1)*/
;
returns Charstring;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Err2Str.spd(1),116(5,25))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Err2Str.spd(1),119(5,40))*/
decision /*#E*/ 
errname;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Err2Str.spd(1),194(117,52))*/
(= EN_GEN_POINTS_FAULT):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Err2Str.spd(1),191(110,55))*/
return /*#E*/ 
'generatePoints function retuns fault';
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Err2Str.spd(1),152(32,72))*/
(= EN_OK):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Err2Str.spd(1),149(25,75))*/
return /*#E*/ 
'All operations complete successfully';
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Err2Str.spd(1),203(117,72))*/
(= EN_WRONG_MAP):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Err2Str.spd(1),197(110,75))*/
return /*#E*/ 
'Wrong map format';
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Err2Str.spd(1),140(32,92))*/
(= EN_COULD_NOT_OPEN_FILE):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Err2Str.spd(1),137(25,95))*/
return /*#E*/ 
'Could not open file';
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Err2Str.spd(1),158(32,112))*/
(= EN_SHIP_NOT_FOUND):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Err2Str.spd(1),155(25,115))*/
return /*#E*/ 
'Ship not found';
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Err2Str.spd(1),164(32,132))*/
(= EN_ERROR_PROPERTY):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Err2Str.spd(1),161(25,135))*/
return /*#E*/ 
'Ship does not have this ammunition';
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Err2Str.spd(1),170(32,152))*/
(= EN_NOT_ENOUGH_AMMO):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Err2Str.spd(1),167(25,155))*/
return /*#E*/ 
'Not enough ammunition';
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Err2Str.spd(1),176(32,172))*/
(= EN_INIT_SOCKET_FAULT):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Err2Str.spd(1),173(25,175))*/
return /*#E*/ 
'Socket initialization fault';
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Err2Str.spd(1),182(32,192))*/
(= EN_SEND_DATA_FAULT):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Err2Str.spd(1),179(25,195))*/
return /*#E*/ 
'Data sending fault';
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Err2Str.spd(1),188(32,212))*/
(= EN_GET_COORD_FAULT):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Err2Str.spd(1),185(25,215))*/
return /*#E*/ 
'GetCoordinates function fault';
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Err2Str.spd(1),146(32,47))*/
else:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Err2Str.spd(1),143(25,55))*/
return /*#E*/ 
'Unknown error (strange situation)';
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Err2Str.spd(1),119(5,40))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Err2Str.spd,4)*/
endprocedure Err2Str;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd,4)*/
procedure SimIteration
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd,1)*/
;
returns tErrorCode;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(1),236(70,30))*/
dcl st Integer;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(1),167(120,30))*/
dcl shId tShipId;
dcl strId tStrategyId;
dcl shFA tFactorAcceleration;
dcl shHC tHeadingChange;
dcl shWN tNameWeaponry;
dcl shSSL tStringShotsList;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(1),545(70,45))*/
dcl strASI tArraySI;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(1),632(70,60))*/
newtype tLiteralsOrder
  literals
    SPEED,
    TURN,
    FIRE;
endnewtype;

newtype tStructOrder
  struct
    IsOrder Boolean;
    Order tLiteralsOrder;
    IsOrderPass Boolean;
    StrId tStrategyId;
    FA tFactorAcceleration;
    HC tHeadingChange;
    WN tNameWeaponry;
    SSL tStringShotsList;
endnewtype;

newtype tArrayOrder
  Array(tShipId, tStructOrder);
endnewtype;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(1),635(120,60))*/
dcl shipOrders tArrayOrder;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(1),1607(120,75))*/
synonym MAX_SHIP_ID =
  (MaxTypeBattleship + MaxTypeCruiser +
  MaxTypeDestroyer + MaxTypeMissileCutter +
  MaxTypeRepairBoat)*AmountStrategy;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(1),416(5,30))*/
procedure /*#E*/ 
NullingSI referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(1),419(5,45))*/
procedure /*#E*/ 
IsASIComplete referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(1),572(5,60))*/
procedure /*#E*/ 
CheckStrategies referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(1),638(5,75))*/
procedure /*#E*/ 
NullingShipOrders referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(1),1319(5,90))*/
procedure /*#E*/ 
SendResposeOnOrders referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(3),1454(45,10))*/
procedure /*#E*/ 
OrderFire referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(3),1457(90,10))*/
procedure /*#E*/ 
OrderTurn referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(3),1451(135,10))*/
procedure /*#E*/ 
OrderSpeed referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(4),1379(10,55))*/
procedure /*#E*/ 
ChangeCoordinate referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(4),1373(10,70))*/
procedure /*#E*/ 
CollisionShip referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(4),1376(10,85))*/
procedure /*#E*/ 
UpdateShots referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(2),335(80,10))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(2),350(80,25))*/
task {/*#E*/ 
 
errcode := call NullingSI;
errcode := call NullingShipOrders;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(2),332(80,40))*/
nextstate /*#E*/ 
idle;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(2),332(80,40))*/
state /*#E*/ 
idle;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(2),1346(5,60))*/
input /*#E*/ 
 
OrderSpeedRequest(shId, strId, shFA)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(2),803(5,75))*/
decision /*#E*/ 
 
shipOrders(shId)!IsOrder = false
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(2),806(17,87))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(2),323(5,100))*/
task {/*#E*/ 
 
shipOrders(shId)!Order := SPEED;
shipOrders(shId)!FA := shFA;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(2),845(10,120))*/
join /*#E*/ 
SI2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(2),1187(45,90))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(2),803(5,75))*/
enddecision;
grst3978_1:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(2),1181(80,120))*/
nextstate /*#E*/ 
-;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(2),317(105,60))*/
input /*#E*/ 
 
OrderTurnRequest(shId, strId, shHC)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(2),860(105,75))*/
decision /*#E*/ 
 
shipOrders(shId)!IsOrder = false
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(2),863(117,87))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(2),311(105,100))*/
task {/*#E*/ 
 
shipOrders(shId)!Order := TURN;
shipOrders(shId)!HC := shHC;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(2),875(110,120))*/
join /*#E*/ 
SI2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(2),1184(100,75))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(2),860(105,75))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(2),1181(80,120))*/
join /*#E*/ 
grst3978_1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(2),332(80,40))*/
endstate;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(2),920(80,140))*/
state /*#E*/ 
idle;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(2),917(15,160))*/
input /*#E*/ 
 
OrderFireRequest(shId, strId, shWN, shSSL)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(2),962(15,175))*/
decision /*#E*/ 
 
shipOrders(shId)!IsOrder = false
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(2),1199(7,175))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(2),974(27,187))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(2),905(15,195))*/
task {/*#E*/ 
 
shipOrders(shId)!Order := FIRE;
shipOrders(shId)!WN := shWN;
shipOrders(shId)!SSL := shSSL;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(2),989(20,210))*/
join /*#E*/ 
SI2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(2),962(15,175))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(2),1181(80,120))*/
join /*#E*/ 
grst3978_1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(2),911(110,160))*/
input /*#E*/ 
 
FinishSimulation(st, strId)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(2),899(110,175))*/
task {/*#E*/ 
 
strASI(strId) := true;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(2),890(110,195))*/
decision /*#E*/ 
 
call IsASIComplete
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(2),1202(105,195))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(2),959(122,207))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(2),881(115,215))*/
join /*#E*/ 
SI3;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(2),890(110,195))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(2),1181(80,120))*/
join /*#E*/ 
grst3978_1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(2),920(80,140))*/
endstate;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(3),1139(75,30))*/
connection /*#E*/ 
SI2:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(3),1160(70,45))*/
task {/*#E*/ 
 
shipOrders(shId)!IsOrder := true;
shipOrders(shId)!StrId := strId;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(3),1472(70,65))*/
decision /*#E*/ 
 
shipOrders(shId)!Order
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(3),1565(75,80))*/
(= SPEED):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(3),1562(50,85))*/
task /*#E*/ 
 
errcode := call OrderSpeed(shId, shipOrders(shId)!FA)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(3),1577(47,105))*/
(= TURN):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(3),1574(35,110))*/
task /*#E*/ 
 
errcode := call OrderTurn(shId, shipOrders(shId)!HC)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(3),1589(32,130))*/
(= FIRE):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(3),1586(20,135))*/
task /*#E*/ 
 
errcode := call OrderFire(shId, shipOrders(shId)!WN, shipOrders(shId)!SSL)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(3),1472(70,65))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(3),1538(70,160))*/
decision /*#E*/ 
errcode;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(3),1544(107,167))*/
(= EC_OK):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(3),1529(95,175))*/
task /*#E*/ 
 
shipOrders(shId)!IsOrderPass := true
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(3),1541(32,167))*/
else:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(3),1535(20,175))*/
output /*#E*/ 
messageError 
(call Err2Str)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(3),1538(70,160))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(3),1523(70,195))*/
nextstate /*#E*/ 
-;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(3),1139(75,30))*/
endconnection SI2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(4),1415(75,40))*/
connection /*#E*/ 
SI3:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(4),1412(70,55))*/
task {/*#E*/ 
 
errcode := call SendResposeOnOrders;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(4),1406(70,70))*/
task {/*#E*/ 
 
call ChangeCoordinate;
call CollisionShip;
call UpdateShots;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(4),1400(70,85))*/
output /*#E*/ 
messageLog 
('Check all strategies for Lose and Victory')
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(4),1394(70,100))*/
task {/*#E*/ 
 
errcode := call NullingSI;
errcode := call CheckStrategies;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(4),1388(70,115))*/
task /*#E*/ 
 
errname := EN_OK
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(4),1382(75,135))*/
return /*#E*/ 
EC_OK;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd(4),1415(75,40))*/
endconnection SI3;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SimIteration.spd,4)*/
endprocedure SimIteration;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\NullingSI.spd,4)*/
procedure NullingSI
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\NullingSI.spd,1)*/
;
returns tErrorCode;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\NullingSI.spd(1),116(50,10))*/
dcl i Integer;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\NullingSI.spd(1),119(85,30))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\NullingSI.spd(1),122(85,45))*/
task /*#E*/ 
i := 1;
grst6402_1:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\NullingSI.spd(1),128(85,60))*/
decision /*#E*/ 
 
i <= AmountStrategy
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\NullingSI.spd(1),158(27,67))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\NullingSI.spd(1),155(20,80))*/
task /*#E*/ 
 
errname := EN_OK
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\NullingSI.spd(1),167(25,95))*/
return /*#E*/ 
EC_OK;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\NullingSI.spd(1),143(97,72))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\NullingSI.spd(1),140(85,80))*/
task {/*#E*/ 
 
strASI(i) := false;
i := i + 1;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\NullingSI.spd(1),128(85,60))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\NullingSI.spd(1),128(85,60))*/
join /*#E*/ 
grst6402_1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\NullingSI.spd,4)*/
endprocedure NullingSI;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\IsASIComplete.spd,4)*/
procedure IsASIComplete
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\IsASIComplete.spd,1)*/
;
returns Boolean;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\IsASIComplete.spd(1),119(45,10))*/
dcl i Integer;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\IsASIComplete.spd(1),122(70,30))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\IsASIComplete.spd(1),131(70,45))*/
task /*#E*/ 
i := 1;
grst5218_1:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\IsASIComplete.spd(1),137(70,60))*/
decision /*#E*/ 
 
i <= AmountStrategy AND gASI(i) = true
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\IsASIComplete.spd(1),200(27,67))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\IsASIComplete.spd(1),197(20,75))*/
return /*#E*/ 
true;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\IsASIComplete.spd(1),164(82,72))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\IsASIComplete.spd(1),161(70,85))*/
decision /*#E*/ 
 
strASI(i) = true
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\IsASIComplete.spd(1),182(27,92))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\IsASIComplete.spd(1),191(20,105))*/
return /*#E*/ 
false;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\IsASIComplete.spd(1),173(82,97))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\IsASIComplete.spd(1),170(70,105))*/
task /*#E*/ 
i := i + 1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\IsASIComplete.spd(1),161(70,85))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\IsASIComplete.spd(1),137(70,60))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\IsASIComplete.spd(1),137(70,60))*/
join /*#E*/ 
grst5218_1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\IsASIComplete.spd,4)*/
endprocedure IsASIComplete;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CheckStrategies.spd,4)*/
procedure CheckStrategies
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CheckStrategies.spd,1)*/
;
returns tErrorCode;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CheckStrategies.spd(1),116(45,10))*/
dcl i, j, n, ns Integer;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CheckStrategies.spd(1),119(80,30))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CheckStrategies.spd(1),122(80,45))*/
task {/*#E*/ 
 
i := 1;
n := length(gShips);
};
grst484_1:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CheckStrategies.spd(1),128(80,60))*/
decision /*#E*/ 
 
i <= n
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CheckStrategies.spd(1),194(27,67))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CheckStrategies.spd(1),191(20,80))*/
task {/*#E*/ 
 
i := 1;
j := 0;
ns := 0;
};
grst484_2:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CheckStrategies.spd(1),203(80,100))*/
decision /*#E*/ 
 
i <= AmountStrategy
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CheckStrategies.spd(1),404(70,100))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CheckStrategies.spd(1),401(55,115))*/
join /*#E*/ 
CS1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CheckStrategies.spd(1),218(92,112))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CheckStrategies.spd(1),521(80,130))*/
decision /*#E*/ 
 
gASI(i) = true
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CheckStrategies.spd(1),524(92,142))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CheckStrategies.spd(1),215(80,150))*/
decision /*#E*/ 
 
strASI(i) = false
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CheckStrategies.spd(1),248(67,150))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CheckStrategies.spd(1),245(50,170))*/
task {/*#E*/ 
j := j + 1;
ns := i;};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CheckStrategies.spd(1),557(87,165))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CheckStrategies.spd(1),554(75,175))*/
decision /*#E*/ 
 
TestMode
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CheckStrategies.spd(1),581(117,180))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CheckStrategies.spd(1),314(105,185))*/
output /*#E*/ 
StrategyLose 
( i )
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CheckStrategies.spd(1),578(92,190))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CheckStrategies.spd(1),554(75,175))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CheckStrategies.spd(1),356(80,205))*/
task /*#E*/ 
 
gASI(i) := false
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CheckStrategies.spd(1),215(80,150))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CheckStrategies.spd(1),533(70,130))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CheckStrategies.spd(1),521(80,130))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CheckStrategies.spd(1),239(50,200))*/
task /*#E*/ 
i := i + 1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CheckStrategies.spd(1),203(80,100))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CheckStrategies.spd(1),203(80,100))*/
join /*#E*/ 
grst484_2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CheckStrategies.spd(1),155(92,72))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CheckStrategies.spd(1),152(80,80))*/
task {/*#E*/ 
 
strASI(gShips(i)!StrategyId) := true;
i := i + 1;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CheckStrategies.spd(1),128(80,60))*/
join /*#E*/ 
grst484_1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CheckStrategies.spd(1),128(80,60))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CheckStrategies.spd(2),419(110,30))*/
connection /*#E*/ 
CS1:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CheckStrategies.spd(2),458(105,45))*/
decision /*#E*/ 
 
j = 0
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CheckStrategies.spd(2),467(100,45))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CheckStrategies.spd(2),440(45,60))*/
decision /*#E*/ 
 
( j = 1 ) AND
  ( gShots = empty ) AND
  (NOT TestMode)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CheckStrategies.spd(2),482(57,72))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CheckStrategies.spd(2),536(45,80))*/
task /*#E*/ 
victory := true;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CheckStrategies.spd(2),446(45,95))*/
output /*#E*/ 
StrategyVictory 
( ns )
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CheckStrategies.spd(2),509(37,60))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CheckStrategies.spd(2),440(45,60))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CheckStrategies.spd(2),464(117,55))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CheckStrategies.spd(2),452(105,60))*/
task /*#E*/ 
 
gShots := empty
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CheckStrategies.spd(2),542(105,80))*/
task /*#E*/ 
victory := true;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CheckStrategies.spd(2),458(105,45))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CheckStrategies.spd(2),428(45,115))*/
task /*#E*/ 
 
errname := EN_OK
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CheckStrategies.spd(2),422(50,130))*/
return /*#E*/ 
EC_OK;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CheckStrategies.spd(2),419(110,30))*/
endconnection CS1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CheckStrategies.spd,4)*/
endprocedure CheckStrategies;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\NullingShipOrders.spd,4)*/
procedure NullingShipOrders
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\NullingShipOrders.spd,1)*/
;
returns tErrorCode;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\NullingShipOrders.spd(1),116(60,10))*/
dcl i Integer;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\NullingShipOrders.spd(1),119(70,25))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\NullingShipOrders.spd(1),122(70,40))*/
task /*#E*/ 
i := 1;
grst7210_1:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\NullingShipOrders.spd(1),128(70,60))*/
decision /*#E*/ 
 
i <= MAX_SHIP_ID
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\NullingShipOrders.spd(1),173(17,67))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\NullingShipOrders.spd(1),155(10,80))*/
task /*#E*/ 
 
errname := EN_OK
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\NullingShipOrders.spd(1),167(15,95))*/
return /*#E*/ 
EC_OK;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\NullingShipOrders.spd(1),143(82,72))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\NullingShipOrders.spd(1),140(70,80))*/
task {/*#E*/ 
 
shipOrders(i)!IsOrder := false;
shipOrders(i)!IsOrderPass := false;
i := i + 1;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\NullingShipOrders.spd(1),128(70,60))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\NullingShipOrders.spd(1),128(70,60))*/
join /*#E*/ 
grst7210_1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\NullingShipOrders.spd,4)*/
endprocedure NullingShipOrders;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendResposeOnOrders.spd,4)*/
procedure SendResposeOnOrders
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendResposeOnOrders.spd,1)*/
;
returns tErrorCode;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendResposeOnOrders.spd(1),125(5,25))*/
dcl i Integer;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendResposeOnOrders.spd(1),116(85,10))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendResposeOnOrders.spd(1),128(85,25))*/
task /*#E*/ 
i := 1;
grst7473_1:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendResposeOnOrders.spd(1),152(85,45))*/
decision /*#E*/ 
 
i <= MAX_SHIP_ID
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendResposeOnOrders.spd(1),368(97,57))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendResposeOnOrders.spd(1),170(85,75))*/
decision /*#E*/ 
 
shipOrders(i)!IsOrder
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendResposeOnOrders.spd(1),191(72,82))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendResposeOnOrders.spd(1),188(65,90))*/
decision /*#E*/ 
 
shipOrders(i)!Order
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendResposeOnOrders.spd(1),212(77,102))*/
(= SPEED):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendResposeOnOrders.spd(1),209(65,110))*/
decision /*#E*/ 
 
shipOrders(i)!IsOrderPass
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendResposeOnOrders.spd(1),245(17,117))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendResposeOnOrders.spd(1),371(10,125))*/
output /*#E*/ 
 
OrderSpeedReject(i,
  shipOrders(i)!StrId)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendResposeOnOrders.spd(1),224(82,122))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendResposeOnOrders.spd(1),386(90,125))*/
output /*#E*/ 
 
OrderSpeedResponse(i,
  shipOrders(i)!StrId)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendResposeOnOrders.spd(1),209(65,110))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendResposeOnOrders.spd(1),464(77,142))*/
(= TURN):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendResposeOnOrders.spd(1),272(65,150))*/
decision /*#E*/ 
 
shipOrders(i)!IsOrderPass
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendResposeOnOrders.spd(1),287(17,157))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendResposeOnOrders.spd(1),395(10,165))*/
output /*#E*/ 
 
OrderTurnReject(i,
  shipOrders(i)!StrId)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendResposeOnOrders.spd(1),299(82,162))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendResposeOnOrders.spd(1),404(90,165))*/
output /*#E*/ 
 
OrderTurnResponse(i,
  shipOrders(i)!StrId)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendResposeOnOrders.spd(1),272(65,150))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendResposeOnOrders.spd(1),467(77,182))*/
(= FIRE):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendResposeOnOrders.spd(1),314(65,190))*/
decision /*#E*/ 
 
shipOrders(i)!IsOrderPass
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendResposeOnOrders.spd(1),458(17,197))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendResposeOnOrders.spd(1),452(10,210))*/
output /*#E*/ 
 
OrderFireReject(i,
  shipOrders(i)!StrId)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendResposeOnOrders.spd(1),443(80,205))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendResposeOnOrders.spd(1),440(90,210))*/
output /*#E*/ 
 
OrderFireResponse(i,
  shipOrders(i)!StrId)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendResposeOnOrders.spd(1),314(65,190))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendResposeOnOrders.spd(1),188(65,90))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendResposeOnOrders.spd(1),203(160,90))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendResposeOnOrders.spd(1),170(85,75))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendResposeOnOrders.spd(1),200(160,115))*/
task /*#E*/ 
i := i + 1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendResposeOnOrders.spd(1),158(12,52))*/
else:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendResposeOnOrders.spd(1),140(5,75))*/
task /*#E*/ 
 
errname := EN_OK
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendResposeOnOrders.spd(1),119(10,90))*/
return /*#E*/ 
EC_OK;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendResposeOnOrders.spd(1),152(85,45))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendResposeOnOrders.spd(1),152(85,45))*/
join /*#E*/ 
grst7473_1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendResposeOnOrders.spd,4)*/
endprocedure SendResposeOnOrders;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderFire.spd,4)*/
procedure OrderFire
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderFire.spd,1)*/
;fpar
shipid tShipId,
NameWeaponry tNameWeaponry,
listshot tStringShotsList;
returns tErrorCode;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderFire.spd(1),128(95,10))*/
dcl
i Integer,
countershot Integer,
leng Integer,
ShotParam tShotParameters,
CurCoor tCoordinates,
bool Boolean;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderFire.spd(1),257(5,40))*/
procedure /*#E*/ 
GetCurrentCoordinate referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderFire.spd(1),323(5,55))*/
procedure /*#E*/ 
GetProperty referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderFire.spd(1),440(5,70))*/
procedure /*#E*/ 
GetNumberShip referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderFire.spd(1),446(5,85))*/
procedure /*#E*/ 
GetAmmunition referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderFire.spd(1),773(5,100))*/
procedure /*#E*/ 
GetLenghtShot referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderFire.spd(1),776(5,115))*/
procedure /*#E*/ 
GetFinishCoordinate referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderFire.spd(1),179(65,45))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderFire.spd(1),185(65,60))*/
task {/*#E*/ 
 
countershot:=length(listshot);
leng:=length(gShips);
i:=1;
bool:=call GetProperty(shipid);
errcode:=call GetNumberShip(leng,shipid);
call GetLenghtShot(countershot,leng);
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderFire.spd(1),650(65,105))*/
decision /*#E*/ 
 
bool=true
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderFire.spd(1),692(77,117))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderFire.spd(1),701(65,125))*/
decision /*#E*/ 
 
errcode=EC_OK
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderFire.spd(1),713(122,155))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderFire.spd(1),719(65,160))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderFire.spd(1),818(35,190))*/
task /*#E*/ 
 
 errname:=EN_SHIP_NOT_FOUND
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderFire.spd(1),716(40,205))*/
return /*#E*/ 
 EC_FAULT;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderFire.spd(1),701(65,125))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderFire.spd(1),668(65,140))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderFire.spd(1),779(5,160))*/
task /*#E*/ 
 
errname:= EN_ERROR_PROPERTY
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderFire.spd(1),665(10,175))*/
return /*#E*/ 
 EC_FAULT;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderFire.spd(1),650(65,105))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderFire.spd(1),761(170,135))*/
L3:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderFire.spd(1),710(110,155))*/
task {/*#E*/ 
 
bool:=call GetAmmunition(leng);
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderFire.spd(1),734(110,170))*/
decision /*#E*/ 
 
bool=true
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderFire.spd(1),743(122,182))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderFire.spd(1),740(115,195))*/
join /*#E*/ 
L2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderFire.spd(1),749(137,185))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderFire.spd(1),839(135,195))*/
task /*#E*/ 
 
errname:=EN_OK
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderFire.spd(1),746(140,210))*/
return /*#E*/ 
EC_OK;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderFire.spd(1),734(110,170))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderFire.spd(2),350(80,40))*/
connection /*#E*/ 
L2:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderFire.spd(2),386(75,95))*/
decision /*#E*/ 
 
i<=countershot
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderFire.spd(2),407(27,97))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderFire.spd(2),851(20,105))*/
task /*#E*/ 
 
errname:=EN_OK
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderFire.spd(2),374(25,120))*/
return /*#E*/ 
EC_OK;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderFire.spd(2),404(87,107))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderFire.spd(2),380(75,115))*/
task {/*#E*/ 
 
errcode:= call GetCurrentCoordinate(shipid,CurCoor );
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderFire.spd(2),371(75,130))*/
decision /*#E*/ 
 
errcode=EC_OK
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderFire.spd(2),419(87,142))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderFire.spd(2),365(75,155))*/
task {/*#E*/ 
 
ShotParam!TypeWeaponry:=NameWeaponry;
ShotParam!CurrentCoordinates:=CurCoor;
ShotParam!FinishCoordinates:=call GetFinishCoordinate(
CurCoor, listshot(i));
ShotParam!ShotId:=next_shot_id;
next_shot_id:=next_shot_id+1;

};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderFire.spd(2),359(75,175))*/
task {/*#E*/ 
 
gShots:=gShots//mkstring(ShotParam);
i:=i+1;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderFire.spd(2),875(75,190))*/
output /*#E*/ 
messageLog 
('gShots')
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderFire.spd(2),755(110,210))*/
join /*#E*/ 
L3;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderFire.spd(2),422(12,137))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderFire.spd(2),863(5,165))*/
task /*#E*/ 
 
errname:=EN_SHIP_NOT_FOUND
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderFire.spd(2),353(10,210))*/
return /*#E*/ 
EC_FAULT;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderFire.spd(2),371(75,130))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderFire.spd(2),386(75,95))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderFire.spd(2),350(80,40))*/
endconnection L2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderFire.spd,4)*/
endprocedure OrderFire;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCurrentCoordinate.spd,4)*/
procedure GetCurrentCoordinate
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCurrentCoordinate.spd,1)*/
;fpar
shipid tShipId,
in/out  CurCoor tCoordinates;
returns tErrorCode;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCurrentCoordinate.spd(1),125(135,10))*/
dcl
i Integer,
leng  Integer;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCurrentCoordinate.spd(1),212(60,35))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCurrentCoordinate.spd(1),326(60,65))*/
task /*#E*/ 
i:=1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCurrentCoordinate.spd(1),323(60,80))*/
task /*#E*/ 
 
leng:=length(gShips)
;
grst9190_1:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCurrentCoordinate.spd(1),317(60,95))*/
decision /*#E*/ 
 
i<=leng
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCurrentCoordinate.spd(1),344(72,107))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCurrentCoordinate.spd(1),308(60,120))*/
decision /*#E*/ 
 
shipid=gShips(i)!ShipId 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCurrentCoordinate.spd(1),350(72,132))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCurrentCoordinate.spd(1),302(60,145))*/
task /*#E*/ 
i:=i+1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCurrentCoordinate.spd(1),359(27,127))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCurrentCoordinate.spd(1),185(20,160))*/
task /*#E*/ 
 
CurCoor:=gShips(i)!Coordinates
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCurrentCoordinate.spd(1),362(20,175))*/
task /*#E*/ 
 
errname := EN_OK
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCurrentCoordinate.spd(1),206(25,190))*/
return /*#E*/ 
EC_OK;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCurrentCoordinate.spd(1),308(60,120))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCurrentCoordinate.spd(1),341(175,155))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCurrentCoordinate.spd(1),374(120,170))*/
task /*#E*/ 
 
errname := EN_SHIP_NOT_FOUND
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCurrentCoordinate.spd(1),311(125,185))*/
return /*#E*/ 
 EC_FAULT;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCurrentCoordinate.spd(1),317(60,95))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCurrentCoordinate.spd(1),317(60,95))*/
join /*#E*/ 
grst9190_1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetCurrentCoordinate.spd,4)*/
endprocedure GetCurrentCoordinate;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetProperty.spd,4)*/
procedure GetProperty
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetProperty.spd,1)*/
;fpar
shipid tShipId;
returns Boolean;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetProperty.spd(1),125(135,45))*/
dcl
leng Integer,
i Integer;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetProperty.spd(1),116(70,10))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetProperty.spd(1),131(70,30))*/
task /*#E*/ 
 
i:=1

;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetProperty.spd(1),350(70,45))*/
task /*#E*/ 
 
leng:=length(gShips)
;
grst475_1:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetProperty.spd(1),137(70,70))*/
decision /*#E*/ 
 
i<=leng
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetProperty.spd(1),164(82,82))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetProperty.spd(1),161(70,85))*/
decision /*#E*/ 
 
shipid = gShips(i)!ShipId 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetProperty.spd(1),182(82,97))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetProperty.spd(1),179(70,110))*/
decision /*#E*/ 
 
 NameWeaponry
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetProperty.spd(1),209(32,125))*/
(MISSILE):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetProperty.spd(1),206(25,140))*/
decision /*#E*/ 
 
gShips(i)!TypeShip
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetProperty.spd(1),221(0,190))*/
(DESTROYER ,REPAIR_BOAT
):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetProperty.spd(1),218(15,175))*/
return /*#E*/ 
false;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetProperty.spd(1),434(52,155))*/
else:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetProperty.spd(1),383(45,200))*/
return /*#E*/ 
true;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetProperty.spd(1),206(25,140))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetProperty.spd(1),320(137,125))*/
( REPAIR):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetProperty.spd(1),317(130,140))*/
join /*#E*/ 
L3;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetProperty.spd(1),266(162,125))*/
(  SHELL):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetProperty.spd(1),263(155,140))*/
join /*#E*/ 
L2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetProperty.spd(1),236(82,130))*/
(TORPEDO):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetProperty.spd(1),233(125,160))*/
decision /*#E*/ 
 
gShips(i)!TypeShip
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetProperty.spd(1),242(122,177))*/
(MISSILE_CUTTER,REPAIR_BOAT
):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetProperty.spd(1),239(95,205))*/
return /*#E*/ 
false;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetProperty.spd(1),431(157,175))*/
else:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetProperty.spd(1),245(150,205))*/
return /*#E*/ 
true;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetProperty.spd(1),233(125,160))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetProperty.spd(1),179(70,110))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetProperty.spd(1),197(152,102))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetProperty.spd(1),194(165,110))*/
task /*#E*/ 
i:=i+1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetProperty.spd(1),161(70,85))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetProperty.spd(1),158(22,85))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetProperty.spd(1),155(20,95))*/
return /*#E*/ 
false;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetProperty.spd(1),137(70,70))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetProperty.spd(1),137(70,70))*/
join /*#E*/ 
grst475_1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetProperty.spd(2),281(50,45))*/
connection /*#E*/ 
L2:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetProperty.spd(2),293(45,60))*/
decision /*#E*/ 
 
gShips(i)!TypeShip
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetProperty.spd(2),308(12,85))*/
(MISSILE_CUTTER,REPAIR_BOAT
):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetProperty.spd(2),305(25,120))*/
return /*#E*/ 
false;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetProperty.spd(2),437(82,75))*/
else:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetProperty.spd(2),311(75,120))*/
return /*#E*/ 
true;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetProperty.spd(2),293(45,60))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetProperty.spd(2),281(50,45))*/
endconnection L2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetProperty.spd(2),323(75,135))*/
connection /*#E*/ 
L3:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetProperty.spd(2),326(70,155))*/
decision /*#E*/ 
 
gShips(i)!TypeShip
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetProperty.spd(2),341(52,172))*/
(REPAIR_BOAT):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetProperty.spd(2),332(60,190))*/
return /*#E*/ 
true;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetProperty.spd(2),338(92,170))*/
else:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetProperty.spd(2),335(85,190))*/
return /*#E*/ 
false;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetProperty.spd(2),326(70,155))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetProperty.spd(2),323(75,135))*/
endconnection L3;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetProperty.spd,4)*/
endprocedure GetProperty;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetNumberShip.spd,4)*/
procedure GetNumberShip
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetNumberShip.spd,1)*/
;fpar
in/out Number Integer,
shipid tShipId;
returns tErrorCode;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetNumberShip.spd(1),200(110,10))*/
dcl 
i Integer;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetNumberShip.spd(1),152(65,45))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetNumberShip.spd(1),149(65,60))*/
task /*#E*/ 
i:=1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetNumberShip.spd(1),146(65,75))*/
task /*#E*/ 
 
leng:=length(gShips)
;
grst525_1:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetNumberShip.spd(1),140(65,90))*/
decision /*#E*/ 
 
i<=leng
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetNumberShip.spd(1),179(77,102))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetNumberShip.spd(1),131(65,115))*/
decision /*#E*/ 
 
shipid=gShips(i)!ShipId 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetNumberShip.spd(1),185(77,127))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetNumberShip.spd(1),125(65,140))*/
task /*#E*/ 
i:=i+1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetNumberShip.spd(1),206(42,122))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetNumberShip.spd(1),203(35,160))*/
task /*#E*/ 
 
Number:=i
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetNumberShip.spd(1),116(40,180))*/
return /*#E*/ 
EC_OK;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetNumberShip.spd(1),131(65,115))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetNumberShip.spd(1),176(22,97))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetNumberShip.spd(1),218(15,200))*/
task /*#E*/ 
 
errname:= EN_SHIP_NOT_FOUND
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetNumberShip.spd(1),134(20,215))*/
return /*#E*/ 
 EC_FAULT;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetNumberShip.spd(1),140(65,90))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetNumberShip.spd(1),140(65,90))*/
join /*#E*/ 
grst525_1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetNumberShip.spd,4)*/
endprocedure GetNumberShip;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetAmmunition.spd,4)*/
procedure GetAmmunition
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetAmmunition.spd,1)*/
;fpar
NumberShip Integer;
returns Boolean;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetAmmunition.spd(1),116(55,40))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetAmmunition.spd(1),137(55,55))*/
decision /*#E*/ 
 
gShips(NumberShip)!Ammunition(NameWeaponry)>0
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetAmmunition.spd(1),152(72,65))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetAmmunition.spd(1),149(55,70))*/
task /*#E*/ 
 
gShips(NumberShip)!Ammunition(NameWeaponry):=
gShips(NumberShip)!Ammunition(NameWeaponry)-1
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetAmmunition.spd(1),161(60,100))*/
return /*#E*/ 
true;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetAmmunition.spd(1),170(22,62))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetAmmunition.spd(1),167(20,100))*/
return /*#E*/ 
false;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetAmmunition.spd(1),137(55,55))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetAmmunition.spd,4)*/
endprocedure GetAmmunition;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetLenghtShot.spd,4)*/
procedure GetLenghtShot
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetLenghtShot.spd,1)*/
;fpar
in/out lenght Integer,
number Integer;


/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetLenghtShot.spd(1),125(130,10))*/
dcl
shipname  tNameShip;

/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetLenghtShot.spd(1),116(50,40))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetLenghtShot.spd(1),152(50,55))*/
task /*#E*/ 
 
shipname:=gShips(number)!TypeShip
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetLenghtShot.spd(1),167(50,70))*/
decision /*#E*/ 
 
lenght > gShipsCharacter(shipname)!MaxLaunchUnit(NameWeaponry) 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetLenghtShot.spd(1),182(62,82))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetLenghtShot.spd(1),179(50,100))*/
task /*#E*/ 
 
lenght:=gShipsCharacter(shipname)!MaxLaunchUnit(NameWeaponry)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetLenghtShot.spd(1),191(12,77))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetLenghtShot.spd(1),167(50,70))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetLenghtShot.spd(1),119(10,150))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetLenghtShot.spd,4)*/
endprocedure GetLenghtShot;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetFinishCoordinate.spd,4)*/
procedure GetFinishCoordinate
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetFinishCoordinate.spd,1)*/
;fpar
  CurrentCoordinate tCoordinates,
  FinishCoordinate tCoordinates;
returns tCoordinates;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetFinishCoordinate.spd(1),119(110,15))*/
dcl
  Range, cX, cY, fX, fY Integer,
  Coor tCoordinates;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetFinishCoordinate.spd(1),122(70,20))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetFinishCoordinate.spd(1),248(70,35))*/
task {/*#E*/ 
 
cX := CurrentCoordinate!x;
cY := CurrentCoordinate!y;
fX := FinishCoordinate!x;
fY := FinishCoordinate!y;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetFinishCoordinate.spd(1),137(70,55))*/
task /*#E*/ 
 
Range :=  call getDistance(cX, cY, fX, fY)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetFinishCoordinate.spd(1),161(70,75))*/
decision /*#E*/ 
 
Range>gWeaponryCharacter(NameWeaponry)!Range
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetFinishCoordinate.spd(1),182(127,90))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetFinishCoordinate.spd(1),179(115,100))*/
task /*#E*/ 
 
Coor:=FinishCoordinate
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetFinishCoordinate.spd(1),176(12,90))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetFinishCoordinate.spd(1),173(5,125))*/
task {/*#E*/ 
 
Range := call sdl_sqrt((fX-cX)*(fX-cX) + (fY-cY)*(fY-cY));

Coor!x := cX + fix(float(gWeaponryCharacter(NameWeaponry)!Range*(fX - cX))/float(Range));
Coor!y := cY + fix(float(gWeaponryCharacter(NameWeaponry)!Range*(fY - cY))/float(Range));
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetFinishCoordinate.spd(1),161(70,75))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetFinishCoordinate.spd(1),125(120,150))*/
return /*#E*/ 
Coor;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\GetFinishCoordinate.spd,4)*/
endprocedure GetFinishCoordinate;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderTurn.spd,4)*/
procedure OrderTurn
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderTurn.spd,1)*/
;fpar
Shipid tShipId,
Heading tHeadingChange;
returns tErrorCode;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderTurn.spd(1),131(100,5))*/
dcl
head tHeading,
i Integer,
leng Integer,
number Integer;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderTurn.spd(1),116(65,40))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderTurn.spd(1),119(65,55))*/
task {/*#E*/ 
 
i:=1;
leng:=length(gShips);
};
grst1764_1:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderTurn.spd(1),134(65,70))*/
decision /*#E*/ 
 
i<=leng
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderTurn.spd(1),155(12,85))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderTurn.spd(1),392(5,100))*/
task /*#E*/ 
 
errname:=EN_SHIP_NOT_FOUND
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderTurn.spd(1),152(10,115))*/
return /*#E*/ 
EC_FAULT;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderTurn.spd(1),185(77,82))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderTurn.spd(1),182(65,120))*/
decision /*#E*/ 
 
gShips(i)! ShipId=Shipid
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderTurn.spd(1),209(32,127))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderTurn.spd(1),203(15,145))*/
task /*#E*/ 
 
head:=gShips(i)!Heading
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderTurn.spd(1),221(15,160))*/
task {/*#E*/ 
 
number:=h2i(head);
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderTurn.spd(1),242(60,175))*/
decision /*#E*/ 
 
Heading=LEFT
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderTurn.spd(1),263(27,187))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderTurn.spd(1),260(20,195))*/
task /*#E*/ 
 
number:=number+1
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderTurn.spd(1),257(102,190))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderTurn.spd(1),254(90,195))*/
task /*#E*/ 
 
number:=number-1
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderTurn.spd(1),242(60,175))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderTurn.spd(1),278(75,215))*/
join /*#E*/ 
L2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderTurn.spd(1),197(132,132))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderTurn.spd(1),194(120,145))*/
task /*#E*/ 
i:=i+1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderTurn.spd(1),182(65,120))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderTurn.spd(1),134(65,70))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderTurn.spd(1),134(65,70))*/
join /*#E*/ 
grst1764_1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderTurn.spd(2),299(70,45))*/
connection /*#E*/ 
L2:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderTurn.spd(2),302(65,60))*/
decision /*#E*/ 
 
number<0
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderTurn.spd(2),320(50,67))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderTurn.spd(2),317(20,75))*/
task {/*#E*/ 
 
number:=7;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderTurn.spd(2),332(77,72))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderTurn.spd(2),329(65,95))*/
decision /*#E*/ 
 
number>7
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderTurn.spd(2),344(52,110))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderTurn.spd(2),341(45,120))*/
task /*#E*/ 
number:=0;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderTurn.spd(2),350(77,107))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderTurn.spd(2),329(65,95))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderTurn.spd(2),302(65,60))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderTurn.spd(2),347(65,165))*/
task /*#E*/ 
 
head:=i2h(number)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderTurn.spd(2),371(65,180))*/
task {/*#E*/ 
 
gShips(i)!Heading:=head;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderTurn.spd(2),404(65,195))*/
task /*#E*/ 
 
errname:=EN_OK
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderTurn.spd(2),365(70,215))*/
return /*#E*/ 
EC_OK;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderTurn.spd(2),299(70,45))*/
endconnection L2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderTurn.spd,4)*/
endprocedure OrderTurn;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderSpeed.spd,4)*/
procedure OrderSpeed
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderSpeed.spd,1)*/
;fpar
shipid tShipId,
Acceleration tFactorAcceleration;
returns tErrorCode;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderSpeed.spd(1),125(150,10))*/
dcl
speed Integer,
i Integer,
leng Integer;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderSpeed.spd(1),116(85,20))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderSpeed.spd(1),128(85,35))*/
task /*#E*/ 
 
i:=1
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderSpeed.spd(1),368(85,50))*/
task /*#E*/ 
 
leng:=length(gShips)
;
grst3470_1:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderSpeed.spd(1),134(85,75))*/
decision /*#E*/ 
i<=leng;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderSpeed.spd(1),158(97,87))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderSpeed.spd(1),155(85,95))*/
decision /*#E*/ 
 
gShips(i)!ShipId=shipid
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderSpeed.spd(1),179(132,110))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderSpeed.spd(1),176(120,140))*/
task /*#E*/ 
i:=i+1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderSpeed.spd(1),170(67,110))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderSpeed.spd(1),167(60,155))*/
task /*#E*/ 
 
speed :=gShips(i)!Speed+fix(Acceleration*float( 
gShipsCharacter(gShips(i)!TypeShip)! MaxAcceleration ))

;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderSpeed.spd(1),197(60,170))*/
decision /*#E*/ 
 
speed>gShipsCharacter(gShips(i)!TypeShip)! MaxSpeed
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderSpeed.spd(1),212(72,182))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderSpeed.spd(1),209(60,185))*/
task /*#E*/ 
 
gShips(i)!Speed:=gShipsCharacter(gShips(i)!TypeShip)! MaxSpeed
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderSpeed.spd(1),413(60,200))*/
task /*#E*/ 
 
errname:=EN_OK
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderSpeed.spd(1),362(125,215))*/
return /*#E*/ 
EC_OK;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderSpeed.spd(1),269(12,185))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderSpeed.spd(1),266(5,195))*/
decision /*#E*/ 
 
speed<0
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderSpeed.spd(1),332(17,207))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderSpeed.spd(1),329(10,210))*/
join /*#E*/ 
L3;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderSpeed.spd(1),293(30,215))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderSpeed.spd(1),290(45,215))*/
join /*#E*/ 
L2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderSpeed.spd(1),266(5,195))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderSpeed.spd(1),197(60,170))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderSpeed.spd(1),155(85,95))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderSpeed.spd(1),152(22,90))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderSpeed.spd(1),392(15,140))*/
task /*#E*/ 
 
errname:= EN_SHIP_NOT_FOUND
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderSpeed.spd(1),149(20,155))*/
return /*#E*/ 
EC_FAULT;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderSpeed.spd(1),134(85,75))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderSpeed.spd(1),134(85,75))*/
join /*#E*/ 
grst3470_1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderSpeed.spd(2),308(35,45))*/
connection /*#E*/ 
L2:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderSpeed.spd(2),311(30,60))*/
task /*#E*/ 
 
gShips(i)!Speed:=0
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderSpeed.spd(2),428(30,80))*/
task /*#E*/ 
 
errname:=EN_OK
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderSpeed.spd(2),323(35,105))*/
return /*#E*/ 
EC_OK;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderSpeed.spd(2),308(35,45))*/
endconnection L2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderSpeed.spd(2),335(110,45))*/
connection /*#E*/ 
L3:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderSpeed.spd(2),338(105,60))*/
task /*#E*/ 
 
gShips(i)!Speed:=speed
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderSpeed.spd(2),443(105,80))*/
task /*#E*/ 
 
errname:=EN_OK
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderSpeed.spd(2),350(110,105))*/
return /*#E*/ 
EC_OK;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderSpeed.spd(2),335(110,45))*/
endconnection L3;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\OrderSpeed.spd,4)*/
endprocedure OrderSpeed;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ChangeCoordinate.spd,4)*/
procedure ChangeCoordinate;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ChangeCoordinate.spd(1),128(30,10))*/
dcl
  i, j, len, speed Integer,
  St   tStringShipParameters;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ChangeCoordinate.spd(1),533(10,30))*/
procedure /*#E*/ 
ReadHeading referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ChangeCoordinate.spd(1),122(80,25))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ChangeCoordinate.spd(1),131(80,40))*/
task {/*#E*/ 
 
len := length( gShips );
i := 1;
};
grst2180_1:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ChangeCoordinate.spd(1),146(80,55))*/
decision /*#E*/ 
i <= len;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ChangeCoordinate.spd(1),173(47,55))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ChangeCoordinate.spd(1),170(45,70))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ChangeCoordinate.spd(1),857(92,67))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ChangeCoordinate.spd(1),746(80,75))*/
task /*#E*/ 
j := 1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ChangeCoordinate.spd(1),377(80,90))*/
decision /*#E*/ 
 
gShips(i)!Heading
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ChangeCoordinate.spd(1),395(32,90))*/
(NORTH, EAST, SOUTH, WEST):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ChangeCoordinate.spd(1),392(10,105))*/
task /*#E*/ 
 
speed := gShips(i)!Speed
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ChangeCoordinate.spd(1),407(92,100))*/
else:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ChangeCoordinate.spd(1),389(80,105))*/
task /*#E*/ 
 
speed := fix( float( gShips(i)!Speed )/sqrt2 )
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ChangeCoordinate.spd(1),377(80,90))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ChangeCoordinate.spd(1),146(80,55))*/
enddecision;
grst2180_2:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ChangeCoordinate.spd(1),164(80,120))*/
decision /*#E*/ 
 
j <= speed
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ChangeCoordinate.spd(1),191(92,130))*/
(false):
grst2180_3:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ChangeCoordinate.spd(1),677(150,40))*/
task /*#E*/ 
i := i + 1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ChangeCoordinate.spd(1),146(80,55))*/
join /*#E*/ 
grst2180_1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ChangeCoordinate.spd(1),293(57,127))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ChangeCoordinate.spd(1),287(50,140))*/
call /*#E*/ 
 
ReadHeading( gShips(i) )
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ChangeCoordinate.spd(1),632(50,155))*/
decision /*#E*/ 
 
gShips(i)!Resource = 0
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ChangeCoordinate.spd(1),638(32,162))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ChangeCoordinate.spd(1),626(25,170))*/
task /*#E*/ 
j := j + 1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ChangeCoordinate.spd(1),164(80,120))*/
join /*#E*/ 
grst2180_2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ChangeCoordinate.spd(1),851(62,165))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ChangeCoordinate.spd(1),839(50,170))*/
output /*#E*/ 
 
DestroyShip( gShips(i)!ShipId,
  gShips(i)!StrategyId, gShips(i)!TypeShip )
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ChangeCoordinate.spd(1),833(50,185))*/
task {/*#E*/ 
 
St := substring( gShips, i+1, len-i );
gShips := substring( gShips, 1, i-1 );
gShips := gShips // St;
len := len - 1;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ChangeCoordinate.spd(1),677(150,40))*/
join /*#E*/ 
grst2180_3;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ChangeCoordinate.spd(1),632(50,155))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ChangeCoordinate.spd(1),164(80,120))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ChangeCoordinate.spd,4)*/
endprocedure ChangeCoordinate;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ReadHeading.spd,4)*/
procedure ReadHeading
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ReadHeading.spd,1)*/
;fpar
  in/out ship tShipParameters;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ReadHeading.spd(1),236(5,25))*/
dcl
  CoorXY tCoordinates,
  Deep, PointDeep, PointDeep2 Integer,
  Res Integer;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ReadHeading.spd(1),347(5,45))*/
procedure /*#E*/ 
StepCoor referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ReadHeading.spd(1),119(80,15))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ReadHeading.spd(1),479(80,30))*/
call /*#E*/ 
StepCoor;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ReadHeading.spd(1),239(80,45))*/
task {/*#E*/ 
 
Deep := d2i( gShipsCharacter( ship!TypeShip )!MaxDeep );
PointDeep := call getDeepXY( CoorXY!x, CoorXY!y );
PointDeep2 := call getDeepXY(
  ship!Coordinates!x, ship!Coordinates!y );
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ReadHeading.spd(1),251(80,65))*/
decision /*#E*/ 
 
( Deep <= PointDeep ) AND ( PointDeep2 /= d2i( LAND ) )
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ReadHeading.spd(1),395(42,65))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ReadHeading.spd(1),377(5,75))*/
task {/*#E*/ 
 
ship!Coordinates!y := CoorXY!y; 
ship!Coordinates!x := CoorXY!x;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ReadHeading.spd(1),383(10,90))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ReadHeading.spd(1),467(92,77))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ReadHeading.spd(1),263(80,100))*/
decision /*#E*/ 
 
( Deep > PointDeep2 ) OR ( PointDeep2 = d2i( LAND ) )
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ReadHeading.spd(1),278(42,100))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ReadHeading.spd(1),275(5,115))*/
task {/*#E*/ 
 
ship!Speed := 0;
speed := 0;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ReadHeading.spd(1),401(92,110))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ReadHeading.spd(1),398(80,115))*/
task /*#E*/ 
 
Res := ship!Resource -
  gShipsCharacter( ship!TypeShip )!MaxResource/
  gShipsCharacter( ship!TypeShip )!MaxSpeed*
  ship!Speed/2
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ReadHeading.spd(1),494(80,135))*/
decision /*#E*/ 
 
Res < 0
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ReadHeading.spd(1),512(32,142))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ReadHeading.spd(1),509(25,150))*/
task /*#E*/ 
 
ship!Resource := 0
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ReadHeading.spd(1),506(92,145))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ReadHeading.spd(1),518(80,150))*/
task /*#E*/ 
 
ship!Resource := Res
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ReadHeading.spd(1),494(80,135))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ReadHeading.spd(1),413(80,165))*/
task {/*#E*/ 
 
ship!Speed := 0;
speed := 0;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ReadHeading.spd(1),431(80,180))*/
task {/*#E*/ 
 
ship!Coordinates!y := CoorXY!y; 
ship!Coordinates!x := CoorXY!x;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ReadHeading.spd(1),263(80,100))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ReadHeading.spd(1),443(85,195))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ReadHeading.spd(1),251(80,65))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\ReadHeading.spd,4)*/
endprocedure ReadHeading;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd,4)*/
procedure StepCoor;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(1),746(80,10))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(1),749(80,30))*/
task /*#E*/ 
 
CoorXY := ship!Coordinates
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(1),701(80,45))*/
decision /*#E*/ 
 
ship!Heading
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(1),722(47,60))*/
(NORTH):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(1),770(10,70))*/
decision /*#E*/ 
 
CoorXY!y = MaxYCoordinate
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(1),785(22,82))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(1),782(10,90))*/
task /*#E*/ 
 
CoorXY!y := CoorXY!y + 1
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(1),803(5,70))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(1),770(10,70))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(1),797(15,105))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(1),815(102,60))*/
(SOUTH):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(1),839(115,70))*/
decision /*#E*/ 
 
CoorXY!y = 0
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(1),845(127,82))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(1),833(115,90))*/
task /*#E*/ 
 
CoorXY!y := CoorXY!y - 1
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(1),848(110,70))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(1),839(115,70))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(1),827(120,105))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(1),869(45,117))*/
(WEST):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(1),890(10,125))*/
decision /*#E*/ 
 
CoorXY!x = 0
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(1),896(22,137))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(1),884(10,145))*/
task /*#E*/ 
 
CoorXY!x := CoorXY!x - 1
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(1),911(5,125))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(1),890(10,125))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(1),905(15,160))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(1),917(102,117))*/
(EAST):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(1),1475(115,125))*/
decision /*#E*/ 
 
CoorXY!x = MaxXCoordinate
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(1),1487(127,137))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(1),1469(115,145))*/
task /*#E*/ 
 
CoorXY!x := CoorXY!x + 1
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(1),1478(110,125))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(1),1475(115,125))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(1),1463(120,160))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(1),935(32,177))*/
( SOUTH_WEST    ):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(1),932(15,185))*/
join /*#E*/ 
L2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(1),923(100,177))*/
( NORTH_EAST):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(1),920(120,185))*/
join /*#E*/ 
L1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(1),929(52,202))*/
( SOUTH_EAST):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(1),926(15,210))*/
join /*#E*/ 
L4;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(1),941(100,202))*/
( NORTH_WEST):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(1),938(120,210))*/
join /*#E*/ 
L3;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(1),701(80,45))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(2),959(15,30))*/
connection /*#E*/ 
L1:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(2),1049(10,45))*/
decision /*#E*/ 
 
( CoorXY!x = MaxXCoordinate ) OR
  ( CoorXY!y = MaxYCoordinate )
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(2),1061(22,57))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(2),1043(10,65))*/
task {/*#E*/ 
 
CoorXY!x := CoorXY!x + 1;
CoorXY!y := CoorXY!y + 1;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(2),1079(5,45))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(2),1049(10,45))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(2),962(15,80))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(2),959(15,30))*/
endconnection L1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(2),1514(110,30))*/
connection /*#E*/ 
L2:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(2),1511(105,45))*/
decision /*#E*/ 
 
( CoorXY!x = 0 ) OR
  ( CoorXY!y = 0 )
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(2),1523(117,57))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(2),1505(105,65))*/
task {/*#E*/ 
 
CoorXY!x := CoorXY!x - 1;
CoorXY!y := CoorXY!y - 1;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(2),1538(100,45))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(2),1511(105,45))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(2),1493(110,80))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(2),1514(110,30))*/
endconnection L2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(2),1562(15,105))*/
connection /*#E*/ 
L3:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(2),1559(10,120))*/
decision /*#E*/ 
 
( CoorXY!x = 0 ) OR
  ( CoorXY!y = MaxYCoordinate )
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(2),1571(22,132))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(2),1553(10,140))*/
task {/*#E*/ 
 
CoorXY!x := CoorXY!x - 1;
CoorXY!y := CoorXY!y + 1;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(2),1574(10,120))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(2),1559(10,120))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(2),1541(15,155))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(2),1562(15,105))*/
endconnection L3;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(2),968(110,105))*/
connection /*#E*/ 
L4:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(2),1109(105,120))*/
decision /*#E*/ 
 
( CoorXY!x = MaxXCoordinate ) OR
  ( CoorXY!y = 0 )
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(2),1139(117,132))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(2),1103(105,140))*/
task {/*#E*/ 
 
CoorXY!x := CoorXY!x + 1;
CoorXY!y := CoorXY!y - 1;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(2),1142(105,120))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(2),1109(105,120))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(2),1097(110,155))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd(2),968(110,105))*/
endconnection L4;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\StepCoor.spd,4)*/
endprocedure StepCoor;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd,4)*/
procedure UpdateShots;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(1),125(5,25))*/
dcl
  St  tStringShotParameters,
  St1 tStringShipParameters,
  distance Integer,
  i, j, Res Integer,
  lenshot, lenship Integer;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(1),275(30,10))*/
procedure /*#E*/ 
SpeedCoor referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(1),116(90,20))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(1),128(90,35))*/
task {/*#E*/ 
 
i := 1;
Res := 0;
lenshot := length( gShots );
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(1),434(165,35))*/
L2:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(1),161(90,55))*/
decision /*#E*/ 
 
i <= lenshot
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(1),1022(85,55))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(1),257(40,65))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(1),1202(102,67))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(1),1199(90,75))*/
decision /*#E*/ 
 
gShots(i)!CurrentCoordinates =
  gShots( i )!FinishCoordinates
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(1),1217(17,82))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(1),1244(10,90))*/
task {/*#E*/ 
 
St := substring( gShots, 1, i-1 );
gShots := St //
  substring( gShots, i+1, lenshot-i);
lenshot := length( gShots );
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(1),161(90,55))*/
join /*#E*/ 
L2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(1),1211(102,85))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(1),242(90,90))*/
task /*#E*/ 
 
distance := call getDistance(
  gShots(i)!CurrentCoordinates!x,
  gShots(i)!CurrentCoordinates!y,
  gShots(i)!FinishCoordinates!x,
  gShots(i)!FinishCoordinates!y )
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(1),209(90,115))*/
decision /*#E*/ 
 
gWeaponryCharacter( gShots(i)!TypeWeaponry )!
  Speed >= distance
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(1),302(85,115))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(1),299(35,130))*/
call /*#E*/ 
SpeedCoor(i);
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(1),314(35,145))*/
task /*#E*/ 
i := i + 1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(1),161(90,55))*/
join /*#E*/ 
L2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(1),338(102,125))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(1),335(90,130))*/
task /*#E*/ 
 
lenship := length( gShips )
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(1),1085(90,145))*/
task /*#E*/ 
j := 1;
grst7916_1:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(1),1082(90,160))*/
decision /*#E*/ 
 
j <= lenship
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(1),1097(102,172))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(1),1073(90,180))*/
decision /*#E*/ 
 
gShips( j )!Coordinates =
  gShots( i )!FinishCoordinates
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(1),1118(67,187))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(1),1115(65,200))*/
join /*#E*/ 
L1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(1),1103(102,192))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(1),1067(90,200))*/
task /*#E*/ 
j := j + 1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(1),1073(90,180))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(1),1094(42,167))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(1),1076(40,200))*/
join /*#E*/ 
L3;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(1),1082(90,160))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(1),1082(90,160))*/
join /*#E*/ 
grst7916_1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(1),209(90,115))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(1),1199(90,75))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(1),161(90,55))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(2),392(105,10))*/
connection /*#E*/ 
L1:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(2),806(100,25))*/
decision /*#E*/ 
 
gShots( i )!TypeWeaponry = REPAIR
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(2),827(62,25))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(2),824(15,40))*/
task /*#E*/ 
 
Res := gShips( j )!Resource +
  gWeaponryCharacter( gShots(i)!
  TypeWeaponry )!Power
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(2),839(15,60))*/
decision /*#E*/ 
 
Res > gShipsCharacter(
  gShips( j )!TypeShip )!
  MaxResource
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(2),860(27,72))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(2),857(15,80))*/
task /*#E*/ 
 
Res := gShipsCharacter(
  gShips( j )!
  TypeShip )!MaxResource
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(2),1271(10,60))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(2),839(15,60))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(2),821(115,35))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(2),524(100,40))*/
task /*#E*/ 
 
Res := gShips(j)! Resource -
  gWeaponryCharacter( gShots(i)!
  TypeWeaponry )!Power

;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(2),737(100,60))*/
decision /*#E*/ 
 
Res < 0
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(2),752(112,72))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(2),749(100,80))*/
task /*#E*/ 
Res := 0;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(2),764(92,60))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(2),737(100,60))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(2),806(100,25))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(2),1154(100,100))*/
decision /*#E*/ 
 
Res = 0
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(2),1187(37,107))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(2),1259(30,120))*/
task /*#E*/ 
 
gShips( j )!Resource := Res
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(2),1160(112,112))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(2),1148(100,120))*/
output /*#E*/ 
 
DestroyShip( gShips( j )!ShipId,
  gShips( j )!StrategyId, gShips( j )!TypeShip )
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(2),1142(100,135))*/
task {/*#E*/ 
 
St1 := substring( gShips, 1, j-1 );
gShips := St1 //
  substring( gShips, j+1, lenship-j );
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(2),1154(100,100))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(2),1232(10,120))*/
L3:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(2),1226(100,150))*/
task {/*#E*/ 
 
gShots(i)!CurrentCoordinates :=
  gShots( i )!FinishCoordinates;
i := i + 1;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(2),1124(105,170))*/
join /*#E*/ 
L2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd(2),392(105,10))*/
endconnection L1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\UpdateShots.spd,4)*/
endprocedure UpdateShots;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SpeedCoor.spd,4)*/
procedure SpeedCoor
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SpeedCoor.spd,1)*/
;fpar
  shotNo Integer; 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SpeedCoor.spd(1),179(5,25))*/
dcl
  Dis Integer,
  sqr Integer,
  cX,fX,cY,fY Integer;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SpeedCoor.spd(1),116(45,25))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SpeedCoor.spd(1),188(45,40))*/
task {/*#E*/ 
 
cX := gShots( shotNo )!CurrentCoordinates!x;
fX := gShots( shotNo )!FinishCoordinates!x;
cY := gShots( shotNo )!CurrentCoordinates!y;
fY := gShots( shotNo )!FinishCoordinates!y;

Dis := gWeaponryCharacter( gShots( shotNo )!TypeWeaponry )!Speed;
sqr := call sdl_sqrt( ( fX-cX )*( fX-cX ) + ( fY-cY )*( fY-cY ) );
cX := cX + fix( float(Dis*( fX-cX ))/float( sqr ) );
cY := cY + fix( float(Dis*( fY-cY ))/float( sqr ) );

gShots( shotNo )!CurrentCoordinates!x := cX;
gShots( shotNo )!CurrentCoordinates!y := cY;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SpeedCoor.spd(1),353(50,90))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SpeedCoor.spd,4)*/
endprocedure SpeedCoor;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd,4)*/
procedure CollisionShip;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(1),131(145,10))*/
dcl
St tStringShipParameters,
lengship Integer,
b Boolean,
i Integer,
j Integer;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(1),245(5,35))*/
procedure /*#E*/ 
Collision referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(1),461(5,50))*/
procedure /*#E*/ 
Heading referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(1),116(70,15))*/
start /*#E*/ 
;
grst307_1:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(1),134(70,45))*/
task {/*#E*/ 
 
i:=1;
j:=1;
b:=true;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(1),428(70,60))*/
task /*#E*/ 
 
lengship:=length(gShips)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(1),872(50,50))*/
L4:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(1),149(70,75))*/
decision /*#E*/ 
 
i<=lengship-1
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(1),653(95,75))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(1),800(120,85))*/
decision /*#E*/ 
 
b=true
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(1),857(152,75))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(1),812(132,97))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(1),656(125,100))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(1),800(120,85))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(1),134(70,45))*/
join /*#E*/ 
grst307_1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(1),164(82,87))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(1),161(70,100))*/
task {/*#E*/ 
 
j:=i+1;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(1),551(45,105))*/
L3:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(1),179(70,115))*/
decision /*#E*/ 
 
j<=lengship
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(1),194(42,120))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(1),191(20,135))*/
task /*#E*/ 
 
i:=i+1
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(1),149(70,75))*/
join /*#E*/ 
L4;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(1),215(137,130))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(1),212(125,135))*/
decision /*#E*/ 
 
gShips(i)!Coordinates=
gShips(j)!Coordinates
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(1),227(147,150))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(1),224(135,160))*/
task /*#E*/ 
 
j:=j+1
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(1),266(52,150))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(1),785(45,175))*/
task /*#E*/ 
 
b:=false
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(1),263(45,190))*/
call /*#E*/ 
 
Collision(i,j)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(1),272(50,210))*/
join /*#E*/ 
L1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(1),212(125,135))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(1),179(70,115))*/
join /*#E*/ 
L3;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(1),179(70,115))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(1),149(70,75))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(2),290(20,25))*/
connection /*#E*/ 
L1:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(2),293(15,40))*/
decision /*#E*/ 
 
gShips(i)!Resource=0
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(2),353(40,55))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(2),329(95,40))*/
output /*#E*/ 
 
 DestroyShip(gShips(i)!ShipId,
gShips(i)!StrategyId,gShips(i)!TypeShip)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(2),323(95,55))*/
task /*#E*/ 
 
St:=substring(gShips,1,i-1)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(2),317(95,70))*/
task /*#E*/ 
 
gShips:=St//substring(gShips,i+1,
lengship-i)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(2),311(95,85))*/
task /*#E*/ 
 
lengship:=lengship-1
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(2),878(100,100))*/
join /*#E*/ 
L4;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(2),839(27,52))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(2),833(15,65))*/
call /*#E*/ 
 
Heading(i)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(2),392(15,130))*/
decision /*#E*/ 
 
gShips(j)!Resource=0
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(2),422(40,145))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(2),389(95,140))*/
output /*#E*/ 
 
 DestroyShip(gShips(j)!ShipId,
gShips(j)!StrategyId,gShips(j)!TypeShip)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(2),383(95,155))*/
task /*#E*/ 
 
St:=substring(gShips,1,j-1)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(2),377(95,170))*/
task /*#E*/ 
 
gShips:=St//substring(gShips,j+1,
lengship-j)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(2),371(95,185))*/
task /*#E*/ 
 
lengship:=lengship-1
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(2),713(95,200))*/
task /*#E*/ 
 
j:=j-1
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(2),851(27,142))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(2),845(15,160))*/
call /*#E*/ 
 
Heading(j)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(2),392(15,130))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(2),464(20,215))*/
join /*#E*/ 
L2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(2),293(15,40))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(2),290(20,25))*/
endconnection L1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(3),485(65,20))*/
connection /*#E*/ 
L2:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(3),530(60,70))*/
task {/*#E*/ 
 
j:=j+1;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(3),542(65,85))*/
join /*#E*/ 
L3;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd(3),485(65,20))*/
endconnection L2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\CollisionShip.spd,4)*/
endprocedure CollisionShip;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd,4)*/
procedure Collision
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd,1)*/
;fpar
i Integer,
j Integer;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(1),149(155,45))*/
dcl 
h1 Integer,
h2 Integer,
Res Integer;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(1),1142(5,110))*/
synonym
diff0 Integer =0,
diff1 Integer =1,
diff2 Integer =2,
diff3 Integer =3,
diff4 Integer =4,
diff5 Integer =5,
diff6 Integer =6,
diff7 Integer =7;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(1),281(5,40))*/
procedure /*#E*/ 
abs referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(1),116(70,20))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(1),152(70,35))*/
task /*#E*/ 
 
 h1:=h2i(gShips(i)!Heading)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(1),161(70,50))*/
task /*#E*/ 
 
 h2:=h2i(gShips(j)!Heading)

;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(1),173(70,65))*/
decision /*#E*/ 
 
call abs(h1-h2)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(1),188(17,72))*/
(=diff0):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(1),941(10,85))*/
join /*#E*/ 
L5;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(1),215(105,77))*/
(=diff1,=diff7):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(1),212(100,85))*/
task /*#E*/ 
 
Res:=gShips(i)! Resource-(call
abs(fix(float(gShips(i)!Speed-gShips(j)!Speed)*(sqrt2/
2))))*ns2i(gShips(j)!TypeShip )
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(1),458(100,100))*/
decision /*#E*/ 
 
Res<0
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(1),485(137,115))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(1),455(125,120))*/
task /*#E*/ 
 
gShips(i)!Resource:=0
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(1),476(112,112))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(1),467(100,135))*/
task /*#E*/ 
 
gShips(i)!Resource:=Res
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(1),458(100,100))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(1),236(105,155))*/
task /*#E*/ 
 
Res:=gShips(j)! Resource-(call
abs(fix(float(gShips(i)!Speed-gShips(j)!Speed)*(sqrt2/
2))))*ns2i(gShips(i)!TypeShip )
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(1),494(110,180))*/
join /*#E*/ 
L1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(1),854(70,90))*/
(=diff3,=diff5):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(1),851(75,100))*/
join /*#E*/ 
L4;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(1),554(62,155))*/
(=diff2,=diff6):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(1),551(50,160))*/
join /*#E*/ 
L3;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(1),221(90,112))*/
(=diff4):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(1),419(85,165))*/
join /*#E*/ 
L2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(1),173(70,65))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(2),422(100,5))*/
connection /*#E*/ 
L2:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(2),437(95,20))*/
task /*#E*/ 
 
Res:=gShips(i)! Resource-
(gShips(i)!Speed+gShips(j)!Speed)*
ns2i(gShips(j)!TypeShip )
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(2),503(95,40))*/
decision /*#E*/ 
 
Res<0
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(2),530(132,55))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(2),500(120,60))*/
task /*#E*/ 
 
gShips(i)!Resource:=0
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(2),521(107,52))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(2),512(95,75))*/
task /*#E*/ 
 
gShips(i)!Resource:=Res
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(2),503(95,40))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(2),431(95,95))*/
task /*#E*/ 
 
Res:=gShips(j)! Resource-
(gShips(i)!Speed+gShips(j)!Speed)*
ns2i(gShips(i)!TypeShip )
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(2),536(100,110))*/
join /*#E*/ 
L1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(2),422(100,5))*/
endconnection L2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(2),362(10,30))*/
connection /*#E*/ 
L1:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(2),374(5,45))*/
decision /*#E*/ 
 
Res<0
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(2),401(42,60))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(2),371(30,65))*/
task /*#E*/ 
 
gShips(j)!Resource:=0
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(2),392(17,57))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(2),383(5,80))*/
task /*#E*/ 
 
gShips(j)!Resource:=Res
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(2),374(5,45))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(2),407(10,105))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(2),362(10,30))*/
endconnection L1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(2),812(40,110))*/
connection /*#E*/ 
L3:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(2),809(35,125))*/
task /*#E*/ 
 
Res:=gShips(i)! Resource-
(gShips(i)!Speed+gShips(j)!Speed)*
ns2i(gShips(j)!TypeShip )
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(2),803(35,145))*/
decision /*#E*/ 
 
Res<0
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(2),827(72,160))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(2),797(60,165))*/
task /*#E*/ 
 
gShips(i)!Resource:=0
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(2),842(47,157))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(2),782(35,180))*/
task /*#E*/ 
 
gShips(i)!Resource:=Res
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(2),803(35,145))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(2),791(35,200))*/
task /*#E*/ 
 
Res:=gShips(j)! Resource-
(gShips(i)!Speed+gShips(j)!Speed)*
ns2i(gShips(i)!TypeShip )
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(2),785(40,215))*/
join /*#E*/ 
L1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(2),812(40,110))*/
endconnection L3;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(3),869(65,10))*/
connection /*#E*/ 
L4:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(3),899(60,30))*/
task /*#E*/ 
 
Res:=gShips(i)! Resource-(call
abs(fix(float(gShips(i)!Speed+gShips(j)!Speed)*(sqrt2/
0.5))))*ns2i(gShips(j)!TypeShip )
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(3),893(60,45))*/
decision /*#E*/ 
 
Res<0
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(3),911(97,60))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(3),887(85,65))*/
task /*#E*/ 
 
gShips(i)!Resource:=0
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(3),923(72,57))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(3),875(60,80))*/
task /*#E*/ 
 
gShips(i)!Resource:=Res
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(3),893(60,45))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(3),881(65,100))*/
task /*#E*/ 
 
Res:=gShips(j)! Resource-(call
abs(fix(float(gShips(i)!Speed+gShips(j)!Speed)*(sqrt2/
0.5))))*ns2i(gShips(i)!TypeShip )
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(3),935(70,115))*/
join /*#E*/ 
L1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(3),869(65,10))*/
endconnection L4;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(4),1028(60,10))*/
connection /*#E*/ 
L5:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(4),992(55,25))*/
task /*#E*/ 
 
Res:=gShips(i)!Resource-
(call abs(gShips(i)!Speed-gShips(j)!Speed))*
ns2i(gShips(j)!TypeShip )
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(4),986(55,40))*/
decision /*#E*/ 
 
Res<0
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(4),1004(92,55))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(4),980(80,60))*/
task /*#E*/ 
 
gShips(i)!Resource:=0
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(4),1019(67,52))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(4),965(55,75))*/
task /*#E*/ 
 
gShips(i)!Resource:=Res
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(4),986(55,40))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(4),974(55,90))*/
task /*#E*/ 
 
Res:=gShips(j)! Resource-
(call abs(gShips(i)!Speed-gShips(j)!Speed))*
ns2i(gShips(i)!TypeShip )
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(4),1085(55,105))*/
decision /*#E*/ 
 
Res<0
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(4),1097(92,120))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(4),1079(80,125))*/
task /*#E*/ 
 
gShips(j)!Resource:=0
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(4),1106(67,117))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(4),1070(55,135))*/
task /*#E*/ 
 
gShips(j)!Resource:=Res
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(4),1085(55,105))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(4),1034(55,155))*/
decision /*#E*/ 
 
gShips(i)!Speed>= gShips(i)!Speed
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(4),1052(22,170))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(4),1049(15,180))*/
call /*#E*/ 
 
Heading(i)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(4),1058(112,170))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(4),1055(100,180))*/
call /*#E*/ 
 
Heading(j)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(4),1034(55,155))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(4),1124(75,210))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd(4),1028(60,10))*/
endconnection L5;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Collision.spd,4)*/
endprocedure Collision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\abs.spd,4)*/
procedure abs
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\abs.spd,1)*/
;fpar 
i Integer;
returns Integer;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\abs.spd(1),116(65,30))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\abs.spd(1),119(65,45))*/
decision /*#E*/ 
 
i>=0
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\abs.spd(1),134(52,50))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\abs.spd(1),131(40,60))*/
return /*#E*/ 
i;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\abs.spd(1),140(125,52))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\abs.spd(1),137(130,60))*/
return /*#E*/ 
-i;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\abs.spd(1),119(65,45))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\abs.spd,4)*/
endprocedure abs;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd,4)*/
procedure Heading
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd,1)*/
;fpar
i Integer;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(1),116(55,5))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(1),2390(75,20))*/
decision /*#E*/ 
 
gShips(i)!Heading
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(1),2396(55,25))*/
(NORTH):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(1),2384(15,50))*/
decision /*#E*/ 
 
gShips(i)!Coordinates!y=0
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(1),2423(27,62))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(1),2372(15,65))*/
task /*#E*/ 
 
gShips(i)!Coordinates!y:=
gShips(i)!Coordinates!y-
1
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(1),2426(10,67))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(1),2384(15,50))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(1),2354(20,85))*/
join /*#E*/ 
L2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(1),2399(117,35))*/
(NORTH_EAST):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(1),2378(105,50))*/
decision /*#E*/ 
 
gShips(i)!Coordinates!y=0
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(1),2432(117,62))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(1),2366(105,65))*/
task /*#E*/ 
 
gShips(i)!Coordinates!y:=
gShips(i)!Coordinates!y-1
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(1),2435(97,65))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(1),2378(105,50))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(1),2360(105,80))*/
decision /*#E*/ 
 
gShips(i)!Coordinates!x=0
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(1),2453(117,92))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(1),2351(105,95))*/
task /*#E*/ 
 
gShips(i)!Coordinates!x:=
gShips(i)!Coordinates!x-1
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(1),2456(97,95))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(1),2360(105,80))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(1),2333(110,115))*/
join /*#E*/ 
L2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(1),2402(57,92))*/
(EAST):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(1),2345(15,100))*/
decision /*#E*/ 
 
gShips(i)!Coordinates!y=0
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(1),2468(27,112))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(1),2339(15,115))*/
task /*#E*/ 
 
gShips(i)!Coordinates!x:=
gShips(i)!Coordinates!x-
1
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(1),2471(7,115))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(1),2345(15,100))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(1),2330(20,130))*/
join /*#E*/ 
L2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(1),2405(167,130))*/
(NORTH_WEST):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(1),2327(160,130))*/
join /*#E*/ 
L3;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(1),2408(37,145))*/
(SOUTH):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(1),2324(30,145))*/
decision /*#E*/ 
 
gShips(i)!Coordinates!y=
MaxYCoordinate
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(1),2483(42,157))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(1),2312(30,160))*/
task /*#E*/ 
 
gShips(i)!Coordinates!y:=
gShips(i)!Coordinates!y+
1
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(1),2486(25,160))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(1),2324(30,145))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(1),2270(35,215))*/
join /*#E*/ 
L2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(1),2411(122,137))*/
(SOUTH_EAST):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(1),2318(110,145))*/
decision /*#E*/ 
 
gShips(i)!Coordinates!y=
MaxYCoordinate
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(1),2492(122,157))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(1),2306(110,160))*/
task /*#E*/ 
 
gShips(i)!Coordinates!y:=
gShips(i)!Coordinates!y+1
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(1),2495(102,160))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(1),2318(110,145))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(1),2300(110,175))*/
decision /*#E*/ 
 
gShips(i)!Coordinates!x=0
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(1),2513(122,187))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(1),2288(110,190))*/
task /*#E*/ 
 
gShips(i)!Coordinates!x:=
gShips(i)!Coordinates!x-1
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(1),2516(102,190))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(1),2300(110,175))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(1),2276(115,210))*/
join /*#E*/ 
L2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(1),2414(12,175))*/
(    WEST):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(1),2294(5,185))*/
decision /*#E*/ 
 
gShips(i)!Coordinates!x=
MaxXCoordinate
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(1),2522(17,197))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(1),2282(5,200))*/
task /*#E*/ 
 
gShips(i)!Coordinates!x:=
gShips(i)!Coordinates!x+
1
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(1),2525(7,195))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(1),2294(5,185))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(1),2273(10,215))*/
join /*#E*/ 
L2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(1),2417(92,205))*/
(SOUTH_WEST):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(1),2267(85,215))*/
join /*#E*/ 
L4;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(1),2390(75,20))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(2),962(45,25))*/
connection /*#E*/ 
L3:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(2),992(40,40))*/
decision /*#E*/ 
 
gShips(i)!Coordinates!y=0
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(2),1004(55,50))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(2),977(40,55))*/
task /*#E*/ 
 
gShips(i)!Coordinates!y:=
gShips(i)!Coordinates!y-1
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(2),1016(25,55))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(2),992(40,40))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(2),1010(40,70))*/
decision /*#E*/ 
 
gShips(i)!Coordinates!x=MaxXCoordinate
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(2),1013(52,82))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(2),971(40,90))*/
task /*#E*/ 
 
gShips(i)!Coordinates!x:=
gShips(i)!Coordinates!x+1
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(2),1025(25,85))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(2),1010(40,70))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(2),965(45,110))*/
join /*#E*/ 
L2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(2),962(45,25))*/
endconnection L3;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(2),1067(120,115))*/
connection /*#E*/ 
L4:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(2),1097(115,130))*/
decision /*#E*/ 
 
gShips(i)!Coordinates!y=
MaxYCoordinate
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(2),1103(127,142))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(2),1082(115,145))*/
task /*#E*/ 
 
gShips(i)!Coordinates!y:=
gShips(i)!Coordinates!y+1
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(2),1130(105,145))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(2),1097(115,130))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(2),1124(115,160))*/
decision /*#E*/ 
 
gShips(i)!Coordinates!x=
MaxXCoordinate
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(2),1127(127,172))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(2),1076(115,185))*/
task /*#E*/ 
 
gShips(i)!Coordinates!x:=
gShips(i)!Coordinates!x+1
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(2),1142(105,175))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(2),1124(115,160))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(2),1070(120,210))*/
join /*#E*/ 
L2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(2),1067(120,115))*/
endconnection L4;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(2),2543(45,140))*/
connection /*#E*/ 
L2:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(2),2546(45,155))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd(2),2543(45,140))*/
endconnection L2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Heading.spd,4)*/
endprocedure Heading;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SetSI.spd,4)*/
procedure SetSI
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SetSI.spd,1)*/
;
returns tErrorCode;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SetSI.spd(1),119(40,10))*/
dcl i Integer;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SetSI.spd(1),116(70,25))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SetSI.spd(1),122(70,40))*/
task /*#E*/ 
i := 1;
grst5997_1:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SetSI.spd(1),128(70,55))*/
decision /*#E*/ 
 
i <= AmountStrategy
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SetSI.spd(1),158(17,62))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SetSI.spd(1),155(10,75))*/
task /*#E*/ 
 
errname := EN_OK
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SetSI.spd(1),167(15,90))*/
return /*#E*/ 
EC_OK;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SetSI.spd(1),143(82,67))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SetSI.spd(1),173(70,75))*/
decision /*#E*/ 
 
i /= StrategyNeverMovesID
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SetSI.spd(1),197(62,90))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SetSI.spd(1),194(55,100))*/
task {/*#E*/ 
gASI( i ) := false;};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SetSI.spd(1),176(97,90))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SetSI.spd(1),179(85,100))*/
task {/*#E*/ 
gASI( i ) := true;};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SetSI.spd(1),173(70,75))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SetSI.spd(1),140(70,120))*/
task {/*#E*/ 
i := i +1;};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SetSI.spd(1),128(70,55))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SetSI.spd(1),128(70,55))*/
join /*#E*/ 
grst5997_1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SetSI.spd,4)*/
endprocedure SetSI;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\KillStrategy.spd,4)*/
procedure KillStrategy
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\KillStrategy.spd,1)*/
;
returns tErrorCode;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\KillStrategy.spd(1),119(40,10))*/
dcl i Integer;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\KillStrategy.spd(1),116(90,30))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\KillStrategy.spd(1),122(90,45))*/
task /*#E*/ 
i := 1;
grst8724_1:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\KillStrategy.spd(1),128(90,60))*/
decision /*#E*/ 
 
i <= AmountStrategy
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\KillStrategy.spd(1),179(27,67))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\KillStrategy.spd(1),176(20,80))*/
task /*#E*/ 
 
errname := EN_OK
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\KillStrategy.spd(1),188(25,95))*/
return /*#E*/ 
EC_OK;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\KillStrategy.spd(1),143(102,72))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\KillStrategy.spd(1),140(90,80))*/
decision /*#E*/ 
gASI( i );
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\KillStrategy.spd(1),155(102,92))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\KillStrategy.spd(1),152(90,100))*/
output /*#E*/ 
StrategyLose 
( i )
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\KillStrategy.spd(1),170(82,80))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\KillStrategy.spd(1),140(90,80))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\KillStrategy.spd(1),164(90,115))*/
task {/*#E*/ 
 
gASI( i ) := false;
i := i + 1;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\KillStrategy.spd(1),128(90,60))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\KillStrategy.spd(1),128(90,60))*/
join /*#E*/ 
grst8724_1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\KillStrategy.spd,4)*/
endprocedure KillStrategy;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\IsWeaponry.spd,4)*/
procedure IsWeaponry
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\IsWeaponry.spd,1)*/
;
returns Boolean;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\IsWeaponry.spd(1),119(40,10))*/
dcl i, n Integer;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\IsWeaponry.spd(1),116(65,25))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\IsWeaponry.spd(1),134(65,40))*/
task {/*#E*/ 
 
i := 1;
n := length( gShips );
};
grst6007_1:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\IsWeaponry.spd(1),128(65,55))*/
decision /*#E*/ 
i <= n;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\IsWeaponry.spd(1),233(100,55))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\IsWeaponry.spd(1),236(105,70))*/
decision /*#E*/ 
 
gShots = empty
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\IsWeaponry.spd(1),239(102,70))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\IsWeaponry.spd(1),122(85,90))*/
return /*#E*/ 
false;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\IsWeaponry.spd(1),251(117,82))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\IsWeaponry.spd(1),248(110,90))*/
return /*#E*/ 
true;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\IsWeaponry.spd(1),236(105,70))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\IsWeaponry.spd(1),155(77,67))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\IsWeaponry.spd(1),152(65,105))*/
decision /*#E*/ 
 
( gShips(i)!Ammunition( MISSILE ) = 0 ) AND
  ( gShips(i)!Ammunition( TORPEDO ) = 0 ) AND
  ( gShips(i)!Ammunition( SHELL ) = 0 )
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\IsWeaponry.spd(1),179(57,105))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\IsWeaponry.spd(1),176(40,125))*/
task /*#E*/ 
i := i + 1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\IsWeaponry.spd(1),254(77,117))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\IsWeaponry.spd(1),200(70,125))*/
return /*#E*/ 
true;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\IsWeaponry.spd(1),152(65,105))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\IsWeaponry.spd(1),128(65,55))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\IsWeaponry.spd(1),128(65,55))*/
join /*#E*/ 
grst6007_1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\IsWeaponry.spd,4)*/
endprocedure IsWeaponry;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr,4)*/
process Router;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(1),164(115,10))*/
dcl
  rTime Integer,
  rShipId tShipId,
  rStrategyId tStrategyId,
  rNameShip tNameShip,
  rStringEnemyShip tStringEnemyShip,
  rStringShipCurrentState tStringShipCurrentState,
  rFactorAcceleration tFactorAcceleration,
  rHeadingChange tHeadingChange,
  rNameWeaponry tNameWeaponry,
  rStringShotsList tStringShotsList;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(1),998(115,50))*/
imported gASI tArraySI;
dcl
  rASI tArraySI;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(1),920(5,25))*/
procedure /*#E*/ 
SendOrderSpeedResponse referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(1),917(5,40))*/
procedure /*#E*/ 
SendOrderSpeedReject referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(1),911(5,55))*/
procedure /*#E*/ 
SendOrderTurnResponse referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(1),908(5,70))*/
procedure /*#E*/ 
SendOrderTurnReject referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(1),902(5,85))*/
procedure /*#E*/ 
SendOrderFireResponse referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(1),899(5,100))*/
procedure /*#E*/ 
SendOrderFireReject referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(1),1646(5,115))*/
procedure /*#E*/ 
SendDestroyShip referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(1),203(5,130))*/
procedure /*#E*/ 
SendVisibleShip referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(1),923(70,130))*/
procedure /*#E*/ 
SendOrderSpeedRequest referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(1),317(5,145))*/
procedure /*#E*/ 
SendShipsCurrentState referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(1),914(70,145))*/
procedure /*#E*/ 
SendOrderTurnRequest referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(1),566(5,160))*/
procedure /*#E*/ 
SendStrategyVictory referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(1),905(70,160))*/
procedure /*#E*/ 
SendOrderFireRequest referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(1),563(5,175))*/
procedure /*#E*/ 
SendStrategyLose referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(1),965(70,175))*/
procedure /*#E*/ 
SendFinishSimulation referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(2),371(110,5))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(2),368(110,20))*/
nextstate /*#E*/ 
Wait;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(2),368(110,20))*/
state /*#E*/ 
Wait;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(2),362(5,35))*/
input /*#E*/ 
 
StartSimulation
(rTime)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(2),1328(5,50))*/
task /*#E*/ 
 
rASI := import(gASI)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(2),1340(5,65))*/
decision /*#E*/ 
rASI(1);
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(2),1349(42,72))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(2),350(30,80))*/
output /*#E*/ 
 
StartSimulation
(rTime) via chRtrSt1
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(2),1352(17,77))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(2),1340(5,65))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(2),1343(5,95))*/
decision /*#E*/ 
rASI(2);
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(2),1373(42,102))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(2),1367(30,110))*/
output /*#E*/ 
 
StartSimulation
(rTime) via chRtrSt2
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(2),1361(17,107))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(2),1343(5,95))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(2),1358(5,125))*/
nextstate /*#E*/ 
-;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(2),365(110,35))*/
input /*#E*/ 
 
InitDataComplete
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(2),1436(110,50))*/
task /*#E*/ 
 
rASI := import(gASI)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(2),1430(110,65))*/
decision /*#E*/ 
rASI(1);
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(2),1445(147,72))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(2),1427(135,80))*/
output /*#E*/ 
 
InitDataComplete
via chRtrSt1
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(2),1448(122,77))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(2),1430(110,65))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(2),1421(110,95))*/
decision /*#E*/ 
rASI(2);
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(2),1457(147,102))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(2),1418(135,110))*/
output /*#E*/ 
 
InitDataComplete
via chRtrSt2
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(2),1460(122,107))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(2),1421(110,95))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(2),1412(110,125))*/
nextstate /*#E*/ 
-;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(2),368(110,20))*/
endstate;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(3),1247(5,25))*/
state /*#E*/ 
Wait;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(3),1244(5,40))*/
input /*#E*/ 
 
VisibleShip(
rStrategyId,
rStringEnemyShip)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(3),1226(5,60))*/
call /*#E*/ 
 
SendVisibleShip
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(3),1208(5,75))*/
nextstate /*#E*/ 
-;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(3),1652(60,40))*/
input /*#E*/ 
 
DestroyShip(
rShipId,
rStrategyId,
rNameShip)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(3),1661(60,60))*/
call /*#E*/ 
 
SendDestroyShip
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(3),1673(60,75))*/
nextstate /*#E*/ 
-;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(3),1238(115,40))*/
input /*#E*/ 
 
ShipsCurrentState(
rStrategyId,
rStringShipCurrentState)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(3),1220(115,60))*/
call /*#E*/ 
 
SendShipsCurrentState
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(3),1205(115,75))*/
nextstate /*#E*/ 
-;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(3),1247(5,25))*/
endstate;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(3),1199(5,90))*/
state /*#E*/ 
Wait;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(3),1196(5,105))*/
input /*#E*/ 
 
StrategyVictory
(rStrategyId)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(3),1184(5,120))*/
call /*#E*/ 
 
SendStrategyVictory
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(3),1172(5,135))*/
nextstate /*#E*/ 
-;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(3),1190(65,105))*/
input /*#E*/ 
 
StrategyLose
(rStrategyId)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(3),1178(65,120))*/
call /*#E*/ 
 
SendStrategyLose
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(3),1169(65,135))*/
nextstate /*#E*/ 
-;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(3),1232(125,105))*/
input /*#E*/ 
 
FinishSimulation(
rTime,
rStrategyId)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(3),1214(125,120))*/
call /*#E*/ 
 
SendFinishSimulation
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(3),1202(125,135))*/
nextstate /*#E*/ 
-;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(3),1199(5,90))*/
endstate;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(4),572(5,25))*/
state /*#E*/ 
Wait;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(4),575(5,40))*/
input /*#E*/ 
 
OrderSpeedRequest(
rShipId, rStrategyId,
rFactorAcceleration)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(4),581(5,55))*/
call /*#E*/ 
 
SendOrder_
SpeedRequest
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(4),587(5,70))*/
nextstate /*#E*/ 
-;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(4),617(65,40))*/
input /*#E*/ 
 
OrderSpeedResponse(
rShipId,
rStrategyId)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(4),611(65,55))*/
call /*#E*/ 
 
SendOrder_
SpeedResponse
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(4),605(65,70))*/
nextstate /*#E*/ 
-;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(4),644(130,40))*/
input /*#E*/ 
 
OrderSpeedReject(
rShipId,
rStrategyId)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(4),638(130,55))*/
call /*#E*/ 
 
SendOrder_
SpeedReject
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(4),632(130,70))*/
nextstate /*#E*/ 
-;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(4),572(5,25))*/
endstate;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(4),710(5,85))*/
state /*#E*/ 
Wait;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(4),707(5,100))*/
input /*#E*/ 
 
OrderTurnRequest(
rShipId, rStrategyId,
rHeadingChange)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(4),701(5,115))*/
call /*#E*/ 
 
SendOrder_
TurnRequest
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(4),695(5,130))*/
nextstate /*#E*/ 
-;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(4),692(65,100))*/
input /*#E*/ 
 
OrderTurnResponse(
rShipId,
rStrategyId)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(4),686(65,115))*/
call /*#E*/ 
 
SendOrder_
TurnResponse
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(4),680(65,130))*/
nextstate /*#E*/ 
-;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(4),677(125,100))*/
input /*#E*/ 
 
OrderTurnReject(
rShipId,
rStrategyId)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(4),671(125,115))*/
call /*#E*/ 
 
SendOrder_
TurnReject
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(4),665(125,130))*/
nextstate /*#E*/ 
-;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(4),710(5,85))*/
endstate;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(4),818(5,145))*/
state /*#E*/ 
Wait;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(4),815(5,160))*/
input /*#E*/ 
 
OrderFireRequest(
rShipId, rStrategyId,
rNameWeaponry,
rStringShotsList)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(4),800(5,180))*/
call /*#E*/ 
 
SendOrder_
FireRequest
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(4),785(5,195))*/
nextstate /*#E*/ 
-;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(4),809(65,160))*/
input /*#E*/ 
 
OrderFireResponse(
rShipId,
rStrategyId)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(4),794(65,180))*/
call /*#E*/ 
 
SendOrder_
FireResponse
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(4),782(65,195))*/
nextstate /*#E*/ 
-;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(4),803(125,160))*/
input /*#E*/ 
 
OrderFireReject(
rShipId,
rStrategyId)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(4),788(125,180))*/
call /*#E*/ 
 
SendOrder_
FireReject
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(4),779(125,195))*/
nextstate /*#E*/ 
-;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr(4),818(5,145))*/
endstate;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\Router.spr,4)*/
endprocess Router;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderSpeedRequest.spd,4)*/
procedure SendOrderSpeedRequest;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderSpeedRequest.spd(1),140(80,10))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderSpeedRequest.spd(1),179(80,25))*/
task /*#E*/ 
 
rASI := import(gASI)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderSpeedRequest.spd(1),173(80,40))*/
decision /*#E*/ 
rASI(rStrategyId);
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderSpeedRequest.spd(1),191(117,47))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderSpeedRequest.spd(1),131(105,55))*/
output /*#E*/ 
 
OrderSpeedRequest(
rShipId, rStrategyId,
rFactorAcceleration)
via chMnRtr
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderSpeedRequest.spd(1),194(92,52))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderSpeedRequest.spd(1),173(80,40))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderSpeedRequest.spd(1),125(85,70))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderSpeedRequest.spd,4)*/
endprocedure SendOrderSpeedRequest;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderSpeedResponse.spd,4)*/
procedure SendOrderSpeedResponse;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderSpeedResponse.spd(1),140(80,10))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderSpeedResponse.spd(1),173(80,25))*/
task /*#E*/ 
 
rASI := import(gASI)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderSpeedResponse.spd(1),137(80,40))*/
decision /*#E*/ 
 
if (rASI(rStrategyId) = true) 
then rStrategyId
else 3 fi
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderSpeedResponse.spd(1),149(117,55))*/
(=1):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderSpeedResponse.spd(1),131(105,60))*/
output /*#E*/ 
 
OrderSpeedResponse(
rShipId,
rStrategyId)
via chRtrSt1
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderSpeedResponse.spd(1),125(110,75))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderSpeedResponse.spd(1),152(117,85))*/
(=2):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderSpeedResponse.spd(1),122(105,90))*/
output /*#E*/ 
 
OrderSpeedResponse(
rShipId,
rStrategyId)
via chRtrSt2
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderSpeedResponse.spd(1),116(110,105))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderSpeedResponse.spd(1),146(57,45))*/
else:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderSpeedResponse.spd(1),134(60,50))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderSpeedResponse.spd(1),137(80,40))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderSpeedResponse.spd,4)*/
endprocedure SendOrderSpeedResponse;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderSpeedReject.spd,4)*/
procedure SendOrderSpeedReject;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderSpeedReject.spd(1),140(80,10))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderSpeedReject.spd(1),173(80,25))*/
task /*#E*/ 
 
rASI := import(gASI)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderSpeedReject.spd(1),137(80,40))*/
decision /*#E*/ 
 
if (rASI(rStrategyId) = true) 
then rStrategyId
else 3 fi
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderSpeedReject.spd(1),149(117,55))*/
(=1):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderSpeedReject.spd(1),131(105,60))*/
output /*#E*/ 
 
OrderSpeedReject(
rShipId,
rStrategyId)
via chRtrSt1
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderSpeedReject.spd(1),125(110,75))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderSpeedReject.spd(1),152(117,85))*/
(=2):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderSpeedReject.spd(1),122(105,90))*/
output /*#E*/ 
 
OrderSpeedReject(
rShipId,
rStrategyId)
via chRtrSt2
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderSpeedReject.spd(1),116(110,105))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderSpeedReject.spd(1),146(57,45))*/
else:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderSpeedReject.spd(1),134(60,50))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderSpeedReject.spd(1),137(80,40))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderSpeedReject.spd,4)*/
endprocedure SendOrderSpeedReject;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderTurnRequest.spd,4)*/
procedure SendOrderTurnRequest;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderTurnRequest.spd(1),125(80,10))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderTurnRequest.spd(1),143(80,25))*/
task /*#E*/ 
 
rASI := import(gASI)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderTurnRequest.spd(1),137(80,40))*/
decision /*#E*/ 
rASI(rStrategyId);
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderTurnRequest.spd(1),152(117,47))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderTurnRequest.spd(1),122(105,55))*/
output /*#E*/ 
 
OrderTurnRequest(
rShipId, rStrategyId,
rHeadingChange)
via chMnRtr
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderTurnRequest.spd(1),155(92,52))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderTurnRequest.spd(1),137(80,40))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderTurnRequest.spd(1),116(85,70))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderTurnRequest.spd,4)*/
endprocedure SendOrderTurnRequest;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderTurnResponse.spd,4)*/
procedure SendOrderTurnResponse;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderTurnResponse.spd(1),140(80,10))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderTurnResponse.spd(1),173(80,25))*/
task /*#E*/ 
 
rASI := import(gASI)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderTurnResponse.spd(1),137(80,40))*/
decision /*#E*/ 
 
if (rASI(rStrategyId) = true) 
then rStrategyId
else 3 fi
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderTurnResponse.spd(1),149(117,55))*/
(=1):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderTurnResponse.spd(1),131(105,60))*/
output /*#E*/ 
 
OrderTurnResponse(
rShipId,
rStrategyId)
via chRtrSt1
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderTurnResponse.spd(1),125(110,75))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderTurnResponse.spd(1),152(117,85))*/
(=2):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderTurnResponse.spd(1),122(105,90))*/
output /*#E*/ 
 
OrderTurnResponse(
rShipId,
rStrategyId)
via chRtrSt2
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderTurnResponse.spd(1),116(110,105))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderTurnResponse.spd(1),146(57,45))*/
else:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderTurnResponse.spd(1),134(60,50))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderTurnResponse.spd(1),137(80,40))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderTurnResponse.spd,4)*/
endprocedure SendOrderTurnResponse;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendFinishSimulation.spd,4)*/
procedure SendFinishSimulation;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendFinishSimulation.spd(1),125(80,10))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendFinishSimulation.spd(1),143(80,25))*/
task /*#E*/ 
 
rASI := import(gASI)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendFinishSimulation.spd(1),152(80,40))*/
decision /*#E*/ 
rASI(rStrategyId);
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendFinishSimulation.spd(1),158(117,47))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendFinishSimulation.spd(1),122(105,55))*/
output /*#E*/ 
 
FinishSimulation(
rTime,
rStrategyId)
via chMnRtr
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendFinishSimulation.spd(1),161(92,52))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendFinishSimulation.spd(1),152(80,40))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendFinishSimulation.spd(1),116(85,70))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendFinishSimulation.spd,4)*/
endprocedure SendFinishSimulation;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderTurnReject.spd,4)*/
procedure SendOrderTurnReject;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderTurnReject.spd(1),140(80,10))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderTurnReject.spd(1),173(80,25))*/
task /*#E*/ 
 
rASI := import(gASI)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderTurnReject.spd(1),137(80,40))*/
decision /*#E*/ 
 
if (rASI(rStrategyId) = true) 
then rStrategyId
else 3 fi
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderTurnReject.spd(1),149(117,55))*/
(=1):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderTurnReject.spd(1),131(105,60))*/
output /*#E*/ 
 
OrderTurnReject(
rShipId,
rStrategyId)
via chRtrSt1
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderTurnReject.spd(1),125(110,75))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderTurnReject.spd(1),152(117,85))*/
(=2):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderTurnReject.spd(1),122(105,90))*/
output /*#E*/ 
 
OrderTurnReject(
rShipId,
rStrategyId)
via chRtrSt2
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderTurnReject.spd(1),116(110,105))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderTurnReject.spd(1),146(57,45))*/
else:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderTurnReject.spd(1),134(60,50))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderTurnReject.spd(1),137(80,40))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderTurnReject.spd,4)*/
endprocedure SendOrderTurnReject;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendVisibleShip.spd,4)*/
procedure SendVisibleShip;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendVisibleShip.spd(1),116(80,10))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendVisibleShip.spd(1),182(80,25))*/
task /*#E*/ 
 
rASI := import(gASI)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendVisibleShip.spd(1),119(80,40))*/
decision /*#E*/ 
 
if (rASI(rStrategyId) = true) 
then rStrategyId
else 3 fi
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendVisibleShip.spd(1),149(117,55))*/
(=1):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendVisibleShip.spd(1),125(105,60))*/
output /*#E*/ 
 
VisibleShip(
rStrategyId,
rStringEnemyShip)
via chRtrSt1
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendVisibleShip.spd(1),164(110,75))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendVisibleShip.spd(1),152(117,85))*/
(=2):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendVisibleShip.spd(1),134(105,90))*/
output /*#E*/ 
 
VisibleShip(
rStrategyId,
rStringEnemyShip)
via chRtrSt2
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendVisibleShip.spd(1),131(110,105))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendVisibleShip.spd(1),158(57,45))*/
else:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendVisibleShip.spd(1),155(60,50))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendVisibleShip.spd(1),119(80,40))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendVisibleShip.spd,4)*/
endprocedure SendVisibleShip;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderFireRequest.spd,4)*/
procedure SendOrderFireRequest;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderFireRequest.spd(1),125(80,10))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderFireRequest.spd(1),143(80,25))*/
task /*#E*/ 
 
rASI := import(gASI)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderFireRequest.spd(1),137(80,40))*/
decision /*#E*/ 
rASI(rStrategyId);
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderFireRequest.spd(1),158(117,47))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderFireRequest.spd(1),122(105,55))*/
output /*#E*/ 
 
OrderFireRequest(
rShipId, rStrategyId,
rNameWeaponry,
rStringShotsList)
via chMnRtr
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderFireRequest.spd(1),155(92,52))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderFireRequest.spd(1),137(80,40))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderFireRequest.spd(1),116(85,70))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderFireRequest.spd,4)*/
endprocedure SendOrderFireRequest;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendShipsCurrentState.spd,4)*/
procedure SendShipsCurrentState;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendShipsCurrentState.spd(1),140(80,10))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendShipsCurrentState.spd(1),182(80,25))*/
task /*#E*/ 
 
rASI := import(gASI)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendShipsCurrentState.spd(1),137(80,40))*/
decision /*#E*/ 
 
if (rASI(rStrategyId) = true) 
then rStrategyId
else 3 fi
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendShipsCurrentState.spd(1),149(117,55))*/
(=1):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendShipsCurrentState.spd(1),131(105,60))*/
output /*#E*/ 
 
ShipsCurrentState(
rStrategyId,rString_
ShipCurrentState)
via chRtrSt1
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendShipsCurrentState.spd(1),125(110,75))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendShipsCurrentState.spd(1),152(117,85))*/
(=2):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendShipsCurrentState.spd(1),122(105,90))*/
output /*#E*/ 
 
ShipsCurrentState(
rStrategyId,rString_
ShipCurrentState)
via chRtrSt2
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendShipsCurrentState.spd(1),116(110,105))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendShipsCurrentState.spd(1),146(57,45))*/
else:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendShipsCurrentState.spd(1),134(60,50))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendShipsCurrentState.spd(1),137(80,40))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendShipsCurrentState.spd,4)*/
endprocedure SendShipsCurrentState;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderFireResponse.spd,4)*/
procedure SendOrderFireResponse;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderFireResponse.spd(1),140(80,10))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderFireResponse.spd(1),173(80,25))*/
task /*#E*/ 
 
rASI := import(gASI)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderFireResponse.spd(1),137(80,40))*/
decision /*#E*/ 
 
if (rASI(rStrategyId) = true) 
then rStrategyId
else 3 fi
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderFireResponse.spd(1),149(117,55))*/
(=1):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderFireResponse.spd(1),131(105,60))*/
output /*#E*/ 
 
OrderFireResponse(
rShipId,
rStrategyId)
via chRtrSt1
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderFireResponse.spd(1),125(110,75))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderFireResponse.spd(1),152(117,85))*/
(=2):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderFireResponse.spd(1),122(105,90))*/
output /*#E*/ 
 
OrderFireResponse(
rShipId,
rStrategyId)
via chRtrSt2
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderFireResponse.spd(1),116(110,105))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderFireResponse.spd(1),146(57,45))*/
else:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderFireResponse.spd(1),134(60,50))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderFireResponse.spd(1),137(80,40))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderFireResponse.spd,4)*/
endprocedure SendOrderFireResponse;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendStrategyVictory.spd,4)*/
procedure SendStrategyVictory;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendStrategyVictory.spd(1),140(80,10))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendStrategyVictory.spd(1),173(80,25))*/
task /*#E*/ 
 
rASI := import(gASI)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendStrategyVictory.spd(1),137(80,40))*/
decision /*#E*/ 
 
if (rASI(rStrategyId) = true) 
then rStrategyId
else 3 fi
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendStrategyVictory.spd(1),149(117,55))*/
(=1):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendStrategyVictory.spd(1),131(105,60))*/
output /*#E*/ 
 
StrategyVictory
(rStrategyId)
via chRtrSt1
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendStrategyVictory.spd(1),125(110,75))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendStrategyVictory.spd(1),152(117,85))*/
(=2):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendStrategyVictory.spd(1),122(105,90))*/
output /*#E*/ 
 
StrategyVictory
(rStrategyId)
via chRtrSt2
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendStrategyVictory.spd(1),116(110,105))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendStrategyVictory.spd(1),146(57,45))*/
else:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendStrategyVictory.spd(1),134(60,50))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendStrategyVictory.spd(1),137(80,40))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendStrategyVictory.spd,4)*/
endprocedure SendStrategyVictory;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderFireReject.spd,4)*/
procedure SendOrderFireReject;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderFireReject.spd(1),140(80,10))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderFireReject.spd(1),173(80,25))*/
task /*#E*/ 
 
rASI := import(gASI)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderFireReject.spd(1),137(80,40))*/
decision /*#E*/ 
 
if (rASI(rStrategyId) = true) 
then rStrategyId
else 3 fi
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderFireReject.spd(1),149(117,55))*/
(=1):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderFireReject.spd(1),131(105,60))*/
output /*#E*/ 
 
OrderFireReject(
rShipId,
rStrategyId)
via chRtrSt1
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderFireReject.spd(1),125(110,75))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderFireReject.spd(1),152(117,85))*/
(=2):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderFireReject.spd(1),122(105,90))*/
output /*#E*/ 
 
OrderFireReject(
rShipId,
rStrategyId)
via chRtrSt2
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderFireReject.spd(1),116(110,105))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderFireReject.spd(1),146(57,45))*/
else:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderFireReject.spd(1),134(60,50))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderFireReject.spd(1),137(80,40))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendOrderFireReject.spd,4)*/
endprocedure SendOrderFireReject;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendStrategyLose.spd,4)*/
procedure SendStrategyLose;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendStrategyLose.spd(1),140(80,10))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendStrategyLose.spd(1),173(80,25))*/
task /*#E*/ 
 
rASI := import(gASI)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendStrategyLose.spd(1),137(80,40))*/
decision /*#E*/ 
 
if (rASI(rStrategyId) = false) 
then rStrategyId
else 3 fi
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendStrategyLose.spd(1),149(117,55))*/
(=1):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendStrategyLose.spd(1),131(105,60))*/
output /*#E*/ 
 
StrategyLose
(rStrategyId)
via chRtrSt1
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendStrategyLose.spd(1),125(110,75))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendStrategyLose.spd(1),152(117,85))*/
(=2):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendStrategyLose.spd(1),122(105,90))*/
output /*#E*/ 
 
StrategyLose
(rStrategyId)
via chRtrSt2
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendStrategyLose.spd(1),116(110,105))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendStrategyLose.spd(1),146(57,45))*/
else:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendStrategyLose.spd(1),134(60,50))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendStrategyLose.spd(1),137(80,40))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendStrategyLose.spd,4)*/
endprocedure SendStrategyLose;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendDestroyShip.spd,4)*/
procedure SendDestroyShip;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendDestroyShip.spd(1),143(80,10))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendDestroyShip.spd(1),176(80,25))*/
task /*#E*/ 
 
rASI := import(gASI)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendDestroyShip.spd(1),140(80,40))*/
decision /*#E*/ 
 
if (rASI(rStrategyId) = true) 
then rStrategyId
else 3 fi
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendDestroyShip.spd(1),155(117,55))*/
(=1):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendDestroyShip.spd(1),131(105,60))*/
output /*#E*/ 
 
VisibleShip(
rStrategyId,
rStringEnemyShip)
via chRtrSt1
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendDestroyShip.spd(1),125(110,75))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendDestroyShip.spd(1),158(117,85))*/
(=2):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendDestroyShip.spd(1),122(105,90))*/
output /*#E*/ 
 
VisibleShip(
rStrategyId,
rStringEnemyShip)
via chRtrSt2
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendDestroyShip.spd(1),116(110,105))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendDestroyShip.spd(1),152(57,45))*/
else:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendDestroyShip.spd(1),134(60,50))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendDestroyShip.spd(1),140(80,40))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\SendDestroyShip.spd,4)*/
endprocedure SendDestroyShip;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr,4)*/
process DataSender;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(1),389(5,95))*/
/*
External functions for pushing 
ships container.
*/

procedure PushFixedShipPart;
fpar
  ShipID Integer,
  StrategyID Integer,
  TypeShip Integer,
  Speed Integer,
  Heading Integer,
  Resource Integer,
  CoordinatesX Integer,
  CoordinatesY Integer,
  MissleAmount Integer,
  TorpedoAmount Integer,
  ShellAmount Integer,
  RepairAmount Integer;
external;

procedure PushVariableShipPart;
fpar
  Visible Integer;
external;

procedure PushShipsDummy;
returns Integer;
external;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(1),404(65,95))*/
/*
External function for pushing 
shots container.
*/

procedure PushShot;
  fpar
    TypeWeaponry Integer,
    CurrentCoordinatesX Integer,
    CurrentCoordinatesY Integer,
    TargetCoordinatesX Integer,
    TargetCoordinatesY Integer,
    ShotId Integer;
external;

procedure PushShotsDummy;
returns Integer;
external;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(1),350(130,95))*/
/*
Common protocol function tasks.
*/

procedure InitConnection;
returns Integer;
external;

procedure PushParam;
fpar
  Param Integer;
external;

procedure PushMap;
returns Integer;
external;

procedure SendData;
returns Integer;
external;

procedure CloseClientConnection;
external;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(1),881(65,170))*/
/*
Globals const  definition.
*/

synonym rcNoError Integer = 0;
synonym rcCommonFault Integer = (-1);

/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(2),362(130,10))*/
imported
  gShips tStringShipParameters,
  gShots tStringShotParameters;
dcl
  impShips tStringShipParameters,
  impShots tStringShotParameters;
dcl
  tmpRes Integer;

/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(1),320(5,25))*/
procedure /*#E*/ 
PushShips referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(1),323(5,45))*/
procedure /*#E*/ 
PushShots referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(2),119(80,20))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(2),176(80,35))*/
nextstate /*#E*/ 
Listening;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(2),176(80,35))*/
state /*#E*/ 
Listening;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(2),725(30,55))*/
input /*#E*/ 
InitSocket;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(2),638(35,75))*/
join /*#E*/ 
toInitSocket;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(2),887(75,55))*/
input /*#E*/ 
CloseClientSocket;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(2),893(85,75))*/
join /*#E*/ 
toCloseClientConnection;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(2),185(130,55))*/
input /*#E*/ 
SendData;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(2),545(135,75))*/
join /*#E*/ 
toSendingData;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(2),176(80,35))*/
endstate;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(2),641(35,100))*/
connection /*#E*/ 
fromInitSocket:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(2),179(80,145))*/
nextstate /*#E*/ 
-;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(2),641(35,100))*/
endconnection fromInitSocket;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(2),899(85,100))*/
connection /*#E*/ 
fromCloseClientConnection:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(2),179(80,145))*/
join /*#E*/ 
fromInitSocket;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(2),899(85,100))*/
endconnection fromCloseClientConnection;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(2),551(135,100))*/
connection /*#E*/ 
fromSendingData:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(2),179(80,145))*/
join /*#E*/ 
fromInitSocket;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(2),551(135,100))*/
endconnection fromSendingData;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(3),623(25,30))*/
connection /*#E*/ 
toSendingData:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(3),596(5,45))*/
task {/*#E*/ 
impShips := import(gShips);
impShots := import(gShots);};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(3),758(20,75))*/
task {/*#E*/ 
 
tmpRes := call PushShips;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(3),770(20,95))*/
decision /*#E*/ 
tmpRes;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(3),776(32,107))*/
(=rcNoError):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(3),794(20,130))*/
task {/*#E*/ 
 
tmpRes := call PushShots;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(3),806(20,150))*/
decision /*#E*/ 
tmpRes;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(3),815(32,162))*/
(=rcNoError):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(3),578(20,180))*/
output /*#E*/ 
 
SendDataComplete(EC_OK)
;
grst2559_1:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(3),629(25,215))*/
join /*#E*/ 
fromSendingData;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(3),812(42,150))*/
(=rcCommonFault):
grst2559_2:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(3),782(105,180))*/
output /*#E*/ 
 
SendDataComplete(EC_FAULT)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(3),629(25,215))*/
join /*#E*/ 
grst2559_1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(3),806(20,150))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(3),788(120,102))*/
(=rcCommonFault):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(3),782(105,180))*/
join /*#E*/ 
grst2559_2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(3),770(20,95))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(3),623(25,30))*/
endconnection toSendingData;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(4),740(35,25))*/
connection /*#E*/ 
toInitSocket:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(4),674(30,55))*/
task {/*#E*/ 
 
tmpRes := call InitConnection;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(4),668(30,70))*/
decision /*#E*/ 
tmpRes;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(4),689(42,80))*/
(=rcNoError):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(4),665(30,85))*/
call /*#E*/ 
PushParam 
(AmountStrategy)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(4),830(30,105))*/
task {/*#E*/ 
 
tmpRes := call SendData;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(4),839(30,120))*/
decision /*#E*/ 
tmpRes;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(4),854(42,132))*/
(=rcNoError):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(4),851(30,145))*/
task {/*#E*/ 
 
tmpRes := call PushMap;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(4),866(30,160))*/
decision /*#E*/ 
tmpRes;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(4),872(42,172))*/
(=rcNoError):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(4),650(30,195))*/
output /*#E*/ 
 
InitSocketComplete(EC_OK)
;
grst2559_3:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(4),737(35,210))*/
join /*#E*/ 
fromInitSocket;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(4),875(50,160))*/
(=rcCommonFault):
grst2559_4:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(4),659(105,195))*/
output /*#E*/ 
 
InitSocketComplete(EC_FAULT)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(4),737(35,210))*/
join /*#E*/ 
grst2559_3;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(4),866(30,160))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(4),848(50,120))*/
(=rcCommonFault):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(4),659(105,195))*/
join /*#E*/ 
grst2559_4;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(4),839(30,120))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(4),692(117,82))*/
(=rcCommonFault):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(4),659(105,195))*/
join /*#E*/ 
grst2559_4;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(4),668(30,70))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(4),740(35,25))*/
endconnection toInitSocket;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(5),917(75,15))*/
connection /*#E*/ 
toCloseClientConnection:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(5),920(60,35))*/
call /*#E*/ 
CloseClientConnection;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(5),926(75,55))*/
join /*#E*/ 
fromCloseClientConnection;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr(5),917(75,15))*/
endconnection toCloseClientConnection;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\DataSender.spr,4)*/
endprocess DataSender;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\PushShips.spd,4)*/
procedure PushShips
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\PushShips.spd,1)*/
;
returns Integer;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\PushShips.spd(1),164(130,10))*/
dcl i,k Integer;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\PushShips.spd(1),149(60,15))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\PushShips.spd(1),185(55,30))*/
decision /*#E*/ 
length(impShips);
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\PushShips.spd(1),194(112,37))*/
(>0):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\PushShips.spd(1),191(100,50))*/
task {/*#E*/ 
 
for (i:=1, i <= length(impShips), i+1)
{
  call PushFixedShipPart(
    impShips(i)!ShipId,
    impShips(i)!StrategyId,
    ns2i(impShips(i)!TypeShip),
    impShips(i)!Speed,
    h2i(impShips(i)!Heading),
    impShips(i)!Resource,
    impShips(i)!Coordinates!x,
    impShips(i)!Coordinates!y,
    impShips(i)!Ammunition(MISSILE),
    impShips(i)!Ammunition(TORPEDO),
    impShips(i)!Ammunition(SHELL),
    impShips(i)!Ammunition(REPAIR)
  );
  for (k:=1, k <= AmountStrategy, k+1)
  {
    if (impShips(i)!VisibleToStrategy(k))
    {
       call PushVariableShipPart(1);
    } else
    {
       call PushVariableShipPart(0);
    }
  }
}
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\PushShips.spd(1),266(100,155))*/
task {/*#E*/ 
 
tmpRes := call SendData;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\PushShips.spd(1),245(22,37))*/
(=0):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\PushShips.spd(1),242(15,155))*/
task {/*#E*/ 
 
tmpRes := call PushShipsDummy;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\PushShips.spd(1),185(55,30))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\PushShips.spd(1),254(60,180))*/
decision /*#E*/ 
tmpRes;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\PushShips.spd(1),260(42,187))*/
(rcNoError):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\PushShips.spd(1),236(20,205))*/
return /*#E*/ 
rcNoError;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\PushShips.spd(1),263(112,187))*/
(rcCommonFault):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\PushShips.spd(1),152(105,205))*/
return /*#E*/ 
rcCommonFault;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\PushShips.spd(1),254(60,180))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\PushShips.spd,4)*/
endprocedure PushShips;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\PushShots.spd,4)*/
procedure PushShots
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\PushShots.spd,1)*/
;
returns Integer;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\PushShots.spd(1),140(150,10))*/
dcl i Integer;
dcl tmp Integer;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\PushShots.spd(1),116(35,20))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\PushShots.spd(1),152(35,35))*/
decision /*#E*/ 
 
length(impShots)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\PushShots.spd(1),164(47,45))*/
(>0):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\PushShots.spd(1),125(35,65))*/
task {/*#E*/ 
 
for (i:=1, i<= length(impShots), i+1)
{
    call PushShot(
      nw2i(impShots(i)!TypeWeaponry),
      impShots(i)!CurrentCoordinates!x,
      impShots(i)!CurrentCoordinates!y,

      impShots(i)!FinishCoordinates!x,
      impShots(i)!FinishCoordinates!y,

      impShots(i)!ShotId
    );
}
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\PushShots.spd(1),206(35,115))*/
task {/*#E*/ 
 
/*tmpRes := call SendData;*/
tmp := call SendData;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\PushShots.spd(1),185(122,45))*/
(=0):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\PushShots.spd(1),218(110,115))*/
task {/*#E*/ 
 
/*tmpRes := call PushShotsDummy;*/
tmp := call PushShotsDummy;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\PushShots.spd(1),152(35,35))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\PushShots.spd(1),197(75,170))*/
decision /*#E*/ 
tmpRes;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\PushShots.spd(1),200(47,177))*/
(rcNoError):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\PushShots.spd(1),194(40,190))*/
return /*#E*/ 
rcNoError;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\PushShots.spd(1),203(122,177))*/
(rcCommonFault):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\PushShots.spd(1),119(115,190))*/
return /*#E*/ 
rcCommonFault;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\PushShots.spd(1),197(75,170))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Simulator\PushShots.spd,4)*/
endprocedure PushShots;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1.sbk,4)*/
block Strategy1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1.sbk(1),185(42,55))*/
signalroute /*#E*/ 
chStSim from 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1.sbk(1),104(15,15))*/
env to 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1.sbk(1),179(85,50))*/
Main1 with 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1.sbk(1),186(60,62))*/
(fromSimulator);
from 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1.sbk(1),179(85,50))*/
Main1 to 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1.sbk(1),104(15,15))*/
env with 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1.sbk(1),187(17,62))*/
(toSimulator);
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1.sbk(1),191(122,55))*/
signalroute /*#E*/ 
chStMsg from 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1.sbk(1),179(85,50))*/
Main1 to 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1.sbk(1),104(15,15))*/
env with 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1.sbk(1),192(152,62))*/
messageLog,
messageError;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1.sbk(1),179(85,50))*/
process /*#E*/ 
Main1 referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1.sbk(1),200(7,52))*/
connect /*#E*/ 
SimSt1Int and 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1.sbk(1),185(42,55))*/
chStSim;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1.sbk(1),203(167,52))*/
connect /*#E*/ 
St1MsgInt and 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1.sbk(1),191(122,55))*/
chStMsg;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1.sbk,4)*/
endblock Strategy1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\Main.spr,4)*/
process Main1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\Main.spr(1),143(5,25))*/
imported
    gWeaponryCharacter tArrayWeaponryCharacter,
    gShipsCharacter tArrayShipsCharacter;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\Main.spr(1),665(90,25))*/
synonym 
   FirstQuaterX Integer = 3*MaxXCoordinate/4,
   FirstQuaterY Integer = 3*MaxYCoordinate/4,
   SecondQuaterX Integer = 3*MaxXCoordinate/4,
   SecondQuaterY Integer = MaxYCoordinate/4,
   ThirdQuaterX Integer = MaxXCoordinate/4,
   ThirdQuaterY Integer = MaxYCoordinate/4,
   FourthQuaterX Integer = MaxXCoordinate/4,
   FourthQuaterY Integer = 3*MaxYCoordinate/4;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\Main.spr(1),506(5,40))*/
newtype tOrderType
 literals
    _RIGHT,
    _LEFT,
    _FIRE,
    _ACCEL;
endnewtype;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\Main.spr(1),482(5,70))*/
newtype tFire
  struct
    List tStringShotsList;
    Weapon tNameWeaponry; 
endnewtype;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\Main.spr(1),479(5,95))*/
newtype tCommand
  struct
    OrderType  tOrderType;
    isSet Boolean;
    Fire tFire;
    Accel tFactorAcceleration;
endnewtype;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\Main.spr(1),476(5,125))*/
newtype tArrayCommand
  Array(tShipId,tCommand);
endnewtype;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\Main.spr(2),638(5,40))*/
dcl 
   WeaponryCharacter tArrayWeaponryCharacter,
   ShipsCharacter tArrayShipsCharacter;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\Main.spr(2),620(5,80))*/
dcl 
   MyCenter tCoordinates,
   Tick,NumMyShips, minSpeed Integer,
   flagFight Boolean := true,
   HeadingTarget tCoordinates,
   ShipsCurrentState tStringShipCurrentState,
   CommandToShip tArrayCommand,
   StrategyID tStrategyId;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\Main.spr(2),635(5,145))*/
dcl
   EnemyCenter tCoordinates,
   NumVisibleShips Integer,
   EnemyShips tStringEnemyShip;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\Main.spr(2),632(85,25))*/
procedure /*#E*/ 
StrategyStep referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\Main.spr(2),629(85,40))*/
procedure /*#E*/ 
EnemyCenter referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\Main.spr(2),623(85,55))*/
procedure /*#E*/ 
UpdateShipParams referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\Main.spr(3),119(70,10))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\Main.spr(3),116(70,25))*/
nextstate /*#E*/ 
Idle;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\Main.spr(3),116(70,25))*/
state /*#E*/ 
Idle;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\Main.spr(3),182(70,40))*/
input /*#E*/ 
InitData_
Complete;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\Main.spr(3),149(70,55))*/
task {/*#E*/ 
 
WeaponryCharacter := import(gWeaponryCharacter);
ShipsCharacter := import(gShipsCharacter);
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\Main.spr(3),197(70,75))*/
nextstate /*#E*/ 
InitComplete;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\Main.spr(3),116(70,25))*/
endstate;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\Main.spr(3),197(70,75))*/
state /*#E*/ 
InitComplete;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\Main.spr(3),584(45,90))*/
save /*#E*/ 
VisibleShip;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\Main.spr(3),284(70,90))*/
input /*#E*/ 
 
ShipsCurrentState(StrategyID,
ShipsCurrentState)
;
grst4839_1:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\Main.spr(3),551(70,105))*/
call /*#E*/ 
 
UpdateShipParams
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\Main.spr(3),311(70,120))*/
nextstate /*#E*/ 
IdleVisShips;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\Main.spr(3),197(70,75))*/
endstate;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\Main.spr(3),311(70,120))*/
state /*#E*/ 
IdleVisShips;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\Main.spr(3),326(55,135))*/
input /*#E*/ 
 
StartSimulation(Tick)  
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\Main.spr(3),206(55,150))*/
call /*#E*/ 
 
StrategyStep(
ShipsCurrentState)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\Main.spr(3),353(55,165))*/
output /*#E*/ 
 
FinishSimulation(Tick, 
StrategyID)  
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\Main.spr(3),734(55,180))*/
nextstate /*#E*/ 
IdleRes;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\Main.spr(3),317(85,135))*/
input /*#E*/ 
 
VisibleShip(StrategyID,EnemyShips)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\Main.spr(3),386(85,150))*/
call /*#E*/ 
Enemy_
Center;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\Main.spr(3),329(85,165))*/
nextstate /*#E*/ 
-;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\Main.spr(3),311(70,120))*/
endstate;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\Main.spr(3),734(55,180))*/
state /*#E*/ 
IdleRes;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\Main.spr(3),770(40,195))*/
input /*#E*/ 
 
ShipsCurrentState(
StrategyID,
ShipsCurrentState)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\Main.spr(3),551(70,105))*/
join /*#E*/ 
grst4839_1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\Main.spr(3),749(70,195))*/
input /*#E*/ 
 
  OrderSpeedResponse, OrderSpeedReject, 
  OrderTurnResponse, OrderTurnReject, 
  OrderFireResponse, OrderFireReject, DestroyShip
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\Main.spr(3),761(70,210))*/
nextstate /*#E*/ 
-;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\Main.spr(3),734(55,180))*/
endstate;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\Main.spr(3),230(120,10))*/
state /*#E*/ 
*;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\Main.spr(3),227(120,25))*/
input /*#E*/ 
 
StrategyVictory(StrategyID),
StrategyLose(StrategyID)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\Main.spr(3),266(125,40))*/
stop /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\Main.spr(3),230(120,10))*/
endstate;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\Main.spr,4)*/
endprocess Main1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\UpdateShipParams.spd,4)*/
procedure UpdateShipParams;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\UpdateShipParams.spd(1),224(130,10))*/
dcl
  TempCenterX, TempCenterY Real,
   i Integer;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\UpdateShipParams.spd(1),116(25,20))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\UpdateShipParams.spd(1),122(25,40))*/
task {/*#E*/ 
 
NumVisibleShips := 0;
NumMyShips := length(ShipsCurrentState);
TempCenterX := 0;
TempCenterY := 0;
minSpeed := ShipsCharacter(ShipsCurrentState(1)!TypeShip)!MaxSpeed;
for (i:=1, i<=NumMyShips, i+1){
  CommandToShip(i)!isSet := false;
  CommandToShip(i)!Fire!List := empty;
  TempCenterX := TempCenterX + float(ShipsCurrentState(i)!Coordinates!x)/float(NumMyShips);
  TempCenterY := TempCenterY + float(ShipsCurrentState(i)!Coordinates!y)/float(NumMyShips);
  if (ShipsCharacter(ShipsCurrentState(i)!TypeShip)!MaxSpeed <= minSpeed) {
    minSpeed := ShipsCharacter(ShipsCurrentState(i)!TypeShip)!MaxSpeed;
  }
}
MyCenter!x := fix(TempCenterX);
MyCenter!y := fix(TempCenterY);
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\UpdateShipParams.spd(1),119(30,90))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\UpdateShipParams.spd,4)*/
endprocedure UpdateShipParams;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyCenter.spd,4)*/
procedure EnemyCenter;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyCenter.spd(1),140(125,15))*/
dcl
  TempCenterX, TempCenterY Real,
   i Integer;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyCenter.spd(1),116(10,25))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyCenter.spd(1),122(10,45))*/
task {/*#E*/ 
 
TempCenterX := 0;
TempCenterY := 0;
NumVisibleShips := length(EnemyShips);
for (i:=1, i<=NumVisibleShips, i+1) {
  TempCenterX := TempCenterX + float(EnemyShips(i)!Coordinates!x)/float(NumVisibleShips);
  TempCenterY := TempCenterY + float(EnemyShips(i)!Coordinates!y)/float(NumVisibleShips);
}
 EnemyCenter!x := fix(TempCenterX);
 EnemyCenter!y := fix(TempCenterY);
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyCenter.spd(1),119(15,60))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyCenter.spd,4)*/
endprocedure EnemyCenter;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd,4)*/
procedure StrategyStep
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd,1)*/
; fpar
  in/out ShipsCurrState tStringShipCurrentState;

/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(1),254(5,30))*/
newtype tTurnDirection inherits tHeadingChange
  adding literals
     STRAIGHT;
endnewtype;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(1),329(5,50))*/
newtype tCollision
   literals
     NO_COLLISION,
     LAND_COLLISION,
     ENEMY_SHIP_COLLISION,
     MY_SHIP_COLLISION;
endnewtype;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(1),200(5,80))*/
dcl
   index Integer := 1,
   CollisionType tCollision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(1),1025(85,20))*/
procedure /*#E*/ 
EnemyFound referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(1),926(85,35))*/
procedure /*#E*/ 
EnemyNotFound referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(1),872(85,55))*/
procedure /*#E*/ 
NextPosition referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(1),866(85,75))*/
procedure /*#E*/ 
NextDirection referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(1),860(85,95))*/
procedure /*#E*/ 
NewHeadingChange referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(1),854(85,115))*/
procedure /*#E*/ 
isCollision referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(1),848(85,130))*/
procedure /*#E*/ 
SolveCollision referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(1),917(85,145))*/
procedure /*#E*/ 
NextShipState referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(1),1274(85,160))*/
procedure /*#E*/ 
OutputOrder referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(1),1352(85,175))*/
procedure /*#E*/ 
FindHeadingTarget referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(1),1346(85,195))*/
procedure /*#E*/ 
FindStartPoint referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(1),2000(85,210))*/
procedure /*#E*/ 
OnLand referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(2),137(75,30))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(2),209(75,50))*/
decision /*#E*/ 
 
NumVisibleShips = 0
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(2),1145(70,50))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(2),1139(60,70))*/
task {/*#E*/ 
 
if (flagFight =false)
flagFight := true;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(2),1490(65,85))*/
join /*#E*/ 
Step1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(2),1313(97,50))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(2),1310(95,70))*/
task {/*#E*/ 
 
if (flagFight=true) {
  flagFight := false;
  call FindStartPoint;
}
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(2),1361(95,100))*/
decision /*#E*/ 
 
 ((MyCenter!x <=
   HeadingTarget!x + 5) AND
    (MyCenter!x >=
   HeadingTarget!x  - 5) AND 
    (MyCenter!y <=
   HeadingTarget!y + 5) AND 
    (MyCenter!y>=
   HeadingTarget!y  - 5)) 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(2),1376(90,100))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(2),1370(80,115))*/
call /*#E*/ 
 
FindHeadingTarget
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(2),1598(107,110))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(2),1361(95,100))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(2),1595(100,135))*/
join /*#E*/ 
Step2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(2),209(75,50))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(3),1484(75,25))*/
connection /*#E*/ 
Step1:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(3),2060(70,45))*/
decision /*#E*/ 
 
(call getDeepXY(ShipsCurrState(index)!Coordinates!x,
ShipsCurrState(index)!Coordinates!y)) <
d2i(ShipsCharacter(ShipsCurrState(index)!_
TypeShip)!MaxDeep)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(3),2081(62,57))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(3),2072(55,65))*/
call /*#E*/ 
 
OnLand(
ShipsCurrState(index),
index)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(3),2069(92,57))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(3),1439(85,65))*/
call /*#E*/ 
 
EnemyFound(
ShipsCurrState(index),
index)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(3),2060(70,45))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(3),1433(70,85))*/
task {/*#E*/ 
 
CollisionType := 
call isCollision;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(3),1427(70,100))*/
decision /*#E*/ 
 
CollisionType
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(3),1457(52,107))*/
(NO_COLLISION):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(3),1421(55,115))*/
call /*#E*/ 
OutputOrder;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(3),1460(87,107))*/
else:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(3),1418(85,115))*/
call /*#E*/ 
 
SolveCollision
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(3),1427(70,100))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(3),1412(70,130))*/
task {/*#E*/ 
index := 
index + 1;};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(3),1409(70,145))*/
decision /*#E*/ 
 
index <=
NumMyShips
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(3),2087(62,145))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(3),1610(82,155))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(3),1607(75,160))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(3),1409(70,145))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(3),2060(70,45))*/
join /*#E*/ 
Step1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(3),1484(75,25))*/
endconnection Step1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(4),1742(75,25))*/
connection /*#E*/ 
Step2:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(4),2012(70,45))*/
decision /*#E*/ 
 
(call getDeepXY(ShipsCurrState(index)!Coordinates!x,
ShipsCurrState(index)!Coordinates!y)) <
d2i(ShipsCharacter(ShipsCurrState(index)!_
TypeShip)!MaxDeep)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(4),2030(57,57))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(4),2024(55,65))*/
call /*#E*/ 
 
OnLand(
ShipsCurrState(index),
index)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(4),2051(92,57))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(4),1739(85,65))*/
call /*#E*/ 
 
EnemyNotFound(
ShipsCurrState(index),
index)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(4),2012(70,45))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(4),1733(70,85))*/
task {/*#E*/ 
 
CollisionType := 
call isCollision;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(4),1727(70,100))*/
decision /*#E*/ 
 
CollisionType
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(4),1763(52,107))*/
(NO_COLLISION):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(4),1721(55,115))*/
call /*#E*/ 
OutputOrder;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(4),1766(87,107))*/
else:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(4),1718(85,115))*/
call /*#E*/ 
 
SolveCollision
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(4),1727(70,100))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(4),1712(70,130))*/
task {/*#E*/ 
index := 
index + 1;};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(4),1709(70,145))*/
decision /*#E*/ 
 
index <=
NumMyShips
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(4),2054(62,145))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(4),1787(82,155))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(4),1703(75,160))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(4),1709(70,145))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(4),2012(70,45))*/
join /*#E*/ 
Step2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd(4),1742(75,25))*/
endconnection Step2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\StrategyStep.spd,4)*/
endprocedure StrategyStep;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\SolveCollision.spd,4)*/
procedure SolveCollision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\SolveCollision.spd(1),116(75,15))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\SolveCollision.spd(1),125(75,35))*/
decision /*#E*/ 
 
CollisionType
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\SolveCollision.spd(1),140(35,35))*/
(ENEMY_SHIP_COLLISION):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\SolveCollision.spd(1),137(60,50))*/
decision /*#E*/ 
 
((ShipsCurrState(index)!Ammunition(   
MISSILE) = 0) AND
(ShipsCurrState(index)!Ammunition(
TORPEDO) = 0) AND
(ShipsCurrState(index)!Ammunition(
SHELL) = 0) AND
(ShipsCurrState(index)!Ammunition(
REPAIR) = 0))
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\SolveCollision.spd(1),158(50,50))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\SolveCollision.spd(1),155(45,65))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\SolveCollision.spd(1),596(72,62))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\SolveCollision.spd(1),137(60,50))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\SolveCollision.spd(1),587(87,45))*/
else:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\SolveCollision.spd(1),125(75,35))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\SolveCollision.spd(1),584(75,85))*/
decision /*#E*/ 
 
((CommandToShip(index)!isSet = true)AND
(CommandToShip(index)!OrderType = _ACCEL)AND
(CommandToShip(index)!Accel > 0))
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\SolveCollision.spd(1),605(87,95))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\SolveCollision.spd(1),593(75,105))*/
task {/*#E*/ 
 
CommandToShip(index)!isSet := false;
CollisionType := call isCollision;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\SolveCollision.spd(1),569(75,120))*/
decision /*#E*/ 
 
CollisionType = NO_COLLISION
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\SolveCollision.spd(1),578(72,120))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\SolveCollision.spd(1),557(65,135))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\SolveCollision.spd(1),611(87,132))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\SolveCollision.spd(1),569(75,120))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\SolveCollision.spd(1),617(72,85))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\SolveCollision.spd(1),584(75,85))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\SolveCollision.spd(1),527(80,155))*/
join /*#E*/ 
Solv1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\SolveCollision.spd(2),518(90,15))*/
connection /*#E*/ 
Solv1:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\SolveCollision.spd(2),488(85,30))*/
task {/*#E*/ 
 
CommandTo_
Ship(index)!OrderType := _RIGHT;
CommandToShip(index)!isSet := true;
CollisionType := call isCollision;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\SolveCollision.spd(2),482(85,50))*/
decision /*#E*/ 
 
CollisionType = NO_COLLISION
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\SolveCollision.spd(2),500(82,50))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\SolveCollision.spd(2),476(60,60))*/
output /*#E*/ 
 
OrderTurnRequest(
ShipsCurrState(index)!ShipId, 
StrategyID, RIGHT)  
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\SolveCollision.spd(2),470(65,75))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\SolveCollision.spd(2),509(97,62))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\SolveCollision.spd(2),467(85,70))*/
task {/*#E*/ 
 
CommandTo_
Ship(index)!OrderType := _LEFT;
CommandToShip(index)!isSet := true;
CollisionType := call isCollision;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\SolveCollision.spd(2),362(85,95))*/
decision /*#E*/ 
 
CollisionType = NO_COLLISION
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\SolveCollision.spd(2),368(67,95))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\SolveCollision.spd(2),356(60,105))*/
output /*#E*/ 
 
OrderTurnRequest(
ShipsCurrState(index)!ShipId, 
StrategyID, LEFT)  
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\SolveCollision.spd(2),350(65,120))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\SolveCollision.spd(2),377(97,107))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\SolveCollision.spd(2),347(85,120))*/
task {/*#E*/ 
 
CommandTo_
Ship(index)!OrderType := _ACCEL;
CommandTo_
Ship(index)!Accel := -1;
CommandToShip(index)!isSet := true;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\SolveCollision.spd(2),341(85,140))*/
output /*#E*/ 
 
OrderSpeedRequest(
ShipsCurrState(index)!ShipId, 
StrategyID,-1)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\SolveCollision.spd(2),335(90,155))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\SolveCollision.spd(2),362(85,95))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\SolveCollision.spd(2),482(85,50))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\SolveCollision.spd(2),518(90,15))*/
endconnection Solv1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\SolveCollision.spd,4)*/
endprocedure SolveCollision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd,4)*/
procedure isCollision
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd,1)*/
; 
returns  tCollision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(1),143(105,10))*/
dcl
  MyShipNextState, OtherShipNextState tShipCurrentState,
  NextPoint tCoordinates, 
  NextHead tHeading,
  IncX, IncY, i, Deep, maxDeep Integer, 
  flag  Real := 1,
  MyShipType tNameShip;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(1),116(75,10))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(1),146(75,25))*/
task {/*#E*/ 
 
MyShipNextState := 
call NextShipState(index);   
NextHead := 
MyShipNextState!Heading;
MyShipType :=
ShipsCurrState(index)!TypeShip;  
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(1),1745(75,50))*/
decision /*#E*/ 
NextHead;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(1),1748(27,55))*/
(NORTH):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(1),1742(15,60))*/
task {/*#E*/ 
IncX:=0;
IncY:=1;};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(1),1817(147,55))*/
(NORTH_WEST):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(1),1691(135,60))*/
task {/*#E*/ 
 
IncX:=-1;
IncY:=1;
flag:=sqrt2;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(1),1793(45,67))*/
(EAST):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(1),1703(30,75))*/
task {/*#E*/ 
IncX:=1;
IncY:=0;};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(1),1805(142,75))*/
(SOUTH_WEST):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(1),1697(120,75))*/
task {/*#E*/ 
 
IncX:=-1;
IncY:=-1;
flag:=sqrt2;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(1),1811(60,82))*/
(WEST):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(1),1694(45,90))*/
task {/*#E*/ 
IncX:=-1;
IncY:=0;};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(1),1787(130,90))*/
(NORTH_EAST):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(1),1706(105,90))*/
task {/*#E*/ 
 
IncX:=1;
IncY:=1;
flag:=sqrt2;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(1),1799(72,97))*/
(SOUTH):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(1),1700(60,105))*/
task {/*#E*/ 
IncX:=0;
IncY:=-1;};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(1),2009(112,105))*/
(SOUTH_EAST):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(1),1688(90,105))*/
task {/*#E*/ 
 
IncX:=1;
IncY:=-1;
flag:=sqrt2;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(1),1745(75,50))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(1),1739(75,125))*/
task {/*#E*/ 
 
NextPoint := ShipsCurrState(index)!Coordinates;
i := 1;
maxDeep := d2i(ShipsCharacter(MyShipType)!MaxDeep);
};
grst1084_1:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(1),2012(75,140))*/
decision /*#E*/ 
 
/*      2  */
 i<=fix(2*float(MyShipNextState!Speed)/flag)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(1),2048(87,150))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(1),2042(75,155))*/
decision /*#E*/ 
 
(NextPoint!x + IncX < 0) OR 
(NextPoint!y + IncY < 0) OR
(NextPoint!x + IncX > MaxXCoordinate) OR 
(NextPoint!y + IncY > MaxYCoordinate)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(1),2054(70,155))*/
(true):
grst1084_2:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(1),1709(45,165))*/
join /*#E*/ 
P1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(1),2051(87,167))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(1),1733(75,175))*/
task {/*#E*/ 
 
NextPoint!x := NextPoint!x + IncX;
NextPoint!y := NextPoint!y + IncY;
Deep := call getDeepXY(NextPoint!x,NextPoint!y);
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(1),1727(75,190))*/
decision /*#E*/ 
 
Deep < maxDeep
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(1),1769(70,190))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(1),1721(45,200))*/
return /*#E*/ 
LAND_COLLISION;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(1),1772(87,200))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(1),1718(75,210))*/
task {/*#E*/ 
i := i+1;};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(1),1727(75,190))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(1),2012(75,140))*/
join /*#E*/ 
grst1084_1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(1),2042(75,155))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(1),2030(70,140))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(1),1709(45,165))*/
join /*#E*/ 
grst1084_2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(1),2012(75,140))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(2),509(75,5))*/
connection /*#E*/ 
P1:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(2),1961(70,20))*/
decision /*#E*/ 
 
NumVisibleShips = 0
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(2),1967(82,30))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(2),539(70,35))*/
task {/*#E*/ 
i := 1;};
grst1084_3:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(2),533(70,50))*/
task {/*#E*/ 
 
NextPoint := call NextPosition(EnemyShips(i)!Coordinates,
EnemyShips(i)!Heading, EnemyShips(i)!Speed, 
EnemyShips(i)!TypeShip);
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(2),530(70,65))*/
decision /*#E*/ 
 
NextPoint = MyShipNextState!Coordinates
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(2),554(67,65))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(2),524(30,75))*/
return /*#E*/ 
ENEMY_SHIP_COLLISION;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(2),557(82,77))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(2),521(70,85))*/
task {/*#E*/ 
i := i+1;};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(2),518(70,100))*/
decision /*#E*/ 
 
 i <= NumVisibleShips
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(2),563(65,100))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(2),533(70,50))*/
join /*#E*/ 
grst1084_3;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(2),1958(82,110))*/
(false):
grst1084_4:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(2),1919(70,115))*/
task {/*#E*/ 
i := 1;};
grst1084_5:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(2),1916(70,130))*/
decision /*#E*/ 
index = i;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(2),1925(82,140))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(2),1913(70,145))*/
task {/*#E*/ 
 
OtherShipNextState := 
call NextShipState(i);
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(2),1907(70,160))*/
decision /*#E*/ 
 
OtherShipNextState!Coordinates = 
MyShipNextState!Coordinates
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(2),1940(65,160))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(2),1901(35,170))*/
return /*#E*/ 
MY_SHIP_COLLISION;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(2),1943(82,172))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(2),1907(70,160))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(2),1928(65,135))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(2),1916(70,130))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(2),1898(70,185))*/
task {/*#E*/ 
i := i+1;};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(2),1895(70,200))*/
decision /*#E*/ 
 
 i <= NumMyShips
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(2),1949(67,200))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(2),1955(82,210))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(2),1889(75,215))*/
return /*#E*/ 
NO_COLLISION;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(2),1895(70,200))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(2),1916(70,130))*/
join /*#E*/ 
grst1084_5;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(2),518(70,100))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(2),530(70,65))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(2),1976(62,20))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(2),1919(70,115))*/
join /*#E*/ 
grst1084_4;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(2),1961(70,20))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd(2),509(75,5))*/
endconnection P1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\isCollision.spd,4)*/
endprocedure isCollision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NewHeading.spd,4)*/
procedure NewHeadingChange
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NewHeading.spd,1)*/
; fpar
    in OurShCurrState tShipCurrentState,
    TargetPoint tCoordinates;
 returns ReturnDirect tTurnDirection;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NewHeading.spd(1),332(10,35))*/
newtype tCos
   Array(Integer, Real);
endnewtype;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NewHeading.spd(1),326(10,55))*/
 dcl
   NextHding tHeading,
   RightPoint, LeftPoint,  StraightPoint tCoordinates,
   i, indx  Integer,
   min Real,
   Cos tCos,
   CurrSpeed tSCMaxSpeed;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NewHeading.spd(1),329(100,35))*/
procedure /*#E*/ 
CosBetweenVectors referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NewHeading.spd(2),116(25,35))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NewHeading.spd(2),131(25,55))*/
task {/*#E*/ 
 
CurrSpeed := OurShCurrState!Speed;
if (CurrSpeed = 0) CurrSpeed :=  CurrSpeed+2;
NextHding := call NextDirection(
OurShCurrState!Heading,RIGHT);
RightPoint := call NextPosition(
OurShCurrState!Coordinates, NextHding, CurrSpeed, OurShCurrState!TypeShip);
 NextHding := call NextDirection(OurShCurrState!Heading,LEFT);
LeftPoint := call NextPosition(
OurShCurrState!Coordinates, NextHding, CurrSpeed, OurShCurrState!TypeShip);
StraightPoint :=call NextPosition
(OurShCurrState!Coordinates, OurShCurrState!Heading, CurrSpeed, OurShCurrState!TypeShip);
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NewHeading.spd(2),146(25,100))*/
task {/*#E*/ 
 
Cos(1) := call CosBetweenVectors(OurShCurrState!Coordinates, RightPoint, TargetPoint);
Cos(2) := call CosBetweenVectors(OurShCurrState!Coordinates, LeftPoint, TargetPoint);
Cos(3) := call CosBetweenVectors(OurShCurrState!Coordinates, StraightPoint, TargetPoint);
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NewHeading.spd(2),164(25,115))*/
task {/*#E*/ 
 
min := Cos(1);
indx := 1;
for( i :=2, i<=3, i+1){
  if (Cos(i) > min) {
     min := Cos(i);
     indx := i;
  }
} 
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NewHeading.spd(2),233(25,145))*/
task {/*#E*/ 
 
if (indx = 1) ReturnDirect:=RIGHT;
else {
if (indx = 2) ReturnDirect:=LEFT;
 else ReturnDirect:=STRAIGHT;
}
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NewHeading.spd(2),119(30,165))*/
return /*#E*/ 
ReturnDirect;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NewHeading.spd,4)*/
endprocedure NewHeadingChange;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\CosBetweenVectors.spd,4)*/
procedure CosBetweenVectors
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\CosBetweenVectors.spd,1)*/
; fpar
  in StartPoint, EndPoint1, EndPoint2 tCoordinates; 
returns Cos Real;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\CosBetweenVectors.spd(1),116(40,30))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\CosBetweenVectors.spd(1),185(40,45))*/
decision /*#E*/ 
 
(StartPoint = EndPoint1) OR (StartPoint = EndPoint2)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\CosBetweenVectors.spd(1),203(37,45))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\CosBetweenVectors.spd(1),200(5,55))*/
task {/*#E*/ 
Cos := -2;};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\CosBetweenVectors.spd(1),296(10,70))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\CosBetweenVectors.spd(1),215(52,55))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\CosBetweenVectors.spd(1),212(40,60))*/
decision /*#E*/ 
 
( (EndPoint1!x - StartPoint!x = 0) AND (EndPoint2!x - StartPoint!x =0) AND 
   ((EndPoint1!y - StartPoint!y)*(EndPoint2!y - StartPoint!y) > 0) )
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\CosBetweenVectors.spd(1),263(52,70))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\CosBetweenVectors.spd(1),260(40,75))*/
decision /*#E*/ 
 
( (EndPoint1!y - StartPoint!y = 0) AND (EndPoint2!y - StartPoint!y =0) AND 
   ((EndPoint1!x - StartPoint!x)*(EndPoint2!x - StartPoint!x) > 0) )
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\CosBetweenVectors.spd(1),278(52,87))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\CosBetweenVectors.spd(1),275(40,90))*/
decision /*#E*/ 
 
( (EndPoint1!y - StartPoint!y /= 0) AND (EndPoint2!y - StartPoint!y /=0)) AND
( (EndPoint1!x - StartPoint!x /= 0) AND (EndPoint2!x - StartPoint!x /=0)) AND
 ( float(EndPoint1!x - StartPoint!x)/float(EndPoint2!x - StartPoint!x) = 
   float(EndPoint1!y - StartPoint!y)/float(EndPoint2!y - StartPoint!y) )AND
 ( ((EndPoint1!x - StartPoint!x)*(EndPoint2!x - StartPoint!x) > 0) AND
    ((EndPoint1!y - StartPoint!y)*(EndPoint2!y - StartPoint!y) > 0) )
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\CosBetweenVectors.spd(1),290(32,97))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\CosBetweenVectors.spd(1),293(67,97))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\CosBetweenVectors.spd(1),146(55,115))*/
task {/*#E*/ 
 
Cos := float((EndPoint1!x - StartPoint!x)*(EndPoint2!x - StartPoint!x) 
                   + (EndPoint1!y - StartPoint!y)*(EndPoint2!y - StartPoint!y))/
float((call getDistance(StartPoint!x, StartPoint!y, EndPoint1!x, EndPoint1!y))*
         (call getDistance(StartPoint!x, StartPoint!y, EndPoint2!x, EndPoint2!y)));
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\CosBetweenVectors.spd(1),245(60,130))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\CosBetweenVectors.spd(1),275(40,90))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\CosBetweenVectors.spd(1),272(32,82))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\CosBetweenVectors.spd(1),260(40,75))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\CosBetweenVectors.spd(1),233(32,67))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\CosBetweenVectors.spd(1),212(40,60))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\CosBetweenVectors.spd(1),227(25,115))*/
task {/*#E*/ 
Cos := 2;};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\CosBetweenVectors.spd(1),119(30,130))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\CosBetweenVectors.spd(1),185(40,45))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\CosBetweenVectors.spd,4)*/
endprocedure CosBetweenVectors;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextDirection.spd,4)*/
procedure NextDirection
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextDirection.spd,1)*/
; fpar
  CurrHding tHeading,
  Dir tHeadingChange;
  returns NewHeading tHeading;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextDirection.spd(1),152(135,15))*/
dcl
   Numbr Integer;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextDirection.spd(1),149(70,20))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextDirection.spd(1),353(70,40))*/
task {/*#E*/ 
 
Numbr := h2i(CurrHding);
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextDirection.spd(1),209(70,60))*/
decision /*#E*/ 
Dir;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextDirection.spd(1),245(55,67))*/
(RIGHT):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextDirection.spd(1),239(55,75))*/
task {/*#E*/ 
 
Numbr := Numbr +1;
if (Numbr > 7) Numbr := 0;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextDirection.spd(1),242(97,67))*/
(LEFT):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextDirection.spd(1),236(85,75))*/
task {/*#E*/ 
 
Numbr := Numbr -1;
if (Numbr < 0) Numbr:= 7;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextDirection.spd(1),209(70,60))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextDirection.spd(1),368(70,95))*/
task {/*#E*/ 
 
NewHeading := i2h(Numbr);
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextDirection.spd(1),311(75,115))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextDirection.spd,4)*/
endprocedure NextDirection;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextPosition.spd,4)*/
procedure NextPosition
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextPosition.spd,1)*/
; fpar
  CurrPos tCoordinates,
  Direct tHeading,
  Speed tSCMaxSpeed,
  NameShip tNameShip;
  returns NextPos tCoordinates;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextPosition.spd(1),212(130,10))*/
dcl
  IncX, IncY, Deep, maxDeep Integer,
  flag Real := 1,
  i Integer := 1,
  onLand Boolean;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextPosition.spd(1),578(70,15))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextPosition.spd(1),494(70,35))*/
decision /*#E*/ 
Direct;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextPosition.spd(1),497(22,40))*/
(NORTH):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextPosition.spd(1),491(10,45))*/
task {/*#E*/ 
IncX:=0;
IncY:=1;};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextPosition.spd(1),515(147,40))*/
(NORTH_WEST):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextPosition.spd(1),473(135,45))*/
task {/*#E*/ 
 
IncX:=-1;
IncY:=1;
flag:=sqrt2;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextPosition.spd(1),503(37,52))*/
(EAST):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextPosition.spd(1),485(25,60))*/
task {/*#E*/ 
IncX:=1;
IncY:=0;};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextPosition.spd(1),509(137,60))*/
(SOUTH_WEST):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextPosition.spd(1),479(115,60))*/
task {/*#E*/ 
 
IncX:=-1;
IncY:=-1;
flag:=sqrt2;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextPosition.spd(1),512(52,67))*/
(WEST):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextPosition.spd(1),476(40,75))*/
task {/*#E*/ 
IncX:=-1;
IncY:=0;};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextPosition.spd(1),500(122,75))*/
(NORTH_EAST):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextPosition.spd(1),488(100,75))*/
task {/*#E*/ 
 
IncX:=1;
IncY:=1;
flag:=sqrt2;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextPosition.spd(1),506(67,82))*/
(SOUTH):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextPosition.spd(1),482(55,90))*/
task {/*#E*/ 
IncX:=0;
IncY:=-1;};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextPosition.spd(1),644(107,90))*/
(SOUTH_EAST):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextPosition.spd(1),470(85,90))*/
task {/*#E*/ 
 
IncX:=1;
IncY:=-1;
flag:=sqrt2;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextPosition.spd(1),494(70,35))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextPosition.spd(1),467(70,110))*/
task {/*#E*/ 
 
onLand := false;
NextPos := CurrPos;
maxDeep := d2i(ShipsCharacter(NameShip)!MaxDeep);
Deep := call getDeepXY(NextPos!x,NextPos!y);
if (Deep < maxDeep) onLand := true;
};
grst8929_1:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextPosition.spd(1),626(70,135))*/
decision /*#E*/ 
 
 i<=fix(float(Speed)/flag)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextPosition.spd(1),635(82,145))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextPosition.spd(1),455(70,150))*/
decision /*#E*/ 
 
(NextPos!x + IncX < 0) OR 
(NextPos!y + IncY < 0) OR
(NextPos!x + IncX > MaxXCoordinate) OR 
(NextPos!y + IncY > MaxYCoordinate) OR
( (Deep < maxDeep) AND (onLand = false) )
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextPosition.spd(1),692(65,150))*/
(true):
grst8929_2:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextPosition.spd(1),449(45,160))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextPosition.spd(1),617(82,162))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextPosition.spd(1),611(70,170))*/
task {/*#E*/ 
 
NextPos!x := NextPos!x + IncX;
NextPos!y := NextPos!y + IncY;
Deep := call getDeepXY(NextPos!x,NextPos!y);
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextPosition.spd(1),446(70,185))*/
task {/*#E*/ 
i := i+1;};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextPosition.spd(1),626(70,135))*/
join /*#E*/ 
grst8929_1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextPosition.spd(1),455(70,150))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextPosition.spd(1),695(65,135))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextPosition.spd(1),449(45,160))*/
join /*#E*/ 
grst8929_2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextPosition.spd(1),626(70,135))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextPosition.spd,4)*/
endprocedure NextPosition;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextShipState.spd,4)*/
procedure NextShipState
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextShipState.spd,1)*/
;fpar
   in ShipIndex Integer;
returns ShipNextState tShipCurrentState;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextShipState.spd(1),197(135,10))*/
dcl
   OldSpeed tSCMaxSpeed,
   OldHeading tHeading,
   OldCoords tCoordinates,
   TypeShp tNameShip,
   TempSpeed Integer;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextShipState.spd(1),119(60,25))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextShipState.spd(1),200(60,40))*/
task {/*#E*/ 
 
OldSpeed := ShipsCurrState(ShipIndex)!Speed;
OldHeading := ShipsCurrState(ShipIndex)!Heading;
OldCoords := ShipsCurrState(ShipIndex)!Coordinates;
TypeShp := ShipsCurrState(ShipIndex)!TypeShip;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextShipState.spd(1),155(60,60))*/
decision /*#E*/ 
 
CommandToShip(ShipIndex)!isSet
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextShipState.spd(1),161(72,72))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextShipState.spd(1),149(60,80))*/
decision /*#E*/ 
 
CommandToShip(ShipIndex)!OrderType
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextShipState.spd(1),167(85,90))*/
(_ACCEL):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextShipState.spd(1),143(75,95))*/
task {/*#E*/ 
 
TempSpeed := OldSpeed +
fix(float(ShipsCharacter(TypeShp)!_
MaxAcceleration)*Command_
ToShip(ShipIndex)!Accel);
if (TempSpeed < 0)  ShipNextState!Speed := 0;
if (TempSpeed > (ShipsCharacter(TypeShp)!MaxSpeed)) 
ShipNextState!Speed := ShipsCharacter(TypeShp)!MaxSpeed;
ShipNextState!Heading := OldHeading;
ShipNextState!Coordinates := call NextPosition
(OldCoords, OldHeading, ShipNextState!Speed, 
ShipNextState!TypeShip);
};
grst3624_1:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextShipState.spd(1),215(80,205))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextShipState.spd(1),173(72,130))*/
(_RIGHT):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextShipState.spd(1),137(60,135))*/
task {/*#E*/ 
 
ShipNextState!Speed := OldSpeed;
ShipNextState!Heading := call NextDirection(
OldHeading, RIGHT);
ShipNextState!Coordinates := call NextPosition(
OldCoords,ShipNextState!Heading, OldSpeed, 
ShipNextState!TypeShip);
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextShipState.spd(1),215(80,205))*/
join /*#E*/ 
grst3624_1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextShipState.spd(1),179(57,155))*/
(_LEFT):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextShipState.spd(1),131(45,160))*/
task {/*#E*/ 
 
ShipNextState!Speed := OldSpeed;
ShipNextState!Heading := call NextDirection(
OldHeading, LEFT);
ShipNextState!Coordinates := call NextPosition(
OldCoords,ShipNextState!Heading, OldSpeed, 
ShipNextState!TypeShip);
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextShipState.spd(1),215(80,205))*/
join /*#E*/ 
grst3624_1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextShipState.spd(1),185(42,180))*/
else:
grst3624_2:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextShipState.spd(1),125(30,185))*/
task {/*#E*/ 
 
ShipNextState!Speed := OldSpeed;
ShipNextState!Heading := OldHeading;
ShipNextState!Coordinates := call NextPosition(
OldCoords,OldHeading, OldSpeed, ShipNextState!TypeShip);
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextShipState.spd(1),215(80,205))*/
join /*#E*/ 
grst3624_1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextShipState.spd(1),149(60,80))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextShipState.spd(1),191(55,60))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextShipState.spd(1),125(30,185))*/
join /*#E*/ 
grst3624_2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextShipState.spd(1),155(60,60))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\NextShipState.spd,4)*/
endprocedure NextShipState;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyNotFound.spd,4)*/
procedure EnemyNotFound
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyNotFound.spd,1)*/
; fpar
  in/out ShCurrSt tShipCurrentState,
  in k Integer;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyNotFound.spd(1),902(125,5))*/
dcl
   ChangeDirection tTurnDirection,
   accel Integer,
   ShipName tNameShip,
   MaxAccel tSCMaxAcceleration,
   factorAccel tFactorAcceleration;
   
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyNotFound.spd(1),116(60,20))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyNotFound.spd(1),338(60,40))*/
task {/*#E*/ 
 
ChangeDirection := 
 call NewHeadingChange(ShCurrSt,HeadingTarget);
ShipName := ShCurrSt!TypeShip;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyNotFound.spd(1),554(60,65))*/
decision /*#E*/ 
 
ChangeDirection
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyNotFound.spd(1),845(40,72))*/
(RIGHT):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyNotFound.spd(1),842(40,80))*/
task {/*#E*/ 
 
CommandTo_
Ship(k)!_
OrderType := 
_RIGHT;
CommandTo_
Ship(k)!is_
Set := true;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyNotFound.spd(1),872(45,95))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyNotFound.spd(1),911(97,72))*/
(LEFT):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyNotFound.spd(1),854(85,80))*/
task {/*#E*/ 
 
CommandTo_
Ship(k)!_
OrderType :=
 _LEFT;
CommandTo_
Ship(k)!is_
Set := true; 
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyNotFound.spd(1),905(90,95))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyNotFound.spd(1),914(72,75))*/
else:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyNotFound.spd(1),734(60,110))*/
decision /*#E*/ 
 
ShCurrSt!Speed = minSpeed
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyNotFound.spd(1),920(72,120))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyNotFound.spd(1),755(60,125))*/
task {/*#E*/ 
 
MaxAccel := ShipsCharacter(
ShipName)!MaxAcceleration;
accel := minSpeed - ShCurrSt!Speed;
if (float(accel)/float(MaxAccel) <= -1)  factorAccel := -1;
else {
  if (float(accel)/float(MaxAccel) >= 1)  factorAccel := 1;
  else factorAccel := float(accel)/float(MaxAccel);
}
CommandTo_
Ship(index)!OrderType := _ACCEL;
CommandToShip(k)!Accel := factorAccel;
CommandToShip(k)!isSet := true;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyNotFound.spd(1),917(55,110))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyNotFound.spd(1),734(60,110))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyNotFound.spd(1),878(65,145))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyNotFound.spd(1),554(60,65))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyNotFound.spd,4)*/
endprocedure EnemyNotFound;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd,4)*/
procedure EnemyFound
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd,1)*/
; fpar
  in/out ShCurrSt tShipCurrentState,
  in k Integer;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(1),449(10,30))*/
newtype tShootWeaponry
struct
   TypeWeaponry tNameWeaponry;
   isWeaponry Boolean;
endnewtype;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(1),452(10,55))*/
newtype tShootList
struct
   SortParam Real;
   Number Integer;
endnewtype;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(1),455(10,80))*/
newtype tStringShootList
  String(tShootList,empty);
endnewtype;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(1),170(10,95))*/
dcl
   MaxPointsToShoot, NumPointsToShoot,i,j Integer,
   DistBetweenShips Integer,
   NextHeading tTurnDirection,
   CanShootWeaponry tShootWeaponry,
   BestWeaponry tNameWeaponry,
   ShootPoint, Temp tShootList,
   ShootList tStringShootList,
   PointToOrder tCoordinates,
   DestroyFlag Boolean := false;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(1),173(85,30))*/
procedure /*#E*/ 
ActivateREPAIR referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(1),206(85,45))*/
procedure /*#E*/ 
CanShootEnemyCenter referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(1),578(85,60))*/
procedure /*#E*/ 
SortShootList referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(2),116(85,15))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(2),146(85,35))*/
decision /*#E*/ 
 
ShCurrSt!TypeShip
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(2),725(72,47))*/
(REPAIR_BOAT):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(2),665(60,55))*/
task {/*#E*/ 
 
for (i:=1, i<=NumMyShips, i+1) {
     if (ShipsCurrState(i)!Resource < 
         ShipsCharacter
         (ShipsCurrState(i)!_
         TypeShip)!MaxResource) {
         DestroyFlag := true;
         break; 
     }
}
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(2),626(60,100))*/
decision /*#E*/ 
 
(ShCurrSt!_
Ammunition
(REPAIR) /= 0) AND
(DestroyFlag = true) AND
(NumMyShips > 1)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(2),875(82,100))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(2),182(90,115))*/
call /*#E*/ 
 
ActivateREPAIR
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(2),653(95,130))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(2),872(72,110))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(2),827(60,145))*/
decision /*#E*/ 
 
NumMyShips = 1
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(2),869(65,155))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(2),692(45,160))*/
task /*#E*/ 
 
NextHeading := call
NewHeadingChange( 
ShCurrSt,MyCenter)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(2),866(77,155))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(2),851(75,160))*/
task /*#E*/ 
 
NextHeading := call
NewHeadingChange(ShCurrSt,
EnemyCenter)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(2),827(60,145))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(2),845(65,180))*/
join /*#E*/ 
F2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(2),626(60,100))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(2),233(117,45))*/
else:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(2),230(115,50))*/
task /*#E*/ 
 
CanShootWeaponry := 
call CanShootEnemyCenter
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(2),239(115,65))*/
decision /*#E*/ 
 
CanShootWeaponry!isWeaponry
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(2),251(115,65))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(2),248(95,75))*/
join /*#E*/ 
F1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(2),650(127,77))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(2),257(115,85))*/
task /*#E*/ 
 
NextHeading := call
NewHeadingChange(ShCurrSt,
EnemyCenter)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(2),821(120,100))*/
join /*#E*/ 
F2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(2),239(115,65))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(2),146(85,35))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(3),815(85,25))*/
connection /*#E*/ 
F2:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(3),773(80,45))*/
decision /*#E*/ 
 
NextHeading
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(3),779(95,57))*/
(LEFT):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(3),767(80,65))*/
task {/*#E*/ 
 
CommandToShip(k)!_
OrderType := _LEFT;
CommandToShip(k)!isSet := true;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(3),788(72,57))*/
(RIGHT):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(3),758(60,80))*/
task {/*#E*/ 
 
CommandToShip(k)!_
OrderType := _RIGHT;
CommandToShip(k)!isSet := true;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(3),797(62,57))*/
else:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(3),752(45,105))*/
decision /*#E*/ 
 
ShCurrSt!Speed = 
ShipsCharacter_
(ShCurrSt!TypeShip)!_
MaxSpeed 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(3),803(65,105))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(3),746(65,125))*/
task {/*#E*/ 
 
CommandToShip(k)!_
OrderType := _ACCEL;
CommandToShip(k)!Accel := 1;
CommandToShip(k)!isSet := true;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(3),812(47,117))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(3),752(45,105))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(3),740(50,140))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(3),773(80,45))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(3),761(85,95))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(3),815(85,25))*/
endconnection F2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(4),284(70,5))*/
connection /*#E*/ 
F1:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(4),389(65,20))*/
decision /*#E*/ 
 
ShCurrSt!Speed = 0
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(4),722(77,30))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(4),401(65,35))*/
task {/*#E*/ 
 
CommandToShip(k)!OrderType := _ACCEL;  
CommandToShip(k)!Accel := -1;
CommandToShip(k)!isSet := true;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(4),416(70,50))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(4),575(57,25))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(4),521(15,65))*/
task {/*#E*/ 
 
BestWeaponry := CanShootWeaponry!TypeWeaponry;
if (ShipsCharacter(ShCurrSt!TypeShip)!MaxLaunchUnit(BestWeaponry) < 
    ShCurrSt!Ammunition(BestWeaponry))
    MaxPointsToShoot :=  ShipsCharacter(ShCurrSt!TypeShip)!_
                                            MaxLaunchUnit(BestWeaponry);
else 
    MaxPointsToShoot := ShCurrSt!Ammunition(BestWeaponry);
for (i:=1, i<=NumVisibleShips, i+1) {
     DistBetweenShips := call
     getDistance(ShCurrSt!Coordinates!x,ShCurrSt!Coordinates!y,
     EnemyShips(i)!Coordinates!x,EnemyShips(i)!Coordinates!y);
     if (WeaponryCharacter(BestWeaponry)!Range >= DistBetweenShips) {
         ShootPoint!SortParam := float(DistBetweenShips);
         ShootPoint!Number := i;
         ShootList := ShootList // mkstring(ShootPoint);
     }
}
call SortShootList;
if (length(ShootList) > MaxPointsToShoot) NumPointsToShoot := MaxPointsToShoot;
else NumPointsToShoot := length(ShootList);
CommandToShip(k)!OrderType := _FIRE;
CommandToShip(k)!Fire!Weapon := BestWeaponry;
for (i:=1, i<=NumPointsToShoot, i+1) {
  PointToOrder := call NextPosition(EnemyShips(ShootList(i)!Number)!Coordinates, 
                                                               EnemyShips(ShootList(i)!Number)!Heading, 
                                                               EnemyShips(ShootList(i)!Number)!Speed, 
                                                               EnemyShips(ShootList(i)!Number)!TypeShip);
  CommandToShip(k)!Fire!List := CommandToShip(k)!Fire!List // mkstring(PointToOrder);
}
CommandToShip(k)!isSet := true;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(4),281(20,85))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(4),389(65,20))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd(4),284(70,5))*/
endconnection F1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\EnemyFound.spd,4)*/
endprocedure EnemyFound;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\ActivateREPAIR.spd,4)*/
procedure ActivateREPAIR;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\ActivateREPAIR.spd(1),1232(135,10))*/
dcl
   NextShipSt tShipCurrentState;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\ActivateREPAIR.spd(1),116(25,10))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\ActivateREPAIR.spd(1),125(25,25))*/
task {/*#E*/ 
 
for (i:=1, i<=NumMyShips, i+1) {
     DistBetweenShips :=  call
     getDistance(ShCurrSt!Coordinates!x,ShCurrSt!Coordinates!y,
     ShipsCurrState(i)!Coordinates!x,ShipsCurrState(i)!Coordinates!y);
     if ((WeaponryCharacter(REPAIR)!Range >= DistBetweenShips) AND
         (ShipsCurrState(i)!Resource < 
          ShipsCharacter(ShipsCurrState(i)!TypeShip)!MaxResource)) {
          ShootPoint!SortParam := 
          float(ShipsCurrState(i)!Resource)/float(ShipsCharacter(ShipsCurrState(i)!TypeShip)!_
          MaxResource);
          ShootPoint!Number := i;
          ShootList := ShootList // mkstring(ShootPoint);
     }
}
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\ActivateREPAIR.spd(1),137(25,80))*/
decision /*#E*/ 
 
length(ShootList) = 0
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\ActivateREPAIR.spd(1),1265(37,90))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\ActivateREPAIR.spd(1),1247(25,95))*/
decision /*#E*/ 
 
ShCurrSt!Speed = 0
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\ActivateREPAIR.spd(1),1253(52,105))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\ActivateREPAIR.spd(1),1241(40,110))*/
task {/*#E*/ 
 
CommandToShip(k)!OrderType := _ACCEL;  
CommandToShip(k)!Accel := -1;
CommandToShip(k)!isSet := true;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\ActivateREPAIR.spd(1),1271(45,125))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\ActivateREPAIR.spd(1),1268(27,105))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\ActivateREPAIR.spd(1),1049(25,140))*/
call /*#E*/ 
 
SortShootList
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\ActivateREPAIR.spd(1),1067(25,155))*/
task {/*#E*/ 
 
if (ShipsCharacter(REPAIR_BOAT)!MaxLaunchUnit(REPAIR) < 
    ShCurrSt!Ammunition(REPAIR))
    MaxPointsToShoot :=  ShipsCharacter(REPAIR_BOAT)!_
                                            MaxLaunchUnit(REPAIR);
else 
    MaxPointsToShoot := ShCurrSt!Ammunition(REPAIR);
if (length(ShootList) > MaxPointsToShoot) NumPointsToShoot := MaxPointsToShoot;
else NumPointsToShoot := length(ShootList);
CommandToShip(k)!OrderType := _FIRE;
CommandToShip(k)!Fire!Weapon := REPAIR;
for (i:=1, i<=NumPointsToShoot, i+1) {
  NextShipSt := call NextShipState(ShootList(i)!Number);
  PointToOrder := NextShipSt!Coordinates;
  CommandToShip(k)!Fire!List := CommandToShip(k)!Fire!List // mkstring(PointToOrder);
}
CommandToShip(k)!isSet := true;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\ActivateREPAIR.spd(1),1247(25,95))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\ActivateREPAIR.spd(1),1088(22,80))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\ActivateREPAIR.spd(1),1085(10,110))*/
join /*#E*/ 
R1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\ActivateREPAIR.spd(1),137(25,80))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\ActivateREPAIR.spd(1),1091(10,185))*/
R2:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\ActivateREPAIR.spd(1),119(30,200))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\ActivateREPAIR.spd(2),188(55,10))*/
connection /*#E*/ 
R1:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\ActivateREPAIR.spd(2),1097(50,30))*/
task {/*#E*/ 
 
ShootList := empty;
for (i:=1, i<=NumMyShips, i+1) {
     DistBetweenShips := call
     getDistance(ShCurrSt!Coordinates!x,ShCurrSt!Coordinates!y,
     ShipsCurrState(i)!Coordinates!x,ShipsCurrState(i)!Coordinates!y);
     if (ShipsCurrState(i)!Resource < 
         ShipsCharacter(ShipsCurrState(i)!TypeShip)!MaxResource) {
         ShootPoint!SortParam := 
         float(ShipsCurrState(i)!Resource)/float(ShipsCharacter(
                  ShipsCurrState(i)!TypeShip)!MaxResource);
         ShootPoint!Number := i;
         ShootList := ShootList // mkstring(ShootPoint);
     }
}
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\ActivateREPAIR.spd(2),1214(50,85))*/
call /*#E*/ 
 
SortShootList
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\ActivateREPAIR.spd(2),1151(50,100))*/
task {/*#E*/ 
 
NextHeading := call
NewHeadingChange(ShCurrSt,
ShipsCurrState(ShootList(1)!Number)!Coordinates);
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\ActivateREPAIR.spd(2),1145(50,115))*/
decision /*#E*/ 
 
NextHeading
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\ActivateREPAIR.spd(2),1163(65,127))*/
(LEFT):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\ActivateREPAIR.spd(2),1139(50,135))*/
task {/*#E*/ 
 
CommandToShip(k)!OrderType := _LEFT;
CommandToShip(k)!isSet := true;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\ActivateREPAIR.spd(2),1166(42,127))*/
(RIGHT):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\ActivateREPAIR.spd(2),1133(30,150))*/
task {/*#E*/ 
 
CommandToShip(k)!OrderType := _RIGHT;
CommandToShip(k)!isSet := true;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\ActivateREPAIR.spd(2),1169(32,127))*/
else:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\ActivateREPAIR.spd(2),1121(15,175))*/
decision /*#E*/ 
 
ShCurrSt!Speed = 
ShipsCharacter(REPAIR_BOAT)!MaxSpeed 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\ActivateREPAIR.spd(2),1187(40,175))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\ActivateREPAIR.spd(2),1118(45,190))*/
task {/*#E*/ 
 
CommandToShip(k)!OrderType := _ACCEL;
CommandToShip(k)!Accel := 1;
CommandToShip(k)!isSet := true;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\ActivateREPAIR.spd(2),1205(27,187))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\ActivateREPAIR.spd(2),1121(15,175))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\ActivateREPAIR.spd(2),191(20,205))*/
join /*#E*/ 
R2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\ActivateREPAIR.spd(2),1145(50,115))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\ActivateREPAIR.spd(2),1127(55,165))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\ActivateREPAIR.spd(2),188(55,10))*/
endconnection R1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\ActivateREPAIR.spd,4)*/
endprocedure ActivateREPAIR;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\CanShootEnemyCenter.spd,4)*/
procedure CanShootEnemyCenter
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\CanShootEnemyCenter.spd,1)*/
; 
returns Weapon  tShootWeaponry;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\CanShootEnemyCenter.spd(1),209(150,5))*/
dcl
   Dist Integer; 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\CanShootEnemyCenter.spd(1),116(75,10))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\CanShootEnemyCenter.spd(1),197(75,25))*/
task /*#E*/ 
 
Dist := call getDistance(ShCurrSt!Coordinates!x,
ShCurrSt!Coordinates!y, EnemyCenter!x,EnemyCenter!y)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\CanShootEnemyCenter.spd(1),137(75,40))*/
decision /*#E*/ 
 
(ShCurrSt!Ammunition(MISSILE) /= 0) AND
(WeaponryCharacter(MISSILE)!Range >= Dist)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\CanShootEnemyCenter.spd(1),218(72,40))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\CanShootEnemyCenter.spd(1),215(50,50))*/
task {/*#E*/ 
 
Weapon!TypeWeaponry := 
   MISSILE;
Weapon!isWeaponry := 
   true;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\CanShootEnemyCenter.spd(1),149(55,65))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\CanShootEnemyCenter.spd(1),158(87,52))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\CanShootEnemyCenter.spd(1),155(75,75))*/
decision /*#E*/ 
 
ShCurrSt!Ammunition(TORPEDO) /= 0 AND
(WeaponryCharacter(TORPEDO)!Range >= Dist)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\CanShootEnemyCenter.spd(1),245(72,75))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\CanShootEnemyCenter.spd(1),233(50,85))*/
task {/*#E*/ 
 
Weapon!TypeWeaponry := 
  TORPEDO;
Weapon!isWeaponry := 
  true;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\CanShootEnemyCenter.spd(1),230(55,100))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\CanShootEnemyCenter.spd(1),179(87,87))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\CanShootEnemyCenter.spd(1),176(75,110))*/
decision /*#E*/ 
 
(ShCurrSt!Ammunition(SHELL) /= 0) AND
(WeaponryCharacter(SHELL)!Range >= Dist)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\CanShootEnemyCenter.spd(1),296(72,110))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\CanShootEnemyCenter.spd(1),281(50,120))*/
task {/*#E*/ 
 
Weapon!TypeWeaponry := 
  SHELL;
Weapon!isWeaponry := 
  true;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\CanShootEnemyCenter.spd(1),278(55,135))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\CanShootEnemyCenter.spd(1),302(87,122))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\CanShootEnemyCenter.spd(1),299(75,130))*/
task {/*#E*/ 
 
Weapon!isWeaponry :=  false;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\CanShootEnemyCenter.spd(1),119(80,150))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\CanShootEnemyCenter.spd(1),176(75,110))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\CanShootEnemyCenter.spd(1),155(75,75))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\CanShootEnemyCenter.spd(1),137(75,40))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\CanShootEnemyCenter.spd,4)*/
endprocedure CanShootEnemyCenter;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\SortShootList.spd,4)*/
procedure SortShootList;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\SortShootList.spd(1),116(55,20))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\SortShootList.spd(1),122(55,35))*/
task {/*#E*/ 
 
for (i:=1, i<=length(ShootList)-1, i+1) {
  for (j := length(ShootList), j>=i+1, j-1) {
     if (ShootList(j)!SortParam <  ShootList(j-1)!SortParam) {
             Temp := ShootList(j-1);
             ShootList(j-1) := ShootList(j);
             ShootList(j) := Temp;
     }
  }
  for (j := i+1, j<=length(ShootList)-1, j+1) {
     if (ShootList(j)!SortParam >  ShootList(j+1)!SortParam) {
             Temp := ShootList(j+1);
             ShootList(j+1) := ShootList(j);
             ShootList(j) := Temp;
     }          
  }
}
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\SortShootList.spd(1),119(60,65))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\SortShootList.spd,4)*/
endprocedure SortShootList;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\OutputOrder.spd,4)*/
procedure OutputOrder;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\OutputOrder.spd(1),116(60,20))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\OutputOrder.spd(1),272(60,40))*/
decision /*#E*/ 
 
CommandToShip(index)!isSet
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\OutputOrder.spd(1),356(57,40))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\OutputOrder.spd(1),353(25,50))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\OutputOrder.spd(1),287(72,52))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\OutputOrder.spd(1),263(60,65))*/
decision /*#E*/ 
 
CommandToShip(index)!OrderType
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\OutputOrder.spd(1),293(92,77))*/
(_LEFT):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\OutputOrder.spd(1),257(80,85))*/
output /*#E*/ 
 
OrderTurnRequest(
ShipsCurrState(index)!ShipId, StrategyID, LEFT)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\OutputOrder.spd(1),329(85,100))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\OutputOrder.spd(1),302(72,107))*/
(_RIGHT):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\OutputOrder.spd(1),248(60,115))*/
output /*#E*/ 
 
OrderTurnRequest(
ShipsCurrState(index)!ShipId, StrategyID, RIGHT)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\OutputOrder.spd(1),341(65,130))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\OutputOrder.spd(1),311(52,137))*/
(_ACCEL):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\OutputOrder.spd(1),239(40,145))*/
output /*#E*/ 
 
OrderSpeedRequest(ShipsCurrState(index)!ShipId, StrategyID,
CommandToShip(index)!Accel)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\OutputOrder.spd(1),332(45,160))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\OutputOrder.spd(1),320(35,167))*/
(_FIRE):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\OutputOrder.spd(1),230(20,175))*/
output /*#E*/ 
 
OrderFireRequest(ShipsCurrState(index)!ShipId, StrategyID,
CommandToShip(index)!Fire!Weapon,CommandToShip(index)!Fire!List)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\OutputOrder.spd(1),338(25,190))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\OutputOrder.spd(1),263(60,65))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\OutputOrder.spd(1),272(60,40))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\OutputOrder.spd,4)*/
endprocedure OutputOrder;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\FindStartPoint.spd,4)*/
procedure FindStartPoint;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\FindStartPoint.spd,1)*/
 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\FindStartPoint.spd(1),137(135,5))*/
newtype Dist 
   Array(Integer,Integer)
endnewtype;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\FindStartPoint.spd(1),143(135,20))*/
dcl 
   d Dist,
   count, i, min Integer;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\FindStartPoint.spd(1),128(30,25))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\FindStartPoint.spd(1),125(30,40))*/
task {/*#E*/ 
 
d(1) := call getDistance(MyCenter!x,MyCenter!y,FirstQuaterX, FirstQuaterY);
d(2) := call getDistance(MyCenter!x,MyCenter!y,SecondQuaterX, SecondQuaterY);
d(3) := call getDistance(MyCenter!x,MyCenter!y,ThirdQuaterX, ThirdQuaterY);
d(4) := call getDistance(MyCenter!x,MyCenter!y,FourthQuaterX, FourthQuaterY);
min := d(1); count:=1;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\FindStartPoint.spd(1),353(30,60))*/
task {/*#E*/ 
 
for (i:=2,i<=4,i+1){
 if (d(i)<=min) {
   min := d(i);
   count := i; } 
}
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\FindStartPoint.spd(1),308(30,80))*/
decision /*#E*/ 
count;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\FindStartPoint.spd(1),332(72,85))*/
(4):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\FindStartPoint.spd(1),305(60,90))*/
task {/*#E*/ 
 
HeadingTarget !x:= FourthQuaterX;
HeadingTarget !y:= FourthQuaterY;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\FindStartPoint.spd(1),329(57,90))*/
(3):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\FindStartPoint.spd(1),299(45,105))*/
task {/*#E*/ 
 
HeadingTarget !x:= ThirdQuaterX;
HeadingTarget !y:= ThirdQuaterY;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\FindStartPoint.spd(1),326(42,90))*/
(2):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\FindStartPoint.spd(1),293(30,120))*/
task {/*#E*/ 
 
HeadingTarget !x:= SecondQuaterX;
HeadingTarget !y:= SecondQuaterY;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\FindStartPoint.spd(1),323(27,90))*/
(1):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\FindStartPoint.spd(1),287(15,135))*/
task {/*#E*/ 
 
HeadingTarget !x:= FirstQuaterX;
HeadingTarget !y:= FirstQuaterY;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\FindStartPoint.spd(1),308(30,80))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\FindStartPoint.spd(1),245(35,150))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\FindStartPoint.spd,4)*/
endprocedure FindStartPoint;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\SearchHeadingTarget.spd,4)*/
procedure FindHeadingTarget;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\SearchHeadingTarget.spd(1),116(55,25))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\SearchHeadingTarget.spd(1),137(55,50))*/
task {/*#E*/ 
 
if ((HeadingTarget!x = FirstQuaterX) AND 
    (HeadingTarget!y = FirstQuaterY)) {
      HeadingTarget!x :=  SecondQuaterX;
      HeadingTarget!y :=  SecondQuaterY;
} 
else {
  if ((HeadingTarget!x = SecondQuaterX) AND 
    (HeadingTarget!y = SecondQuaterY)) {
      HeadingTarget!x :=  ThirdQuaterX;
      HeadingTarget!y :=  ThirdQuaterY;
  } 
  else { 
    if ((HeadingTarget!x = ThirdQuaterX) AND 
        (HeadingTarget!y = ThirdQuaterY)) {
         HeadingTarget!x :=  FourthQuaterX;
         HeadingTarget!y :=  FourthQuaterY;
    }  
    else 
     if ((HeadingTarget!x = FourthQuaterX) AND 
         (HeadingTarget!y = FourthQuaterY)) {
          HeadingTarget!x :=  FirstQuaterX;
          HeadingTarget!y :=  FirstQuaterY;
     }
  }
}
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\SearchHeadingTarget.spd(1),119(60,130))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\SearchHeadingTarget.spd,4)*/
endprocedure FindHeadingTarget;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\OnLand.spd,4)*/
procedure OnLand
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\OnLand.spd,1)*/
;fpar
  in MyLandShip tShipCurrentState,
  in k Integer;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\OnLand.spd(1),122(135,10))*/
dcl
   i,j Integer,
   PathCoord tCoordinates,
   Direct tTurnDirection,
   flagPath Boolean,
   factorAccel Real;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\OnLand.spd(1),116(40,25))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\OnLand.spd(1),125(40,40))*/
task {/*#E*/ 
 
flagPath := false;
for (i:=MyLandShip!Coordinates!x-1, i <=MyLandShip!Coordinates!x+1, i+1) {
  for (j:=MyLandShip!Coordinates!y-1, j <=MyLandShip!Coordinates!y+1, j+1) {
     if ( (i < 0) OR (i > MaxXCoordinate) OR (j < 0) OR (j > MaxYCoordinate) ) continue;
     if ( (call getDeepXY(i, j)) >= d2i(ShipsCharacter(MyLandShip!TypeShip)!MaxDeep)) {
       PathCoord!x := i;
       PathCoord!y := j;
       flagPath := true;
       break;
    }
  }
  if (flagPath = true) break;
}
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\OnLand.spd(1),209(40,80))*/
decision /*#E*/ 
flagPath;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\OnLand.spd(1),227(37,80))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\OnLand.spd(1),224(20,90))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\OnLand.spd(1),221(52,92))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\OnLand.spd(1),137(40,100))*/
task {/*#E*/ 
 
Direct := call NewHeadingChange(MyLandShip, PathCoord);
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\OnLand.spd(1),149(40,115))*/
decision /*#E*/ 
Direct;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\OnLand.spd(1),167(57,125))*/
(LEFT):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\OnLand.spd(1),155(55,130))*/
task {/*#E*/ 
 
CommandToShip(k)!OrderType := _LEFT;
CommandToShip(k)!isSet := true;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\OnLand.spd(1),170(40,125))*/
(RIGHT):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\OnLand.spd(1),158(40,145))*/
task {/*#E*/ 
 
CommandToShip(k)!OrderType := _RIGHT;
CommandToShip(k)!isSet := true;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\OnLand.spd(1),176(25,125))*/
else:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\OnLand.spd(1),164(25,160))*/
task {/*#E*/ 
 
CommandToShip(k)!OrderType := _ACCEL;
factorAccel := 2.5/
float(ShipsCharacter(MyLandShip!TypeShip)!MaxAcceleration);
if (factorAccel >= 1)  factorAccel := 1;
CommandToShip(k)!Accel := factorAccel;
CommandToShip(k)!isSet := true;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\OnLand.spd(1),149(40,115))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\OnLand.spd(1),119(45,175))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\OnLand.spd(1),209(40,80))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy1\OnLand.spd,4)*/
endprocedure OnLand;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2.sbk,4)*/
block Strategy2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2.sbk(1),140(40,55))*/
signalroute /*#E*/ 
chStSim from 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2.sbk(1),104(15,15))*/
env to 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2.sbk(1),137(80,50))*/
Main2 with 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2.sbk(1),141(55,62))*/
(fromSimulator);
from 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2.sbk(1),137(80,50))*/
Main2 to 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2.sbk(1),104(15,15))*/
env with 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2.sbk(1),142(17,62))*/
(toSimulator);
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2.sbk(1),146(132,55))*/
signalroute /*#E*/ 
chStMsg from 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2.sbk(1),137(80,50))*/
Main2 to 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2.sbk(1),104(15,15))*/
env with 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2.sbk(1),147(152,62))*/
messageLog,
messageError;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2.sbk(1),137(80,50))*/
process /*#E*/ 
Main2 referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2.sbk(1),158(5,52))*/
connect /*#E*/ 
SimSt2Int and 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2.sbk(1),140(40,55))*/
chStSim;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2.sbk(1),167(167,52))*/
connect /*#E*/ 
St2MsgInt and 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2.sbk(1),146(132,55))*/
chStMsg;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2.sbk,4)*/
endblock Strategy2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\Main.spr,4)*/
process Main2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\Main.spr(1),143(5,25))*/
imported
    gWeaponryCharacter tArrayWeaponryCharacter,
    gShipsCharacter tArrayShipsCharacter;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\Main.spr(1),665(90,25))*/
synonym 
   FirstQuaterX Integer = 3*MaxXCoordinate/4,
   FirstQuaterY Integer = 3*MaxYCoordinate/4,
   SecondQuaterX Integer = 3*MaxXCoordinate/4,
   SecondQuaterY Integer = MaxYCoordinate/4,
   ThirdQuaterX Integer = MaxXCoordinate/4,
   ThirdQuaterY Integer = MaxYCoordinate/4,
   FourthQuaterX Integer = MaxXCoordinate/4,
   FourthQuaterY Integer = 3*MaxYCoordinate/4;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\Main.spr(1),506(5,40))*/
newtype tOrderType
 literals
    _RIGHT,
    _LEFT,
    _FIRE,
    _ACCEL;
endnewtype;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\Main.spr(1),482(5,70))*/
newtype tFire
  struct
    List tStringShotsList;
    Weapon tNameWeaponry; 
endnewtype;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\Main.spr(1),479(5,95))*/
newtype tCommand
  struct
    OrderType  tOrderType;
    isSet Boolean;
    Fire tFire;
    Accel tFactorAcceleration;
endnewtype;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\Main.spr(1),476(5,125))*/
newtype tArrayCommand
  Array(tShipId,tCommand);
endnewtype;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\Main.spr(2),638(5,40))*/
dcl 
   WeaponryCharacter tArrayWeaponryCharacter,
   ShipsCharacter tArrayShipsCharacter;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\Main.spr(2),620(5,80))*/
dcl 
   MyCenter tCoordinates,
   Tick,NumMyShips, minSpeed Integer,
   flagFight Boolean := true,
   HeadingTarget tCoordinates,
   ShipsCurrentState tStringShipCurrentState,
   CommandToShip tArrayCommand,
   StrategyID tStrategyId;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\Main.spr(2),635(5,145))*/
dcl
   EnemyCenter tCoordinates,
   NumVisibleShips Integer,
   EnemyShips tStringEnemyShip;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\Main.spr(2),632(85,25))*/
procedure /*#E*/ 
StrategyStep2 referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\Main.spr(2),629(85,40))*/
procedure /*#E*/ 
EnemyCenter2 referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\Main.spr(2),623(85,55))*/
procedure /*#E*/ 
UpdateShipParams2 referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\Main.spr(3),119(70,10))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\Main.spr(3),116(70,25))*/
nextstate /*#E*/ 
Idle;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\Main.spr(3),116(70,25))*/
state /*#E*/ 
Idle;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\Main.spr(3),182(70,40))*/
input /*#E*/ 
InitData_
Complete;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\Main.spr(3),149(70,55))*/
task {/*#E*/ 
 
WeaponryCharacter := import(gWeaponryCharacter);
ShipsCharacter := import(gShipsCharacter);
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\Main.spr(3),197(70,75))*/
nextstate /*#E*/ 
InitComplete;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\Main.spr(3),116(70,25))*/
endstate;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\Main.spr(3),197(70,75))*/
state /*#E*/ 
InitComplete;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\Main.spr(3),584(45,90))*/
save /*#E*/ 
VisibleShip;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\Main.spr(3),284(70,90))*/
input /*#E*/ 
 
ShipsCurrentState(StrategyID,
ShipsCurrentState)
;
grst4840_1:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\Main.spr(3),551(70,105))*/
call /*#E*/ 
 
UpdateShipParams2
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\Main.spr(3),311(70,120))*/
nextstate /*#E*/ 
IdleVisShips;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\Main.spr(3),197(70,75))*/
endstate;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\Main.spr(3),311(70,120))*/
state /*#E*/ 
IdleVisShips;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\Main.spr(3),326(55,135))*/
input /*#E*/ 
 
StartSimulation(Tick)  
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\Main.spr(3),206(55,150))*/
call /*#E*/ 
 
StrategyStep2(
ShipsCurrentState)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\Main.spr(3),353(55,165))*/
output /*#E*/ 
 
FinishSimulation(Tick, 
StrategyID)  
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\Main.spr(3),734(55,180))*/
nextstate /*#E*/ 
IdleRes;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\Main.spr(3),317(85,135))*/
input /*#E*/ 
 
VisibleShip(StrategyID,EnemyShips)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\Main.spr(3),386(85,150))*/
call /*#E*/ 
Enemy_
Center2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\Main.spr(3),329(85,165))*/
nextstate /*#E*/ 
-;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\Main.spr(3),311(70,120))*/
endstate;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\Main.spr(3),734(55,180))*/
state /*#E*/ 
IdleRes;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\Main.spr(3),770(40,195))*/
input /*#E*/ 
 
ShipsCurrentState(
StrategyID,
ShipsCurrentState)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\Main.spr(3),551(70,105))*/
join /*#E*/ 
grst4840_1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\Main.spr(3),749(70,195))*/
input /*#E*/ 
 
  OrderSpeedResponse, OrderSpeedReject, 
  OrderTurnResponse, OrderTurnReject, 
  OrderFireResponse, OrderFireReject, DestroyShip
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\Main.spr(3),761(70,210))*/
nextstate /*#E*/ 
-;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\Main.spr(3),734(55,180))*/
endstate;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\Main.spr(3),230(120,10))*/
state /*#E*/ 
*;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\Main.spr(3),227(120,25))*/
input /*#E*/ 
 
StrategyVictory(StrategyID),
StrategyLose(StrategyID)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\Main.spr(3),266(125,40))*/
stop /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\Main.spr(3),230(120,10))*/
endstate;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\Main.spr,4)*/
endprocess Main2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\UpdateShipParams.spd,4)*/
procedure UpdateShipParams2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\UpdateShipParams.spd(1),224(130,10))*/
dcl
  TempCenterX, TempCenterY Real,
   i Integer;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\UpdateShipParams.spd(1),116(25,20))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\UpdateShipParams.spd(1),122(25,40))*/
task {/*#E*/ 
 
NumVisibleShips := 0;
NumMyShips := length(ShipsCurrentState);
TempCenterX := 0;
TempCenterY := 0;
minSpeed := ShipsCharacter(ShipsCurrentState(1)!TypeShip)!MaxSpeed;
for (i:=1, i<=NumMyShips, i+1){
  CommandToShip(i)!isSet := false;
  CommandToShip(i)!Fire!List := empty;
  TempCenterX := TempCenterX + float(ShipsCurrentState(i)!Coordinates!x)/float(NumMyShips);
  TempCenterY := TempCenterY + float(ShipsCurrentState(i)!Coordinates!y)/float(NumMyShips);
  if (ShipsCharacter(ShipsCurrentState(i)!TypeShip)!MaxSpeed <= minSpeed) {
    minSpeed := ShipsCharacter(ShipsCurrentState(i)!TypeShip)!MaxSpeed;
  }
}
MyCenter!x := fix(TempCenterX);
MyCenter!y := fix(TempCenterY);
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\UpdateShipParams.spd(1),119(30,90))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\UpdateShipParams.spd,4)*/
endprocedure UpdateShipParams2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyCenter.spd,4)*/
procedure EnemyCenter2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyCenter.spd(1),140(125,15))*/
dcl
  TempCenterX, TempCenterY Real,
   i Integer;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyCenter.spd(1),116(10,25))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyCenter.spd(1),122(10,45))*/
task {/*#E*/ 
 
TempCenterX := 0;
TempCenterY := 0;
NumVisibleShips := length(EnemyShips);
for (i:=1, i<=NumVisibleShips, i+1) {
  TempCenterX := TempCenterX + float(EnemyShips(i)!Coordinates!x)/float(NumVisibleShips);
  TempCenterY := TempCenterY + float(EnemyShips(i)!Coordinates!y)/float(NumVisibleShips);
}
 EnemyCenter!x := fix(TempCenterX);
 EnemyCenter!y := fix(TempCenterY);
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyCenter.spd(1),119(15,60))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyCenter.spd,4)*/
endprocedure EnemyCenter2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd,4)*/
procedure StrategyStep2
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd,1)*/
; fpar
  in/out ShipsCurrState tStringShipCurrentState;

/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(1),254(5,30))*/
newtype tTurnDirection inherits tHeadingChange
  adding literals
     STRAIGHT;
endnewtype;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(1),329(5,50))*/
newtype tCollision
   literals
     NO_COLLISION,
     LAND_COLLISION,
     ENEMY_SHIP_COLLISION,
     MY_SHIP_COLLISION;
endnewtype;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(1),200(5,80))*/
dcl
   index Integer := 1,
   CollisionType tCollision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(1),1025(85,20))*/
procedure /*#E*/ 
EnemyFound2 referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(1),926(85,35))*/
procedure /*#E*/ 
EnemyNotFound2 referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(1),872(85,55))*/
procedure /*#E*/ 
NextPosition2 referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(1),866(85,75))*/
procedure /*#E*/ 
NextDirection2 referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(1),860(85,95))*/
procedure /*#E*/ 
NewHeadingChange2 referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(1),854(85,115))*/
procedure /*#E*/ 
isCollision2 referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(1),848(85,130))*/
procedure /*#E*/ 
SolveCollision2 referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(1),917(85,145))*/
procedure /*#E*/ 
NextShipState2 referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(1),1274(85,160))*/
procedure /*#E*/ 
OutputOrder2 referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(1),1352(85,175))*/
procedure /*#E*/ 
FindHeadingTarget2 referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(1),1346(85,195))*/
procedure /*#E*/ 
FindStartPoint2 referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(1),2000(85,210))*/
procedure /*#E*/ 
OnLand2 referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(2),137(75,30))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(2),209(75,50))*/
decision /*#E*/ 
 
NumVisibleShips = 0
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(2),1145(70,50))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(2),1139(60,70))*/
task {/*#E*/ 
 
if (flagFight =false)
flagFight := true;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(2),1490(65,85))*/
join /*#E*/ 
Step1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(2),1313(97,50))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(2),1310(95,70))*/
task {/*#E*/ 
 
if (flagFight=true) {
  flagFight := false;
  call FindStartPoint2;
}
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(2),1361(95,100))*/
decision /*#E*/ 
 
 ((MyCenter!x <=
   HeadingTarget!x + 5) AND
    (MyCenter!x >=
   HeadingTarget!x  - 5) AND 
    (MyCenter!y <=
   HeadingTarget!y + 5) AND 
    (MyCenter!y>=
   HeadingTarget!y  - 5)) 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(2),1376(90,100))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(2),1370(80,115))*/
call /*#E*/ 
 
FindHeadingTarget2
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(2),1598(107,110))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(2),1361(95,100))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(2),1595(100,135))*/
join /*#E*/ 
Step2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(2),209(75,50))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(3),1484(75,25))*/
connection /*#E*/ 
Step1:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(3),2060(70,45))*/
decision /*#E*/ 
 
(call getDeepXY(ShipsCurrState(index)!Coordinates!x,
ShipsCurrState(index)!Coordinates!y)) <
d2i(ShipsCharacter(ShipsCurrState(index)!_
TypeShip)!MaxDeep)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(3),2081(62,57))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(3),2072(55,65))*/
call /*#E*/ 
 
OnLand2(
ShipsCurrState(index),
index)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(3),2069(92,57))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(3),1439(85,65))*/
call /*#E*/ 
 
EnemyFound2(
ShipsCurrState(index),
index)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(3),2060(70,45))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(3),1433(70,85))*/
task {/*#E*/ 
 
CollisionType := 
call isCollision2;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(3),1427(70,100))*/
decision /*#E*/ 
 
CollisionType
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(3),1457(52,107))*/
(NO_COLLISION):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(3),1421(55,115))*/
call /*#E*/ 
OutputOrder2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(3),1460(87,107))*/
else:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(3),1418(85,115))*/
call /*#E*/ 
 
SolveCollision2
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(3),1427(70,100))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(3),1412(70,130))*/
task {/*#E*/ 
index := 
index + 1;};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(3),1409(70,145))*/
decision /*#E*/ 
 
index <=
NumMyShips
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(3),2087(62,145))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(3),1610(82,155))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(3),1607(75,160))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(3),1409(70,145))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(3),2060(70,45))*/
join /*#E*/ 
Step1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(3),1484(75,25))*/
endconnection Step1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(4),1742(75,25))*/
connection /*#E*/ 
Step2:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(4),2012(70,45))*/
decision /*#E*/ 
 
(call getDeepXY(ShipsCurrState(index)!Coordinates!x,
ShipsCurrState(index)!Coordinates!y)) <
d2i(ShipsCharacter(ShipsCurrState(index)!_
TypeShip)!MaxDeep)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(4),2030(57,57))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(4),2024(55,65))*/
call /*#E*/ 
 
OnLand2(
ShipsCurrState(index),
index)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(4),2051(92,57))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(4),1739(85,65))*/
call /*#E*/ 
 
EnemyNotFound2(
ShipsCurrState(index),
index)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(4),2012(70,45))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(4),1733(70,85))*/
task {/*#E*/ 
 
CollisionType := 
call isCollision2;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(4),1727(70,100))*/
decision /*#E*/ 
 
CollisionType
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(4),1763(52,107))*/
(NO_COLLISION):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(4),1721(55,115))*/
call /*#E*/ 
OutputOrder2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(4),1766(87,107))*/
else:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(4),1718(85,115))*/
call /*#E*/ 
 
SolveCollision2
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(4),1727(70,100))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(4),1712(70,130))*/
task {/*#E*/ 
index := 
index + 1;};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(4),1709(70,145))*/
decision /*#E*/ 
 
index <=
NumMyShips
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(4),2054(62,145))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(4),1787(82,155))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(4),1703(75,160))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(4),1709(70,145))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(4),2012(70,45))*/
join /*#E*/ 
Step2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd(4),1742(75,25))*/
endconnection Step2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\StrategyStep.spd,4)*/
endprocedure StrategyStep2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\SolveCollision.spd,4)*/
procedure SolveCollision2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\SolveCollision.spd(1),116(75,15))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\SolveCollision.spd(1),125(75,35))*/
decision /*#E*/ 
 
CollisionType
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\SolveCollision.spd(1),140(35,35))*/
(ENEMY_SHIP_COLLISION):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\SolveCollision.spd(1),137(60,50))*/
decision /*#E*/ 
 
((ShipsCurrState(index)!Ammunition(   
MISSILE) = 0) AND
(ShipsCurrState(index)!Ammunition(
TORPEDO) = 0) AND
(ShipsCurrState(index)!Ammunition(
SHELL) = 0) AND
(ShipsCurrState(index)!Ammunition(
REPAIR) = 0))
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\SolveCollision.spd(1),158(50,50))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\SolveCollision.spd(1),155(45,65))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\SolveCollision.spd(1),596(72,62))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\SolveCollision.spd(1),137(60,50))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\SolveCollision.spd(1),587(87,45))*/
else:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\SolveCollision.spd(1),125(75,35))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\SolveCollision.spd(1),584(75,85))*/
decision /*#E*/ 
 
((CommandToShip(index)!isSet = true)AND
(CommandToShip(index)!OrderType = _ACCEL)AND
(CommandToShip(index)!Accel > 0))
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\SolveCollision.spd(1),605(87,95))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\SolveCollision.spd(1),593(75,105))*/
task {/*#E*/ 
 
CommandToShip(index)!isSet := false;
CollisionType := call isCollision2;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\SolveCollision.spd(1),569(75,120))*/
decision /*#E*/ 
 
CollisionType = NO_COLLISION
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\SolveCollision.spd(1),578(72,120))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\SolveCollision.spd(1),557(65,135))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\SolveCollision.spd(1),611(87,132))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\SolveCollision.spd(1),569(75,120))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\SolveCollision.spd(1),617(72,85))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\SolveCollision.spd(1),584(75,85))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\SolveCollision.spd(1),527(80,155))*/
join /*#E*/ 
Solv1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\SolveCollision.spd(2),518(90,15))*/
connection /*#E*/ 
Solv1:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\SolveCollision.spd(2),488(85,30))*/
task {/*#E*/ 
 
CommandTo_
Ship(index)!OrderType := _RIGHT;
CommandToShip(index)!isSet := true;
CollisionType := call isCollision2;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\SolveCollision.spd(2),482(85,50))*/
decision /*#E*/ 
 
CollisionType = NO_COLLISION
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\SolveCollision.spd(2),500(82,50))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\SolveCollision.spd(2),476(60,60))*/
output /*#E*/ 
 
OrderTurnRequest(
ShipsCurrState(index)!ShipId, 
StrategyID, RIGHT)  
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\SolveCollision.spd(2),470(65,75))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\SolveCollision.spd(2),509(97,62))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\SolveCollision.spd(2),467(85,70))*/
task {/*#E*/ 
 
CommandTo_
Ship(index)!OrderType := _LEFT;
CommandToShip(index)!isSet := true;
CollisionType := call isCollision2;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\SolveCollision.spd(2),362(85,95))*/
decision /*#E*/ 
 
CollisionType = NO_COLLISION
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\SolveCollision.spd(2),368(67,95))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\SolveCollision.spd(2),356(60,105))*/
output /*#E*/ 
 
OrderTurnRequest(
ShipsCurrState(index)!ShipId, 
StrategyID, LEFT)  
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\SolveCollision.spd(2),350(65,120))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\SolveCollision.spd(2),377(97,107))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\SolveCollision.spd(2),347(85,120))*/
task {/*#E*/ 
 
CommandTo_
Ship(index)!OrderType := _ACCEL;
CommandTo_
Ship(index)!Accel := -1;
CommandToShip(index)!isSet := true;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\SolveCollision.spd(2),341(85,140))*/
output /*#E*/ 
 
OrderSpeedRequest(
ShipsCurrState(index)!ShipId, 
StrategyID,-1)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\SolveCollision.spd(2),335(90,155))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\SolveCollision.spd(2),362(85,95))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\SolveCollision.spd(2),482(85,50))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\SolveCollision.spd(2),518(90,15))*/
endconnection Solv1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\SolveCollision.spd,4)*/
endprocedure SolveCollision2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd,4)*/
procedure isCollision2
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd,1)*/
; 
returns  tCollision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(1),143(105,10))*/
dcl
  MyShipNextState, OtherShipNextState tShipCurrentState,
  NextPoint tCoordinates, 
  NextHead tHeading,
  IncX, IncY, i, Deep, maxDeep Integer, 
  flag  Real := 1,
  MyShipType tNameShip;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(1),116(75,10))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(1),146(75,25))*/
task {/*#E*/ 
 
MyShipNextState := 
call NextShipState2(index);   
NextHead := 
MyShipNextState!Heading;
MyShipType :=
ShipsCurrState(index)!TypeShip;  
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(1),1745(75,50))*/
decision /*#E*/ 
NextHead;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(1),1748(27,55))*/
(NORTH):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(1),1742(15,60))*/
task {/*#E*/ 
IncX:=0;
IncY:=1;};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(1),1817(147,55))*/
(NORTH_WEST):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(1),1691(135,60))*/
task {/*#E*/ 
 
IncX:=-1;
IncY:=1;
flag:=sqrt2;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(1),1793(45,67))*/
(EAST):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(1),1703(30,75))*/
task {/*#E*/ 
IncX:=1;
IncY:=0;};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(1),1805(142,75))*/
(SOUTH_WEST):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(1),1697(120,75))*/
task {/*#E*/ 
 
IncX:=-1;
IncY:=-1;
flag:=sqrt2;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(1),1811(60,82))*/
(WEST):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(1),1694(45,90))*/
task {/*#E*/ 
IncX:=-1;
IncY:=0;};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(1),1787(130,90))*/
(NORTH_EAST):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(1),1706(105,90))*/
task {/*#E*/ 
 
IncX:=1;
IncY:=1;
flag:=sqrt2;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(1),1799(72,97))*/
(SOUTH):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(1),1700(60,105))*/
task {/*#E*/ 
IncX:=0;
IncY:=-1;};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(1),2009(112,105))*/
(SOUTH_EAST):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(1),1688(90,105))*/
task {/*#E*/ 
 
IncX:=1;
IncY:=-1;
flag:=sqrt2;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(1),1745(75,50))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(1),1739(75,125))*/
task {/*#E*/ 
 
NextPoint := ShipsCurrState(index)!Coordinates;
i := 1;
maxDeep := d2i(ShipsCharacter(MyShipType)!MaxDeep);
};
grst8912_1:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(1),2012(75,140))*/
decision /*#E*/ 
 
/*      2  */
 i<=fix(2*float(MyShipNextState!Speed)/flag)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(1),2048(87,150))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(1),2042(75,155))*/
decision /*#E*/ 
 
(NextPoint!x + IncX < 0) OR 
(NextPoint!y + IncY < 0) OR
(NextPoint!x + IncX > MaxXCoordinate) OR 
(NextPoint!y + IncY > MaxYCoordinate)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(1),2054(70,155))*/
(true):
grst8912_2:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(1),1709(45,165))*/
join /*#E*/ 
P1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(1),2051(87,167))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(1),1733(75,175))*/
task {/*#E*/ 
 
NextPoint!x := NextPoint!x + IncX;
NextPoint!y := NextPoint!y + IncY;
Deep := call getDeepXY(NextPoint!x,NextPoint!y);
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(1),1727(75,190))*/
decision /*#E*/ 
 
Deep < maxDeep
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(1),1769(70,190))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(1),1721(45,200))*/
return /*#E*/ 
LAND_COLLISION;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(1),1772(87,200))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(1),1718(75,210))*/
task {/*#E*/ 
i := i+1;};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(1),1727(75,190))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(1),2012(75,140))*/
join /*#E*/ 
grst8912_1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(1),2042(75,155))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(1),2030(70,140))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(1),1709(45,165))*/
join /*#E*/ 
grst8912_2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(1),2012(75,140))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(2),509(75,5))*/
connection /*#E*/ 
P1:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(2),1961(70,20))*/
decision /*#E*/ 
 
NumVisibleShips = 0
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(2),1967(82,30))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(2),539(70,35))*/
task {/*#E*/ 
i := 1;};
grst8912_3:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(2),533(70,50))*/
task {/*#E*/ 
 
NextPoint := call NextPosition2(EnemyShips(i)!Coordinates,
EnemyShips(i)!Heading, EnemyShips(i)!Speed, 
EnemyShips(i)!TypeShip);
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(2),530(70,65))*/
decision /*#E*/ 
 
NextPoint = MyShipNextState!Coordinates
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(2),554(67,65))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(2),524(30,75))*/
return /*#E*/ 
ENEMY_SHIP_COLLISION;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(2),557(82,77))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(2),521(70,85))*/
task {/*#E*/ 
i := i+1;};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(2),518(70,100))*/
decision /*#E*/ 
 
 i <= NumVisibleShips
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(2),563(65,100))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(2),533(70,50))*/
join /*#E*/ 
grst8912_3;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(2),1958(82,110))*/
(false):
grst8912_4:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(2),1919(70,115))*/
task {/*#E*/ 
i := 1;};
grst8912_5:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(2),1916(70,130))*/
decision /*#E*/ 
index = i;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(2),1925(82,140))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(2),1913(70,145))*/
task {/*#E*/ 
 
OtherShipNextState := 
call NextShipState2(i);
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(2),1907(70,160))*/
decision /*#E*/ 
 
OtherShipNextState!Coordinates = 
MyShipNextState!Coordinates
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(2),1940(65,160))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(2),1901(35,170))*/
return /*#E*/ 
MY_SHIP_COLLISION;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(2),1943(82,172))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(2),1907(70,160))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(2),1928(65,135))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(2),1916(70,130))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(2),1898(70,185))*/
task {/*#E*/ 
i := i+1;};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(2),1895(70,200))*/
decision /*#E*/ 
 
 i <= NumMyShips
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(2),1949(67,200))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(2),1955(82,210))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(2),1889(75,215))*/
return /*#E*/ 
NO_COLLISION;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(2),1895(70,200))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(2),1916(70,130))*/
join /*#E*/ 
grst8912_5;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(2),518(70,100))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(2),530(70,65))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(2),1976(62,20))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(2),1919(70,115))*/
join /*#E*/ 
grst8912_4;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(2),1961(70,20))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd(2),509(75,5))*/
endconnection P1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\isCollision.spd,4)*/
endprocedure isCollision2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NewHeading.spd,4)*/
procedure NewHeadingChange2
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NewHeading.spd,1)*/
; fpar
    in OurShCurrState tShipCurrentState,
    TargetPoint tCoordinates;
 returns ReturnDirect tTurnDirection;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NewHeading.spd(1),332(10,35))*/
newtype tCos
   Array(Integer, Real);
endnewtype;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NewHeading.spd(1),326(10,55))*/
 dcl
   NextHding tHeading,
   RightPoint, LeftPoint,  StraightPoint tCoordinates,
   i, indx  Integer,
   min Real,
   Cos tCos,
   CurrSpeed tSCMaxSpeed;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NewHeading.spd(1),329(100,35))*/
procedure /*#E*/ 
CosBetweenVectors2 referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NewHeading.spd(2),116(25,35))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NewHeading.spd(2),131(25,55))*/
task {/*#E*/ 
 
CurrSpeed := OurShCurrState!Speed;
if (CurrSpeed = 0) CurrSpeed :=  CurrSpeed+2;
NextHding := call NextDirection2(
OurShCurrState!Heading,RIGHT);
RightPoint := call NextPosition2(
OurShCurrState!Coordinates, NextHding, CurrSpeed, OurShCurrState!TypeShip);
 NextHding := call NextDirection2(OurShCurrState!Heading,LEFT);
LeftPoint := call NextPosition2(
OurShCurrState!Coordinates, NextHding, CurrSpeed, OurShCurrState!TypeShip);
StraightPoint :=call NextPosition2
(OurShCurrState!Coordinates, OurShCurrState!Heading, CurrSpeed, OurShCurrState!TypeShip);
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NewHeading.spd(2),146(25,100))*/
task {/*#E*/ 
 
Cos(1) := call CosBetweenVectors2(OurShCurrState!Coordinates, RightPoint, TargetPoint);
Cos(2) := call CosBetweenVectors2(OurShCurrState!Coordinates, LeftPoint, TargetPoint);
Cos(3) := call CosBetweenVectors2(OurShCurrState!Coordinates, StraightPoint, TargetPoint);
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NewHeading.spd(2),164(25,115))*/
task {/*#E*/ 
 
min := Cos(1);
indx := 1;
for( i :=2, i<=3, i+1){
  if (Cos(i) > min) {
     min := Cos(i);
     indx := i;
  }
} 
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NewHeading.spd(2),233(25,145))*/
task {/*#E*/ 
 
if (indx = 1) ReturnDirect:=RIGHT;
else {
if (indx = 2) ReturnDirect:=LEFT;
 else ReturnDirect:=STRAIGHT;
}
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NewHeading.spd(2),119(30,165))*/
return /*#E*/ 
ReturnDirect;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NewHeading.spd,4)*/
endprocedure NewHeadingChange2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\CosBetweenVectors.spd,4)*/
procedure CosBetweenVectors2
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\CosBetweenVectors.spd,1)*/
; fpar
  in StartPoint, EndPoint1, EndPoint2 tCoordinates; 
returns Cos Real;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\CosBetweenVectors.spd(1),116(40,30))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\CosBetweenVectors.spd(1),185(40,45))*/
decision /*#E*/ 
 
(StartPoint = EndPoint1) OR (StartPoint = EndPoint2)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\CosBetweenVectors.spd(1),203(37,45))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\CosBetweenVectors.spd(1),200(5,55))*/
task {/*#E*/ 
Cos := -2;};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\CosBetweenVectors.spd(1),296(10,70))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\CosBetweenVectors.spd(1),215(52,55))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\CosBetweenVectors.spd(1),212(40,60))*/
decision /*#E*/ 
 
( (EndPoint1!x - StartPoint!x = 0) AND (EndPoint2!x - StartPoint!x =0) AND 
   ((EndPoint1!y - StartPoint!y)*(EndPoint2!y - StartPoint!y) > 0) )
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\CosBetweenVectors.spd(1),263(52,70))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\CosBetweenVectors.spd(1),260(40,75))*/
decision /*#E*/ 
 
( (EndPoint1!y - StartPoint!y = 0) AND (EndPoint2!y - StartPoint!y =0) AND 
   ((EndPoint1!x - StartPoint!x)*(EndPoint2!x - StartPoint!x) > 0) )
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\CosBetweenVectors.spd(1),278(52,87))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\CosBetweenVectors.spd(1),275(40,90))*/
decision /*#E*/ 
 
( (EndPoint1!y - StartPoint!y /= 0) AND (EndPoint2!y - StartPoint!y /=0)) AND
( (EndPoint1!x - StartPoint!x /= 0) AND (EndPoint2!x - StartPoint!x /=0)) AND
 ( float(EndPoint1!x - StartPoint!x)/float(EndPoint2!x - StartPoint!x) = 
   float(EndPoint1!y - StartPoint!y)/float(EndPoint2!y - StartPoint!y) )AND
 ( ((EndPoint1!x - StartPoint!x)*(EndPoint2!x - StartPoint!x) > 0) AND
    ((EndPoint1!y - StartPoint!y)*(EndPoint2!y - StartPoint!y) > 0) )
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\CosBetweenVectors.spd(1),290(32,97))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\CosBetweenVectors.spd(1),293(67,97))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\CosBetweenVectors.spd(1),146(55,115))*/
task {/*#E*/ 
 
Cos := float((EndPoint1!x - StartPoint!x)*(EndPoint2!x - StartPoint!x) 
                   + (EndPoint1!y - StartPoint!y)*(EndPoint2!y - StartPoint!y))/
float((call getDistance(StartPoint!x, StartPoint!y, EndPoint1!x, EndPoint1!y))*
         (call getDistance(StartPoint!x, StartPoint!y, EndPoint2!x, EndPoint2!y)));
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\CosBetweenVectors.spd(1),245(60,130))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\CosBetweenVectors.spd(1),275(40,90))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\CosBetweenVectors.spd(1),272(32,82))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\CosBetweenVectors.spd(1),260(40,75))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\CosBetweenVectors.spd(1),233(32,67))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\CosBetweenVectors.spd(1),212(40,60))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\CosBetweenVectors.spd(1),227(25,115))*/
task {/*#E*/ 
Cos := 2;};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\CosBetweenVectors.spd(1),119(30,130))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\CosBetweenVectors.spd(1),185(40,45))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\CosBetweenVectors.spd,4)*/
endprocedure CosBetweenVectors2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextDirection.spd,4)*/
procedure NextDirection2
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextDirection.spd,1)*/
; fpar
  CurrHding tHeading,
  Dir tHeadingChange;
  returns NewHeading tHeading;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextDirection.spd(1),152(135,15))*/
dcl
   Numbr Integer;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextDirection.spd(1),149(70,20))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextDirection.spd(1),353(70,40))*/
task {/*#E*/ 
 
Numbr := h2i(CurrHding);
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextDirection.spd(1),209(70,60))*/
decision /*#E*/ 
Dir;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextDirection.spd(1),245(55,67))*/
(RIGHT):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextDirection.spd(1),239(55,75))*/
task {/*#E*/ 
 
Numbr := Numbr +1;
if (Numbr > 7) Numbr := 0;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextDirection.spd(1),242(97,67))*/
(LEFT):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextDirection.spd(1),236(85,75))*/
task {/*#E*/ 
 
Numbr := Numbr -1;
if (Numbr < 0) Numbr:= 7;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextDirection.spd(1),209(70,60))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextDirection.spd(1),368(70,95))*/
task {/*#E*/ 
 
NewHeading := i2h(Numbr);
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextDirection.spd(1),311(75,115))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextDirection.spd,4)*/
endprocedure NextDirection2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextPosition.spd,4)*/
procedure NextPosition2
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextPosition.spd,1)*/
; fpar
  CurrPos tCoordinates,
  Direct tHeading,
  Speed tSCMaxSpeed,
  NameShip tNameShip;
  returns NextPos tCoordinates;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextPosition.spd(1),212(130,10))*/
dcl
  IncX, IncY, Deep, maxDeep Integer,
  flag Real := 1,
  i Integer := 1,
  onLand Boolean;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextPosition.spd(1),578(70,15))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextPosition.spd(1),494(70,35))*/
decision /*#E*/ 
Direct;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextPosition.spd(1),497(22,40))*/
(NORTH):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextPosition.spd(1),491(10,45))*/
task {/*#E*/ 
IncX:=0;
IncY:=1;};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextPosition.spd(1),515(147,40))*/
(NORTH_WEST):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextPosition.spd(1),473(135,45))*/
task {/*#E*/ 
 
IncX:=-1;
IncY:=1;
flag:=sqrt2;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextPosition.spd(1),503(37,52))*/
(EAST):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextPosition.spd(1),485(25,60))*/
task {/*#E*/ 
IncX:=1;
IncY:=0;};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextPosition.spd(1),509(137,60))*/
(SOUTH_WEST):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextPosition.spd(1),479(115,60))*/
task {/*#E*/ 
 
IncX:=-1;
IncY:=-1;
flag:=sqrt2;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextPosition.spd(1),512(52,67))*/
(WEST):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextPosition.spd(1),476(40,75))*/
task {/*#E*/ 
IncX:=-1;
IncY:=0;};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextPosition.spd(1),500(122,75))*/
(NORTH_EAST):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextPosition.spd(1),488(100,75))*/
task {/*#E*/ 
 
IncX:=1;
IncY:=1;
flag:=sqrt2;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextPosition.spd(1),506(67,82))*/
(SOUTH):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextPosition.spd(1),482(55,90))*/
task {/*#E*/ 
IncX:=0;
IncY:=-1;};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextPosition.spd(1),644(107,90))*/
(SOUTH_EAST):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextPosition.spd(1),470(85,90))*/
task {/*#E*/ 
 
IncX:=1;
IncY:=-1;
flag:=sqrt2;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextPosition.spd(1),494(70,35))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextPosition.spd(1),467(70,110))*/
task {/*#E*/ 
 
onLand := false;
NextPos := CurrPos;
maxDeep := d2i(ShipsCharacter(NameShip)!MaxDeep);
Deep := call getDeepXY(NextPos!x,NextPos!y);
if (Deep < maxDeep) onLand := true;
};
grst930_1:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextPosition.spd(1),626(70,135))*/
decision /*#E*/ 
 
 i<=fix(float(Speed)/flag)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextPosition.spd(1),635(82,145))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextPosition.spd(1),455(70,150))*/
decision /*#E*/ 
 
(NextPos!x + IncX < 0) OR 
(NextPos!y + IncY < 0) OR
(NextPos!x + IncX > MaxXCoordinate) OR 
(NextPos!y + IncY > MaxYCoordinate) OR
( (Deep < maxDeep) AND (onLand = false) )
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextPosition.spd(1),692(65,150))*/
(true):
grst930_2:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextPosition.spd(1),449(45,160))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextPosition.spd(1),617(82,162))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextPosition.spd(1),611(70,170))*/
task {/*#E*/ 
 
NextPos!x := NextPos!x + IncX;
NextPos!y := NextPos!y + IncY;
Deep := call getDeepXY(NextPos!x,NextPos!y);
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextPosition.spd(1),446(70,185))*/
task {/*#E*/ 
i := i+1;};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextPosition.spd(1),626(70,135))*/
join /*#E*/ 
grst930_1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextPosition.spd(1),455(70,150))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextPosition.spd(1),695(65,135))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextPosition.spd(1),449(45,160))*/
join /*#E*/ 
grst930_2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextPosition.spd(1),626(70,135))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextPosition.spd,4)*/
endprocedure NextPosition2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextShipState.spd,4)*/
procedure NextShipState2
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextShipState.spd,1)*/
;fpar
   in ShipIndex Integer;
returns ShipNextState tShipCurrentState;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextShipState.spd(1),197(135,10))*/
dcl
   OldSpeed tSCMaxSpeed,
   OldHeading tHeading,
   OldCoords tCoordinates,
   TypeShp tNameShip,
   TempSpeed Integer;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextShipState.spd(1),119(60,25))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextShipState.spd(1),200(60,40))*/
task {/*#E*/ 
 
OldSpeed := ShipsCurrState(ShipIndex)!Speed;
OldHeading := ShipsCurrState(ShipIndex)!Heading;
OldCoords := ShipsCurrState(ShipIndex)!Coordinates;
TypeShp := ShipsCurrState(ShipIndex)!TypeShip;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextShipState.spd(1),155(60,60))*/
decision /*#E*/ 
 
CommandToShip(ShipIndex)!isSet
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextShipState.spd(1),161(72,72))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextShipState.spd(1),149(60,80))*/
decision /*#E*/ 
 
CommandToShip(ShipIndex)!OrderType
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextShipState.spd(1),167(85,90))*/
(_ACCEL):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextShipState.spd(1),143(75,95))*/
task {/*#E*/ 
 
TempSpeed := OldSpeed +
fix(float(ShipsCharacter(TypeShp)!_
MaxAcceleration)*Command_
ToShip(ShipIndex)!Accel);
if (TempSpeed < 0)  ShipNextState!Speed := 0;
if (TempSpeed > (ShipsCharacter(TypeShp)!MaxSpeed)) 
ShipNextState!Speed := ShipsCharacter(TypeShp)!MaxSpeed;
ShipNextState!Heading := OldHeading;
ShipNextState!Coordinates := call NextPosition2
(OldCoords, OldHeading, ShipNextState!Speed, 
ShipNextState!TypeShip);
};
grst8802_1:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextShipState.spd(1),215(80,205))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextShipState.spd(1),173(72,130))*/
(_RIGHT):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextShipState.spd(1),137(60,135))*/
task {/*#E*/ 
 
ShipNextState!Speed := OldSpeed;
ShipNextState!Heading := call NextDirection2(
OldHeading, RIGHT);
ShipNextState!Coordinates := call NextPosition2(
OldCoords,ShipNextState!Heading, OldSpeed, 
ShipNextState!TypeShip);
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextShipState.spd(1),215(80,205))*/
join /*#E*/ 
grst8802_1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextShipState.spd(1),179(57,155))*/
(_LEFT):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextShipState.spd(1),131(45,160))*/
task {/*#E*/ 
 
ShipNextState!Speed := OldSpeed;
ShipNextState!Heading := call NextDirection2(
OldHeading, LEFT);
ShipNextState!Coordinates := call NextPosition2(
OldCoords,ShipNextState!Heading, OldSpeed, 
ShipNextState!TypeShip);
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextShipState.spd(1),215(80,205))*/
join /*#E*/ 
grst8802_1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextShipState.spd(1),185(42,180))*/
else:
grst8802_2:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextShipState.spd(1),125(30,185))*/
task {/*#E*/ 
 
ShipNextState!Speed := OldSpeed;
ShipNextState!Heading := OldHeading;
ShipNextState!Coordinates := call NextPosition2(
OldCoords,OldHeading, OldSpeed, ShipNextState!TypeShip);
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextShipState.spd(1),215(80,205))*/
join /*#E*/ 
grst8802_1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextShipState.spd(1),149(60,80))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextShipState.spd(1),191(55,60))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextShipState.spd(1),125(30,185))*/
join /*#E*/ 
grst8802_2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextShipState.spd(1),155(60,60))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\NextShipState.spd,4)*/
endprocedure NextShipState2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyNotFound.spd,4)*/
procedure EnemyNotFound2
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyNotFound.spd,1)*/
; fpar
  in/out ShCurrSt tShipCurrentState,
  in k Integer;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyNotFound.spd(1),902(125,5))*/
dcl
   ChangeDirection tTurnDirection,
   accel Integer,
   ShipName tNameShip,
   MaxAccel tSCMaxAcceleration,
   factorAccel tFactorAcceleration;
   
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyNotFound.spd(1),116(60,20))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyNotFound.spd(1),338(60,40))*/
task {/*#E*/ 
 
ChangeDirection := 
 call NewHeadingChange2(ShCurrSt,HeadingTarget);
ShipName := ShCurrSt!TypeShip;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyNotFound.spd(1),554(60,65))*/
decision /*#E*/ 
 
ChangeDirection
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyNotFound.spd(1),845(40,72))*/
(RIGHT):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyNotFound.spd(1),842(40,80))*/
task {/*#E*/ 
 
CommandTo_
Ship(k)!_
OrderType := 
_RIGHT;
CommandTo_
Ship(k)!is_
Set := true;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyNotFound.spd(1),872(45,95))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyNotFound.spd(1),911(97,72))*/
(LEFT):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyNotFound.spd(1),854(85,80))*/
task {/*#E*/ 
 
CommandTo_
Ship(k)!_
OrderType :=
 _LEFT;
CommandTo_
Ship(k)!is_
Set := true; 
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyNotFound.spd(1),905(90,95))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyNotFound.spd(1),914(72,75))*/
else:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyNotFound.spd(1),734(60,110))*/
decision /*#E*/ 
 
ShCurrSt!Speed = minSpeed
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyNotFound.spd(1),920(72,120))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyNotFound.spd(1),755(60,125))*/
task {/*#E*/ 
 
MaxAccel := ShipsCharacter(
ShipName)!MaxAcceleration;
accel := minSpeed - ShCurrSt!Speed;
if (float(accel)/float(MaxAccel) <= -1)  factorAccel := -1;
else {
  if (float(accel)/float(MaxAccel) >= 1)  factorAccel := 1;
  else factorAccel := float(accel)/float(MaxAccel);
}
CommandTo_
Ship(index)!OrderType := _ACCEL;
CommandToShip(k)!Accel := factorAccel;
CommandToShip(k)!isSet := true;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyNotFound.spd(1),917(55,110))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyNotFound.spd(1),734(60,110))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyNotFound.spd(1),878(65,145))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyNotFound.spd(1),554(60,65))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyNotFound.spd,4)*/
endprocedure EnemyNotFound2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd,4)*/
procedure EnemyFound2
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd,1)*/
; fpar
  in/out ShCurrSt tShipCurrentState,
  in k Integer;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(1),449(10,30))*/
newtype tShootWeaponry
struct
   TypeWeaponry tNameWeaponry;
   isWeaponry Boolean;
endnewtype;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(1),452(10,55))*/
newtype tShootList
struct
   SortParam Real;
   Number Integer;
endnewtype;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(1),455(10,80))*/
newtype tStringShootList
  String(tShootList,empty);
endnewtype;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(1),170(10,95))*/
dcl
   MaxPointsToShoot, NumPointsToShoot,i,j Integer,
   DistBetweenShips Integer,
   NextHeading tTurnDirection,
   CanShootWeaponry tShootWeaponry,
   BestWeaponry tNameWeaponry,
   ShootPoint, Temp tShootList,
   ShootList tStringShootList,
   PointToOrder tCoordinates,
   DestroyFlag Boolean := false;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(1),173(85,30))*/
procedure /*#E*/ 
ActivateREPAIR2 referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(1),206(85,45))*/
procedure /*#E*/ 
CanShootEnemyCenter2 referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(1),578(85,60))*/
procedure /*#E*/ 
SortShootList2 referenced;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(2),116(85,15))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(2),146(85,35))*/
decision /*#E*/ 
 
ShCurrSt!TypeShip
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(2),725(72,47))*/
(REPAIR_BOAT):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(2),665(60,55))*/
task {/*#E*/ 
 
for (i:=1, i<=NumMyShips, i+1) {
     if (ShipsCurrState(i)!Resource < 
         ShipsCharacter
         (ShipsCurrState(i)!_
         TypeShip)!MaxResource) {
         DestroyFlag := true;
         break; 
     }
}
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(2),626(60,100))*/
decision /*#E*/ 
 
(ShCurrSt!_
Ammunition
(REPAIR) /= 0) AND
(DestroyFlag = true) AND
(NumMyShips > 1)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(2),875(82,100))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(2),182(90,115))*/
call /*#E*/ 
 
ActivateREPAIR2
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(2),653(95,130))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(2),872(72,110))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(2),827(60,145))*/
decision /*#E*/ 
 
NumMyShips = 1
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(2),869(65,155))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(2),692(45,160))*/
task /*#E*/ 
 
NextHeading := call
NewHeadingChange2( 
ShCurrSt,MyCenter)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(2),866(77,155))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(2),851(75,160))*/
task /*#E*/ 
 
NextHeading := call
NewHeadingChange2(ShCurrSt,
EnemyCenter)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(2),827(60,145))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(2),845(65,180))*/
join /*#E*/ 
F2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(2),626(60,100))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(2),233(117,45))*/
else:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(2),230(115,50))*/
task /*#E*/ 
 
CanShootWeaponry := 
call CanShootEnemyCenter2
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(2),239(115,65))*/
decision /*#E*/ 
 
CanShootWeaponry!isWeaponry
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(2),251(115,65))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(2),248(95,75))*/
join /*#E*/ 
F1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(2),650(127,77))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(2),257(115,85))*/
task /*#E*/ 
 
NextHeading := call
NewHeadingChange2(ShCurrSt,
EnemyCenter)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(2),821(120,100))*/
join /*#E*/ 
F2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(2),239(115,65))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(2),146(85,35))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(3),815(85,25))*/
connection /*#E*/ 
F2:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(3),773(80,45))*/
decision /*#E*/ 
 
NextHeading
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(3),779(95,57))*/
(LEFT):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(3),767(80,65))*/
task {/*#E*/ 
 
CommandToShip(k)!_
OrderType := _LEFT;
CommandToShip(k)!isSet := true;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(3),788(72,57))*/
(RIGHT):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(3),758(60,80))*/
task {/*#E*/ 
 
CommandToShip(k)!_
OrderType := _RIGHT;
CommandToShip(k)!isSet := true;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(3),797(62,57))*/
else:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(3),752(45,105))*/
decision /*#E*/ 
 
ShCurrSt!Speed = 
ShipsCharacter_
(ShCurrSt!TypeShip)!_
MaxSpeed 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(3),803(65,105))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(3),746(65,125))*/
task {/*#E*/ 
 
CommandToShip(k)!_
OrderType := _ACCEL;
CommandToShip(k)!Accel := 1;
CommandToShip(k)!isSet := true;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(3),812(47,117))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(3),752(45,105))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(3),740(50,140))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(3),773(80,45))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(3),761(85,95))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(3),815(85,25))*/
endconnection F2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(4),284(70,5))*/
connection /*#E*/ 
F1:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(4),389(65,20))*/
decision /*#E*/ 
 
ShCurrSt!Speed = 0
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(4),722(77,30))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(4),401(65,35))*/
task {/*#E*/ 
 
CommandToShip(k)!OrderType := _ACCEL;  
CommandToShip(k)!Accel := -1;
CommandToShip(k)!isSet := true;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(4),416(70,50))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(4),575(57,25))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(4),521(15,65))*/
task {/*#E*/ 
 
BestWeaponry := CanShootWeaponry!TypeWeaponry;
if (ShipsCharacter(ShCurrSt!TypeShip)!MaxLaunchUnit(BestWeaponry) < 
    ShCurrSt!Ammunition(BestWeaponry))
    MaxPointsToShoot :=  ShipsCharacter(ShCurrSt!TypeShip)!_
                                            MaxLaunchUnit(BestWeaponry);
else 
    MaxPointsToShoot := ShCurrSt!Ammunition(BestWeaponry);
for (i:=1, i<=NumVisibleShips, i+1) {
     DistBetweenShips := call
     getDistance(ShCurrSt!Coordinates!x,ShCurrSt!Coordinates!y,
     EnemyShips(i)!Coordinates!x,EnemyShips(i)!Coordinates!y);
     if (WeaponryCharacter(BestWeaponry)!Range >= DistBetweenShips) {
         ShootPoint!SortParam := float(DistBetweenShips);
         ShootPoint!Number := i;
         ShootList := ShootList // mkstring(ShootPoint);
     }
}
call SortShootList2;
if (length(ShootList) > MaxPointsToShoot) NumPointsToShoot := MaxPointsToShoot;
else NumPointsToShoot := length(ShootList);
CommandToShip(k)!OrderType := _FIRE;
CommandToShip(k)!Fire!Weapon := BestWeaponry;
for (i:=1, i<=NumPointsToShoot, i+1) {
  PointToOrder := call NextPosition2(EnemyShips(ShootList(i)!Number)!Coordinates, 
                                                               EnemyShips(ShootList(i)!Number)!Heading, 
                                                               EnemyShips(ShootList(i)!Number)!Speed, 
                                                               EnemyShips(ShootList(i)!Number)!TypeShip);
  CommandToShip(k)!Fire!List := CommandToShip(k)!Fire!List // mkstring(PointToOrder);
}
CommandToShip(k)!isSet := true;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(4),281(20,85))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(4),389(65,20))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd(4),284(70,5))*/
endconnection F1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\EnemyFound.spd,4)*/
endprocedure EnemyFound2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\ActivateREPAIR.spd,4)*/
procedure ActivateREPAIR2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\ActivateREPAIR.spd(1),1232(135,10))*/
dcl
   NextShipSt tShipCurrentState;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\ActivateREPAIR.spd(1),116(25,10))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\ActivateREPAIR.spd(1),125(25,25))*/
task {/*#E*/ 
 
for (i:=1, i<=NumMyShips, i+1) {
     DistBetweenShips :=  call
     getDistance(ShCurrSt!Coordinates!x,ShCurrSt!Coordinates!y,
     ShipsCurrState(i)!Coordinates!x,ShipsCurrState(i)!Coordinates!y);
     if ((WeaponryCharacter(REPAIR)!Range >= DistBetweenShips) AND
         (ShipsCurrState(i)!Resource < 
          ShipsCharacter(ShipsCurrState(i)!TypeShip)!MaxResource)) {
          ShootPoint!SortParam := 
          float(ShipsCurrState(i)!Resource)/float(ShipsCharacter(ShipsCurrState(i)!TypeShip)!_
          MaxResource);
          ShootPoint!Number := i;
          ShootList := ShootList // mkstring(ShootPoint);
     }
}
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\ActivateREPAIR.spd(1),137(25,80))*/
decision /*#E*/ 
 
length(ShootList) = 0
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\ActivateREPAIR.spd(1),1265(37,90))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\ActivateREPAIR.spd(1),1247(25,95))*/
decision /*#E*/ 
 
ShCurrSt!Speed = 0
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\ActivateREPAIR.spd(1),1253(52,105))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\ActivateREPAIR.spd(1),1241(40,110))*/
task {/*#E*/ 
 
CommandToShip(k)!OrderType := _ACCEL;  
CommandToShip(k)!Accel := -1;
CommandToShip(k)!isSet := true;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\ActivateREPAIR.spd(1),1271(45,125))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\ActivateREPAIR.spd(1),1268(27,105))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\ActivateREPAIR.spd(1),1049(25,140))*/
call /*#E*/ 
 
SortShootList2
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\ActivateREPAIR.spd(1),1067(25,155))*/
task {/*#E*/ 
 
if (ShipsCharacter(REPAIR_BOAT)!MaxLaunchUnit(REPAIR) < 
    ShCurrSt!Ammunition(REPAIR))
    MaxPointsToShoot :=  ShipsCharacter(REPAIR_BOAT)!_
                                            MaxLaunchUnit(REPAIR);
else 
    MaxPointsToShoot := ShCurrSt!Ammunition(REPAIR);
if (length(ShootList) > MaxPointsToShoot) NumPointsToShoot := MaxPointsToShoot;
else NumPointsToShoot := length(ShootList);
CommandToShip(k)!OrderType := _FIRE;
CommandToShip(k)!Fire!Weapon := REPAIR;
for (i:=1, i<=NumPointsToShoot, i+1) {
  NextShipSt := call NextShipState2(ShootList(i)!Number);
  PointToOrder := NextShipSt!Coordinates;
  CommandToShip(k)!Fire!List := CommandToShip(k)!Fire!List // mkstring(PointToOrder);
}
CommandToShip(k)!isSet := true;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\ActivateREPAIR.spd(1),1247(25,95))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\ActivateREPAIR.spd(1),1088(22,80))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\ActivateREPAIR.spd(1),1085(10,110))*/
join /*#E*/ 
R1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\ActivateREPAIR.spd(1),137(25,80))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\ActivateREPAIR.spd(1),1091(10,185))*/
R2:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\ActivateREPAIR.spd(1),119(30,200))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\ActivateREPAIR.spd(2),188(55,10))*/
connection /*#E*/ 
R1:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\ActivateREPAIR.spd(2),1097(50,30))*/
task {/*#E*/ 
 
ShootList := empty;
for (i:=1, i<=NumMyShips, i+1) {
     DistBetweenShips := call
     getDistance(ShCurrSt!Coordinates!x,ShCurrSt!Coordinates!y,
     ShipsCurrState(i)!Coordinates!x,ShipsCurrState(i)!Coordinates!y);
     if (ShipsCurrState(i)!Resource < 
         ShipsCharacter(ShipsCurrState(i)!TypeShip)!MaxResource) {
         ShootPoint!SortParam := 
         float(ShipsCurrState(i)!Resource)/float(ShipsCharacter(
                  ShipsCurrState(i)!TypeShip)!MaxResource);
         ShootPoint!Number := i;
         ShootList := ShootList // mkstring(ShootPoint);
     }
}
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\ActivateREPAIR.spd(2),1214(50,85))*/
call /*#E*/ 
 
SortShootList2
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\ActivateREPAIR.spd(2),1151(50,100))*/
task {/*#E*/ 
 
NextHeading := call
NewHeadingChange2(ShCurrSt,
ShipsCurrState(ShootList(1)!Number)!Coordinates);
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\ActivateREPAIR.spd(2),1145(50,115))*/
decision /*#E*/ 
 
NextHeading
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\ActivateREPAIR.spd(2),1163(65,127))*/
(LEFT):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\ActivateREPAIR.spd(2),1139(50,135))*/
task {/*#E*/ 
 
CommandToShip(k)!OrderType := _LEFT;
CommandToShip(k)!isSet := true;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\ActivateREPAIR.spd(2),1166(42,127))*/
(RIGHT):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\ActivateREPAIR.spd(2),1133(30,150))*/
task {/*#E*/ 
 
CommandToShip(k)!OrderType := _RIGHT;
CommandToShip(k)!isSet := true;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\ActivateREPAIR.spd(2),1169(32,127))*/
else:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\ActivateREPAIR.spd(2),1121(15,175))*/
decision /*#E*/ 
 
ShCurrSt!Speed = 
ShipsCharacter(REPAIR_BOAT)!MaxSpeed 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\ActivateREPAIR.spd(2),1187(40,175))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\ActivateREPAIR.spd(2),1118(45,190))*/
task {/*#E*/ 
 
CommandToShip(k)!OrderType := _ACCEL;
CommandToShip(k)!Accel := 1;
CommandToShip(k)!isSet := true;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\ActivateREPAIR.spd(2),1205(27,187))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\ActivateREPAIR.spd(2),1121(15,175))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\ActivateREPAIR.spd(2),191(20,205))*/
join /*#E*/ 
R2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\ActivateREPAIR.spd(2),1145(50,115))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\ActivateREPAIR.spd(2),1127(55,165))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\ActivateREPAIR.spd(2),188(55,10))*/
endconnection R1;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\ActivateREPAIR.spd,4)*/
endprocedure ActivateREPAIR2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\CanShootEnemyCenter.spd,4)*/
procedure CanShootEnemyCenter2
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\CanShootEnemyCenter.spd,1)*/
; 
returns Weapon  tShootWeaponry;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\CanShootEnemyCenter.spd(1),209(150,5))*/
dcl
   Dist Integer; 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\CanShootEnemyCenter.spd(1),116(75,10))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\CanShootEnemyCenter.spd(1),197(75,25))*/
task /*#E*/ 
 
Dist := call getDistance(ShCurrSt!Coordinates!x,
ShCurrSt!Coordinates!y, EnemyCenter!x,EnemyCenter!y)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\CanShootEnemyCenter.spd(1),137(75,40))*/
decision /*#E*/ 
 
(ShCurrSt!Ammunition(MISSILE) /= 0) AND
(WeaponryCharacter(MISSILE)!Range >= Dist)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\CanShootEnemyCenter.spd(1),218(72,40))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\CanShootEnemyCenter.spd(1),215(50,50))*/
task {/*#E*/ 
 
Weapon!TypeWeaponry := 
   MISSILE;
Weapon!isWeaponry := 
   true;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\CanShootEnemyCenter.spd(1),149(55,65))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\CanShootEnemyCenter.spd(1),158(87,52))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\CanShootEnemyCenter.spd(1),155(75,75))*/
decision /*#E*/ 
 
ShCurrSt!Ammunition(TORPEDO) /= 0 AND
(WeaponryCharacter(TORPEDO)!Range >= Dist)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\CanShootEnemyCenter.spd(1),245(72,75))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\CanShootEnemyCenter.spd(1),233(50,85))*/
task {/*#E*/ 
 
Weapon!TypeWeaponry := 
  TORPEDO;
Weapon!isWeaponry := 
  true;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\CanShootEnemyCenter.spd(1),230(55,100))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\CanShootEnemyCenter.spd(1),179(87,87))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\CanShootEnemyCenter.spd(1),176(75,110))*/
decision /*#E*/ 
 
(ShCurrSt!Ammunition(SHELL) /= 0) AND
(WeaponryCharacter(SHELL)!Range >= Dist)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\CanShootEnemyCenter.spd(1),296(72,110))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\CanShootEnemyCenter.spd(1),281(50,120))*/
task {/*#E*/ 
 
Weapon!TypeWeaponry := 
  SHELL;
Weapon!isWeaponry := 
  true;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\CanShootEnemyCenter.spd(1),278(55,135))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\CanShootEnemyCenter.spd(1),302(87,122))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\CanShootEnemyCenter.spd(1),299(75,130))*/
task {/*#E*/ 
 
Weapon!isWeaponry :=  false;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\CanShootEnemyCenter.spd(1),119(80,150))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\CanShootEnemyCenter.spd(1),176(75,110))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\CanShootEnemyCenter.spd(1),155(75,75))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\CanShootEnemyCenter.spd(1),137(75,40))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\CanShootEnemyCenter.spd,4)*/
endprocedure CanShootEnemyCenter2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\SortShootList.spd,4)*/
procedure SortShootList2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\SortShootList.spd(1),116(55,20))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\SortShootList.spd(1),122(55,35))*/
task {/*#E*/ 
 
for (i:=1, i<=length(ShootList)-1, i+1) {
  for (j := length(ShootList), j>=i+1, j-1) {
     if (ShootList(j)!SortParam <  ShootList(j-1)!SortParam) {
             Temp := ShootList(j-1);
             ShootList(j-1) := ShootList(j);
             ShootList(j) := Temp;
     }
  }
  for (j := i+1, j<=length(ShootList)-1, j+1) {
     if (ShootList(j)!SortParam >  ShootList(j+1)!SortParam) {
             Temp := ShootList(j+1);
             ShootList(j+1) := ShootList(j);
             ShootList(j) := Temp;
     }          
  }
}
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\SortShootList.spd(1),119(60,65))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\SortShootList.spd,4)*/
endprocedure SortShootList2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\OutputOrder.spd,4)*/
procedure OutputOrder2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\OutputOrder.spd(1),116(60,20))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\OutputOrder.spd(1),272(60,40))*/
decision /*#E*/ 
 
CommandToShip(index)!isSet
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\OutputOrder.spd(1),356(57,40))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\OutputOrder.spd(1),353(25,50))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\OutputOrder.spd(1),287(72,52))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\OutputOrder.spd(1),263(60,65))*/
decision /*#E*/ 
 
CommandToShip(index)!OrderType
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\OutputOrder.spd(1),293(92,77))*/
(_LEFT):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\OutputOrder.spd(1),257(80,85))*/
output /*#E*/ 
 
OrderTurnRequest(
ShipsCurrState(index)!ShipId, StrategyID, LEFT)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\OutputOrder.spd(1),329(85,100))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\OutputOrder.spd(1),302(72,107))*/
(_RIGHT):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\OutputOrder.spd(1),248(60,115))*/
output /*#E*/ 
 
OrderTurnRequest(
ShipsCurrState(index)!ShipId, StrategyID, RIGHT)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\OutputOrder.spd(1),341(65,130))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\OutputOrder.spd(1),311(52,137))*/
(_ACCEL):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\OutputOrder.spd(1),239(40,145))*/
output /*#E*/ 
 
OrderSpeedRequest(ShipsCurrState(index)!ShipId, StrategyID,
CommandToShip(index)!Accel)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\OutputOrder.spd(1),332(45,160))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\OutputOrder.spd(1),320(35,167))*/
(_FIRE):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\OutputOrder.spd(1),230(20,175))*/
output /*#E*/ 
 
OrderFireRequest(ShipsCurrState(index)!ShipId, StrategyID,
CommandToShip(index)!Fire!Weapon,CommandToShip(index)!Fire!List)
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\OutputOrder.spd(1),338(25,190))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\OutputOrder.spd(1),263(60,65))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\OutputOrder.spd(1),272(60,40))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\OutputOrder.spd,4)*/
endprocedure OutputOrder2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\FindStartPoint.spd,4)*/
procedure FindStartPoint2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\FindStartPoint.spd,1)*/
 
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\FindStartPoint.spd(1),137(135,5))*/
newtype Dist 
   Array(Integer,Integer)
endnewtype;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\FindStartPoint.spd(1),143(135,20))*/
dcl 
   d Dist,
   count, i, min Integer;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\FindStartPoint.spd(1),128(30,25))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\FindStartPoint.spd(1),125(30,40))*/
task {/*#E*/ 
 
d(1) := call getDistance(MyCenter!x,MyCenter!y,FirstQuaterX, FirstQuaterY);
d(2) := call getDistance(MyCenter!x,MyCenter!y,SecondQuaterX, SecondQuaterY);
d(3) := call getDistance(MyCenter!x,MyCenter!y,ThirdQuaterX, ThirdQuaterY);
d(4) := call getDistance(MyCenter!x,MyCenter!y,FourthQuaterX, FourthQuaterY);
min := d(1); count:=1;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\FindStartPoint.spd(1),353(30,60))*/
task {/*#E*/ 
 
for (i:=2,i<=4,i+1){
 if (d(i)<=min) {
   min := d(i);
   count := i; } 
}
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\FindStartPoint.spd(1),308(30,80))*/
decision /*#E*/ 
count;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\FindStartPoint.spd(1),332(72,85))*/
(4):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\FindStartPoint.spd(1),305(60,90))*/
task {/*#E*/ 
 
HeadingTarget !x:= FourthQuaterX;
HeadingTarget !y:= FourthQuaterY;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\FindStartPoint.spd(1),329(57,90))*/
(3):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\FindStartPoint.spd(1),299(45,105))*/
task {/*#E*/ 
 
HeadingTarget !x:= ThirdQuaterX;
HeadingTarget !y:= ThirdQuaterY;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\FindStartPoint.spd(1),326(42,90))*/
(2):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\FindStartPoint.spd(1),293(30,120))*/
task {/*#E*/ 
 
HeadingTarget !x:= SecondQuaterX;
HeadingTarget !y:= SecondQuaterY;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\FindStartPoint.spd(1),323(27,90))*/
(1):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\FindStartPoint.spd(1),287(15,135))*/
task {/*#E*/ 
 
HeadingTarget !x:= FirstQuaterX;
HeadingTarget !y:= FirstQuaterY;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\FindStartPoint.spd(1),308(30,80))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\FindStartPoint.spd(1),245(35,150))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\FindStartPoint.spd,4)*/
endprocedure FindStartPoint2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\SearchHeadingTarget.spd,4)*/
procedure FindHeadingTarget2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\SearchHeadingTarget.spd(1),116(55,25))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\SearchHeadingTarget.spd(1),137(55,50))*/
task {/*#E*/ 
 
if ((HeadingTarget!x = FirstQuaterX) AND 
    (HeadingTarget!y = FirstQuaterY)) {
      HeadingTarget!x :=  FourthQuaterX;
      HeadingTarget!y :=  FourthQuaterY;
} 
else {
  if ((HeadingTarget!x = SecondQuaterX) AND 
    (HeadingTarget!y = SecondQuaterY)) {
      HeadingTarget!x :=  FirstQuaterX;
      HeadingTarget!y :=  FirstQuaterY;
  } 
  else { 
    if ((HeadingTarget!x = ThirdQuaterX) AND 
        (HeadingTarget!y = ThirdQuaterY)) {
         HeadingTarget!x :=  SecondQuaterX;
         HeadingTarget!y :=  SecondQuaterY;
    }  
    else 
     if ((HeadingTarget!x = FourthQuaterX) AND 
         (HeadingTarget!y = FourthQuaterY)) {
          HeadingTarget!x :=  ThirdQuaterX;
          HeadingTarget!y :=  ThirdQuaterY;
     }
  }
}
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\SearchHeadingTarget.spd(1),119(60,130))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\SearchHeadingTarget.spd,4)*/
endprocedure FindHeadingTarget2;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\OnLand.spd,4)*/
procedure OnLand2
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\OnLand.spd,1)*/
;fpar
  in MyLandShip tShipCurrentState,
  in k Integer;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\OnLand.spd(1),122(135,10))*/
dcl
   i,j Integer,
   PathCoord tCoordinates,
   Direct tTurnDirection,
   flagPath Boolean,
   factorAccel Real;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\OnLand.spd(1),116(40,25))*/
start /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\OnLand.spd(1),125(40,40))*/
task {/*#E*/ 
 
flagPath := false;
for (i:=MyLandShip!Coordinates!x-1, i <=MyLandShip!Coordinates!x+1, i+1) {
  for (j:=MyLandShip!Coordinates!y-1, j <=MyLandShip!Coordinates!y+1, j+1) {
     if ( (i < 0) OR (i > MaxXCoordinate) OR (j < 0) OR (j > MaxYCoordinate) ) continue;
     if ( (call getDeepXY(i, j)) >= d2i(ShipsCharacter(MyLandShip!TypeShip)!MaxDeep)) {
       PathCoord!x := i;
       PathCoord!y := j;
       flagPath := true;
       break;
    }
  }
  if (flagPath = true) break;
}
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\OnLand.spd(1),209(40,80))*/
decision /*#E*/ 
flagPath;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\OnLand.spd(1),227(37,80))*/
(false):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\OnLand.spd(1),224(20,90))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\OnLand.spd(1),221(52,92))*/
(true):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\OnLand.spd(1),137(40,100))*/
task {/*#E*/ 
 
Direct := call NewHeadingChange2(MyLandShip, PathCoord);
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\OnLand.spd(1),149(40,115))*/
decision /*#E*/ 
Direct;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\OnLand.spd(1),167(57,125))*/
(LEFT):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\OnLand.spd(1),155(55,130))*/
task {/*#E*/ 
 
CommandToShip(k)!OrderType := _LEFT;
CommandToShip(k)!isSet := true;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\OnLand.spd(1),170(40,125))*/
(RIGHT):
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\OnLand.spd(1),158(40,145))*/
task {/*#E*/ 
 
CommandToShip(k)!OrderType := _RIGHT;
CommandToShip(k)!isSet := true;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\OnLand.spd(1),176(25,125))*/
else:
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\OnLand.spd(1),164(25,160))*/
task {/*#E*/ 
 
CommandToShip(k)!OrderType := _ACCEL;
factorAccel := 2.5/
float(ShipsCharacter(MyLandShip!TypeShip)!MaxAcceleration);
if (factorAccel >= 1)  factorAccel := 1;
CommandToShip(k)!Accel := factorAccel;
CommandToShip(k)!isSet := true;
};
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\OnLand.spd(1),149(40,115))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\OnLand.spd(1),119(45,175))*/
return /*#E*/ 
;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\OnLand.spd(1),209(40,80))*/
enddecision;
/*#SDTREF(SDL,C:\Work\Development\BattleShips\Battleships\Strategy2\OnLand.spd,4)*/
endprocedure OnLand2;
